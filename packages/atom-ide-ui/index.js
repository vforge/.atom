'use strict';

var cov_1as8dlvlk6 = function () {
  var path = '/Users/hansonw/atom-ide-ui/index.js',
      hash = '3e7219ba3aa3bef0d5069cba7338495b26691940',
      global = new Function('return this')(),
      gcv = '__coverage__',
      coverageData = {
    path: '/Users/hansonw/atom-ide-ui/index.js',
    statementMap: {
      '0': {
        start: {
          line: 21,
          column: 25
        },
        end: {
          line: 21,
          column: 57
        }
      },
      '1': {
        start: {
          line: 24,
          column: 2
        },
        end: {
          line: 51,
          column: 3
        }
      },
      '2': {
        start: {
          line: 25,
          column: 25
        },
        end: {
          line: 50,
          column: 5
        }
      },
      '3': {
        start: {
          line: 36,
          column: 14
        },
        end: {
          line: 36,
          column: 54
        }
      },
      '4': {
        start: {
          line: 37,
          column: 14
        },
        end: {
          line: 37,
          column: 28
        }
      },
      '5': {
        start: {
          line: 38,
          column: 14
        },
        end: {
          line: 38,
          column: 37
        }
      },
      '6': {
        start: {
          line: 44,
          column: 14
        },
        end: {
          line: 44,
          column: 54
        }
      },
      '7': {
        start: {
          line: 45,
          column: 14
        },
        end: {
          line: 45,
          column: 37
        }
      },
      '8': {
        start: {
          line: 54,
          column: 0
        },
        end: {
          line: 119,
          column: 1
        }
      },
      '9': {
        start: {
          line: 58,
          column: 2
        },
        end: {
          line: 58,
          column: 26
        }
      },
      '10': {
        start: {
          line: 60,
          column: 21
        },
        end: {
          line: 60,
          column: 68
        }
      },
      '11': {
        start: {
          line: 61,
          column: 19
        },
        end: {
          line: 80,
          column: 20
        }
      },
      '12': {
        start: {
          line: 64,
          column: 22
        },
        end: {
          line: 64,
          column: 49
        }
      },
      '13': {
        start: {
          line: 65,
          column: 6
        },
        end: {
          line: 78,
          column: 7
        }
      },
      '14': {
        start: {
          line: 66,
          column: 24
        },
        end: {
          line: 69,
          column: 9
        }
      },
      '15': {
        start: {
          line: 70,
          column: 8
        },
        end: {
          line: 73,
          column: 10
        }
      },
      '16': {
        start: {
          line: 75,
          column: 8
        },
        end: {
          line: 77,
          column: 9
        }
      },
      '17': {
        start: {
          line: 76,
          column: 10
        },
        end: {
          line: 76,
          column: 20
        }
      },
      '18': {
        start: {
          line: 88,
          column: 24
        },
        end: {
          line: 92,
          column: 4
        }
      },
      '19': {
        start: {
          line: 93,
          column: 2
        },
        end: {
          line: 93,
          column: 23
        }
      },
      '20': {
        start: {
          line: 95,
          column: 2
        },
        end: {
          line: 118,
          column: 4
        }
      },
      '21': {
        start: {
          line: 98,
          column: 6
        },
        end: {
          line: 105,
          column: 8
        }
      },
      '22': {
        start: {
          line: 101,
          column: 10
        },
        end: {
          line: 103,
          column: 11
        }
      },
      '23': {
        start: {
          line: 102,
          column: 12
        },
        end: {
          line: 102,
          column: 36
        }
      },
      '24': {
        start: {
          line: 106,
          column: 6
        },
        end: {
          line: 106,
          column: 31
        }
      },
      '25': {
        start: {
          line: 109,
          column: 6
        },
        end: {
          line: 109,
          column: 33
        }
      },
      '26': {
        start: {
          line: 110,
          column: 6
        },
        end: {
          line: 113,
          column: 7
        }
      },
      '27': {
        start: {
          line: 111,
          column: 8
        },
        end: {
          line: 111,
          column: 30
        }
      },
      '28': {
        start: {
          line: 112,
          column: 8
        },
        end: {
          line: 112,
          column: 27
        }
      },
      '29': {
        start: {
          line: 116,
          column: 6
        },
        end: {
          line: 116,
          column: 32
        }
      }
    },
    fnMap: {
      '0': {
        name: 'displayNuclideWarning',
        decl: {
          start: {
            line: 23,
            column: 9
          },
          end: {
            line: 23,
            column: 30
          }
        },
        loc: {
          start: {
            line: 23,
            column: 33
          },
          end: {
            line: 52,
            column: 1
          }
        },
        line: 23
      },
      '1': {
        name: '(anonymous_1)',
        decl: {
          start: {
            line: 63,
            column: 9
          },
          end: {
            line: 63,
            column: 10
          }
        },
        loc: {
          start: {
            line: 63,
            column: 17
          },
          end: {
            line: 79,
            column: 5
          }
        },
        line: 63
      },
      '2': {
        name: '(anonymous_2)',
        decl: {
          start: {
            line: 100,
            column: 43
          },
          end: {
            line: 100,
            column: 44
          }
        },
        loc: {
          start: {
            line: 100,
            column: 50
          },
          end: {
            line: 104,
            column: 9
          }
        },
        line: 100
      }
    },
    branchMap: {
      '0': {
        loc: {
          start: {
            line: 24,
            column: 2
          },
          end: {
            line: 51,
            column: 3
          }
        },
        type: 'if',
        locations: [{
          start: {
            line: 24,
            column: 2
          },
          end: {
            line: 51,
            column: 3
          }
        }, {
          start: {
            line: 24,
            column: 2
          },
          end: {
            line: 51,
            column: 3
          }
        }],
        line: 24
      },
      '1': {
        loc: {
          start: {
            line: 54,
            column: 0
          },
          end: {
            line: 119,
            column: 1
          }
        },
        type: 'if',
        locations: [{
          start: {
            line: 54,
            column: 0
          },
          end: {
            line: 119,
            column: 1
          }
        }, {
          start: {
            line: 54,
            column: 0
          },
          end: {
            line: 119,
            column: 1
          }
        }],
        line: 54
      },
      '2': {
        loc: {
          start: {
            line: 55,
            column: 2
          },
          end: {
            line: 56,
            column: 62
          }
        },
        type: 'binary-expr',
        locations: [{
          start: {
            line: 55,
            column: 2
          },
          end: {
            line: 55,
            column: 45
          }
        }, {
          start: {
            line: 56,
            column: 2
          },
          end: {
            line: 56,
            column: 62
          }
        }],
        line: 55
      },
      '3': {
        loc: {
          start: {
            line: 75,
            column: 8
          },
          end: {
            line: 77,
            column: 9
          }
        },
        type: 'if',
        locations: [{
          start: {
            line: 75,
            column: 8
          },
          end: {
            line: 77,
            column: 9
          }
        }, {
          start: {
            line: 75,
            column: 8
          },
          end: {
            line: 77,
            column: 9
          }
        }],
        line: 75
      },
      '4': {
        loc: {
          start: {
            line: 101,
            column: 10
          },
          end: {
            line: 103,
            column: 11
          }
        },
        type: 'if',
        locations: [{
          start: {
            line: 101,
            column: 10
          },
          end: {
            line: 103,
            column: 11
          }
        }, {
          start: {
            line: 101,
            column: 10
          },
          end: {
            line: 103,
            column: 11
          }
        }],
        line: 101
      },
      '5': {
        loc: {
          start: {
            line: 110,
            column: 6
          },
          end: {
            line: 113,
            column: 7
          }
        },
        type: 'if',
        locations: [{
          start: {
            line: 110,
            column: 6
          },
          end: {
            line: 113,
            column: 7
          }
        }, {
          start: {
            line: 110,
            column: 6
          },
          end: {
            line: 113,
            column: 7
          }
        }],
        line: 110
      }
    },
    s: {
      '0': 0,
      '1': 0,
      '2': 0,
      '3': 0,
      '4': 0,
      '5': 0,
      '6': 0,
      '7': 0,
      '8': 0,
      '9': 0,
      '10': 0,
      '11': 0,
      '12': 0,
      '13': 0,
      '14': 0,
      '15': 0,
      '16': 0,
      '17': 0,
      '18': 0,
      '19': 0,
      '20': 0,
      '21': 0,
      '22': 0,
      '23': 0,
      '24': 0,
      '25': 0,
      '26': 0,
      '27': 0,
      '28': 0,
      '29': 0
    },
    f: {
      '0': 0,
      '1': 0,
      '2': 0
    },
    b: {
      '0': [0, 0],
      '1': [0, 0],
      '2': [0, 0],
      '3': [0, 0],
      '4': [0, 0],
      '5': [0, 0]
    },
    _coverageSchema: '332fd63041d2c1bcb487cc26dd0d5f7d97098a6c'
  },
      coverage = global[gcv] || (global[gcv] = {});

  if (coverage[path] && coverage[path].hash === hash) {
    return coverage[path];
  }

  coverageData.hash = hash;
  return coverage[path] = coverageData;
}();

var _fs = _interopRequireDefault(require('fs'));

var _path = _interopRequireDefault(require('path'));

var _UniversalDisposable;

function _load_UniversalDisposable() {
  return _UniversalDisposable = _interopRequireDefault(require('nuclide-commons/UniversalDisposable'));
}

var _FeatureLoader;

function _load_FeatureLoader() {
  return _FeatureLoader = _interopRequireDefault(require('nuclide-commons-atom/FeatureLoader'));
}

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

/**
 * Copyright (c) 2017-present, Facebook, Inc.
 * All rights reserved.
 *
 * This source code is licensed under the BSD-style license found in the
 * LICENSE file in the root directory of this source tree. An additional grant
 * of patent rights can be found in the PATENTS file in the same directory.
 *
 * 
 * @format
 */

/* eslint-disable rulesdir/no-commonjs */

const HIDE_WARNING_KEY = (cov_1as8dlvlk6.s[0]++, 'atom-ide-ui.hideNuclideWarning');
// eslint-disable-next-line rulesdir/prefer-nuclide-uri


function displayNuclideWarning() {
  cov_1as8dlvlk6.f[0]++;
  cov_1as8dlvlk6.s[1]++;

  if (!atom.config.get(HIDE_WARNING_KEY)) {
    cov_1as8dlvlk6.b[0][0]++;

    const notification = (cov_1as8dlvlk6.s[2]++, atom.notifications.addInfo('Atom IDE UI is bundled with Nuclide', {
      description: '`atom-ide-ui` will be deactivated in favor of Nuclide.<br>' + 'Please disable Nuclide if you only want to use `atom-ide-ui`.',
      dismissable: true,
      buttons: [{
        text: 'Disable Nuclide and reload',
        onDidClick() {
          cov_1as8dlvlk6.s[3]++;

          atom.packages.disablePackage('nuclide');
          cov_1as8dlvlk6.s[4]++;
          atom.reload();
          cov_1as8dlvlk6.s[5]++;
          notification.dismiss();
        }
      }, {
        text: "Don't warn me again",
        onDidClick() {
          cov_1as8dlvlk6.s[6]++;

          atom.config.set(HIDE_WARNING_KEY, true);
          cov_1as8dlvlk6.s[7]++;
          notification.dismiss();
        }
      }]
    }));
  } else {
    cov_1as8dlvlk6.b[0][1]++;
  }
}

cov_1as8dlvlk6.s[8]++;
if ((cov_1as8dlvlk6.b[2][0]++, !atom.packages.isPackageDisabled('nuclide')) && (cov_1as8dlvlk6.b[2][1]++, atom.packages.getAvailablePackageNames().includes('nuclide'))) {
  cov_1as8dlvlk6.b[1][0]++;
  cov_1as8dlvlk6.s[9]++;

  displayNuclideWarning();
} else {
  cov_1as8dlvlk6.b[1][1]++;

  const featureDir = (cov_1as8dlvlk6.s[10]++, _path.default.join(__dirname, 'modules/atom-ide-ui/pkg'));
  const features = (cov_1as8dlvlk6.s[11]++, _fs.default.readdirSync(featureDir).map(item => {
    cov_1as8dlvlk6.f[1]++;

    const dirname = (cov_1as8dlvlk6.s[12]++, _path.default.join(featureDir, item));
    cov_1as8dlvlk6.s[13]++;
    try {
      const pkgJson = (cov_1as8dlvlk6.s[14]++, _fs.default.readFileSync(_path.default.join(dirname, 'package.json'), 'utf8'));
      cov_1as8dlvlk6.s[15]++;
      return {
        dirname,
        pkg: JSON.parse(pkgJson)
      };
    } catch (err) {
      cov_1as8dlvlk6.s[16]++;

      if (err.code !== 'ENOENT') {
        cov_1as8dlvlk6.b[3][0]++;
        cov_1as8dlvlk6.s[17]++;

        throw err;
      } else {
        cov_1as8dlvlk6.b[3][1]++;
      }
    }
  }).filter(Boolean));

  /**
   * Use a unified package loader to load all the feature packages.
   * See the following post for more context:
   * https://nuclide.io/blog/2016/01/13/Nuclide-v0.111.0-The-Unified-Package/
   */
  let disposables;
  const featureLoader = (cov_1as8dlvlk6.s[18]++, new (_FeatureLoader || _load_FeatureLoader()).default({
    pkgName: 'atom-ide-ui',
    config: {},
    features
  }));
  cov_1as8dlvlk6.s[19]++;
  featureLoader.load();

  cov_1as8dlvlk6.s[20]++;
  module.exports = {
    config: featureLoader.getConfig(),
    activate() {
      cov_1as8dlvlk6.s[21]++;

      disposables = new (_UniversalDisposable || _load_UniversalDisposable()).default(require('nuclide-commons-ui'), atom.packages.onDidActivatePackage(pkg => {
        cov_1as8dlvlk6.f[2]++;
        cov_1as8dlvlk6.s[22]++;

        if (pkg.name === 'nuclide') {
          cov_1as8dlvlk6.b[4][0]++;
          cov_1as8dlvlk6.s[23]++;

          displayNuclideWarning();
        } else {
          cov_1as8dlvlk6.b[4][1]++;
        }
      }));
      cov_1as8dlvlk6.s[24]++;
      featureLoader.activate();
    },
    deactivate() {
      cov_1as8dlvlk6.s[25]++;

      featureLoader.deactivate();
      cov_1as8dlvlk6.s[26]++;
      if (disposables != null) {
        cov_1as8dlvlk6.b[5][0]++;
        cov_1as8dlvlk6.s[27]++;

        disposables.dispose();
        cov_1as8dlvlk6.s[28]++;
        disposables = null;
      } else {
        cov_1as8dlvlk6.b[5][1]++;
      }
    },
    serialize() {
      cov_1as8dlvlk6.s[29]++;

      featureLoader.serialize();
    }
  };
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4LmpzIl0sIm5hbWVzIjpbIkhJREVfV0FSTklOR19LRVkiLCJkaXNwbGF5TnVjbGlkZVdhcm5pbmciLCJhdG9tIiwiY29uZmlnIiwiZ2V0Iiwibm90aWZpY2F0aW9uIiwibm90aWZpY2F0aW9ucyIsImFkZEluZm8iLCJkZXNjcmlwdGlvbiIsImRpc21pc3NhYmxlIiwiYnV0dG9ucyIsInRleHQiLCJvbkRpZENsaWNrIiwicGFja2FnZXMiLCJkaXNhYmxlUGFja2FnZSIsInJlbG9hZCIsImRpc21pc3MiLCJzZXQiLCJpc1BhY2thZ2VEaXNhYmxlZCIsImdldEF2YWlsYWJsZVBhY2thZ2VOYW1lcyIsImluY2x1ZGVzIiwiZmVhdHVyZURpciIsImpvaW4iLCJfX2Rpcm5hbWUiLCJmZWF0dXJlcyIsInJlYWRkaXJTeW5jIiwibWFwIiwiaXRlbSIsImRpcm5hbWUiLCJwa2dKc29uIiwicmVhZEZpbGVTeW5jIiwicGtnIiwiSlNPTiIsInBhcnNlIiwiZXJyIiwiY29kZSIsImZpbHRlciIsIkJvb2xlYW4iLCJkaXNwb3NhYmxlcyIsImZlYXR1cmVMb2FkZXIiLCJwa2dOYW1lIiwibG9hZCIsIm1vZHVsZSIsImV4cG9ydHMiLCJnZXRDb25maWciLCJhY3RpdmF0ZSIsInJlcXVpcmUiLCJvbkRpZEFjdGl2YXRlUGFja2FnZSIsIm5hbWUiLCJkZWFjdGl2YXRlIiwiZGlzcG9zZSIsInNlcmlhbGl6ZSJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7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Q0FBZ0Isc0RBQWtCO0FBQ3RDQyxhQUFTLGFBRDZCO0FBRXRDckMsWUFBUSxFQUY4QjtBQUd0Q3FCO0FBSHNDLEdBQWxCLENBQWhCLENBQU47QUE3Qks7QUFrQ0xlLGdCQUFjRSxJQUFkOztBQWxDSztBQW9DTEMsU0FBT0MsT0FBUCxHQUFpQjtBQUNmeEMsWUFBUW9DLGNBQWNLLFNBQWQsRUFETztBQUVmQyxlQUFXO0FBQUE7O0FBQ1RQLG9CQUFjLGtFQUNaUSxRQUFRLG9CQUFSLENBRFksRUFFWjVDLEtBQUtXLFFBQUwsQ0FBY2tDLG9CQUFkLENBQW1DaEIsT0FBTztBQUFBO0FBQUE7O0FBQ3hDLFlBQUlBLElBQUlpQixJQUFKLEtBQWEsU0FBakIsRUFBNEI7QUFBQTtBQUFBOztBQUMxQi9DO0FBQ0QsU0FGRDtBQUFBO0FBQUE7QUFHRCxPQUpELENBRlksQ0FBZDtBQURTO0FBU1RzQyxvQkFBY00sUUFBZDtBQUNELEtBWmM7QUFhZkksaUJBQWE7QUFBQTs7QUFDWFYsb0JBQWNVLFVBQWQ7QUFEVztBQUVYLFVBQUlYLGVBQWUsSUFBbkIsRUFBeUI7QUFBQTtBQUFBOztBQUN2QkEsb0JBQVlZLE9BQVo7QUFEdUI7QUFFdkJaLHNCQUFjLElBQWQ7QUFDRCxPQUhEO0FBQUE7QUFBQTtBQUlELEtBbkJjO0FBb0JmYSxnQkFBWTtBQUFBOztBQUNWWixvQkFBY1ksU0FBZDtBQUNEO0FBdEJjLEdBQWpCO0FBd0JEIiwiZmlsZSI6ImluZGV4LmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTctcHJlc2VudCwgRmFjZWJvb2ssIEluYy5cbiAqIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4gKlxuICogVGhpcyBzb3VyY2UgY29kZSBpcyBsaWNlbnNlZCB1bmRlciB0aGUgQlNELXN0eWxlIGxpY2Vuc2UgZm91bmQgaW4gdGhlXG4gKiBMSUNFTlNFIGZpbGUgaW4gdGhlIHJvb3QgZGlyZWN0b3J5IG9mIHRoaXMgc291cmNlIHRyZWUuIEFuIGFkZGl0aW9uYWwgZ3JhbnRcbiAqIG9mIHBhdGVudCByaWdodHMgY2FuIGJlIGZvdW5kIGluIHRoZSBQQVRFTlRTIGZpbGUgaW4gdGhlIHNhbWUgZGlyZWN0b3J5LlxuICpcbiAqIEBmbG93XG4gKiBAZm9ybWF0XG4gKi9cblxuLyogZXNsaW50LWRpc2FibGUgcnVsZXNkaXIvbm8tY29tbW9uanMgKi9cblxuaW1wb3J0IGZzIGZyb20gJ2ZzJztcbi8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBydWxlc2Rpci9wcmVmZXItbnVjbGlkZS11cmlcbmltcG9ydCBwYXRoIGZyb20gJ3BhdGgnO1xuaW1wb3J0IFVuaXZlcnNhbERpc3Bvc2FibGUgZnJvbSAnbnVjbGlkZS1jb21tb25zL1VuaXZlcnNhbERpc3Bvc2FibGUnO1xuaW1wb3J0IEZlYXR1cmVMb2FkZXIgZnJvbSAnbnVjbGlkZS1jb21tb25zLWF0b20vRmVhdHVyZUxvYWRlcic7XG5cbmNvbnN0IEhJREVfV0FSTklOR19LRVkgPSAnYXRvbS1pZGUtdWkuaGlkZU51Y2xpZGVXYXJuaW5nJztcblxuZnVuY3Rpb24gZGlzcGxheU51Y2xpZGVXYXJuaW5nKCkge1xuICBpZiAoIWF0b20uY29uZmlnLmdldChISURFX1dBUk5JTkdfS0VZKSkge1xuICAgIGNvbnN0IG5vdGlmaWNhdGlvbiA9IGF0b20ubm90aWZpY2F0aW9ucy5hZGRJbmZvKFxuICAgICAgJ0F0b20gSURFIFVJIGlzIGJ1bmRsZWQgd2l0aCBOdWNsaWRlJyxcbiAgICAgIHtcbiAgICAgICAgZGVzY3JpcHRpb246XG4gICAgICAgICAgJ2BhdG9tLWlkZS11aWAgd2lsbCBiZSBkZWFjdGl2YXRlZCBpbiBmYXZvciBvZiBOdWNsaWRlLjxicj4nICtcbiAgICAgICAgICAnUGxlYXNlIGRpc2FibGUgTnVjbGlkZSBpZiB5b3Ugb25seSB3YW50IHRvIHVzZSBgYXRvbS1pZGUtdWlgLicsXG4gICAgICAgIGRpc21pc3NhYmxlOiB0cnVlLFxuICAgICAgICBidXR0b25zOiBbXG4gICAgICAgICAge1xuICAgICAgICAgICAgdGV4dDogJ0Rpc2FibGUgTnVjbGlkZSBhbmQgcmVsb2FkJyxcbiAgICAgICAgICAgIG9uRGlkQ2xpY2soKSB7XG4gICAgICAgICAgICAgIGF0b20ucGFja2FnZXMuZGlzYWJsZVBhY2thZ2UoJ251Y2xpZGUnKTtcbiAgICAgICAgICAgICAgYXRvbS5yZWxvYWQoKTtcbiAgICAgICAgICAgICAgbm90aWZpY2F0aW9uLmRpc21pc3MoKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgfSxcbiAgICAgICAgICB7XG4gICAgICAgICAgICB0ZXh0OiBcIkRvbid0IHdhcm4gbWUgYWdhaW5cIixcbiAgICAgICAgICAgIG9uRGlkQ2xpY2soKSB7XG4gICAgICAgICAgICAgIGF0b20uY29uZmlnLnNldChISURFX1dBUk5JTkdfS0VZLCB0cnVlKTtcbiAgICAgICAgICAgICAgbm90aWZpY2F0aW9uLmRpc21pc3MoKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgfSxcbiAgICAgICAgXSxcbiAgICAgIH0sXG4gICAgKTtcbiAgfVxufVxuXG5pZiAoXG4gICFhdG9tLnBhY2thZ2VzLmlzUGFja2FnZURpc2FibGVkKCdudWNsaWRlJykgJiZcbiAgYXRvbS5wYWNrYWdlcy5nZXRBdmFpbGFibGVQYWNrYWdlTmFtZXMoKS5pbmNsdWRlcygnbnVjbGlkZScpXG4pIHtcbiAgZGlzcGxheU51Y2xpZGVXYXJuaW5nKCk7XG59IGVsc2Uge1xuICBjb25zdCBmZWF0dXJlRGlyID0gcGF0aC5qb2luKF9fZGlybmFtZSwgJ21vZHVsZXMvYXRvbS1pZGUtdWkvcGtnJyk7XG4gIGNvbnN0IGZlYXR1cmVzID0gZnNcbiAgICAucmVhZGRpclN5bmMoZmVhdHVyZURpcilcbiAgICAubWFwKGl0ZW0gPT4ge1xuICAgICAgY29uc3QgZGlybmFtZSA9IHBhdGguam9pbihmZWF0dXJlRGlyLCBpdGVtKTtcbiAgICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IHBrZ0pzb24gPSBmcy5yZWFkRmlsZVN5bmMoXG4gICAgICAgICAgcGF0aC5qb2luKGRpcm5hbWUsICdwYWNrYWdlLmpzb24nKSxcbiAgICAgICAgICAndXRmOCcsXG4gICAgICAgICk7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgZGlybmFtZSxcbiAgICAgICAgICBwa2c6IEpTT04ucGFyc2UocGtnSnNvbiksXG4gICAgICAgIH07XG4gICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgaWYgKGVyci5jb2RlICE9PSAnRU5PRU5UJykge1xuICAgICAgICAgIHRocm93IGVycjtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pXG4gICAgLmZpbHRlcihCb29sZWFuKTtcblxuICAvKipcbiAgICogVXNlIGEgdW5pZmllZCBwYWNrYWdlIGxvYWRlciB0byBsb2FkIGFsbCB0aGUgZmVhdHVyZSBwYWNrYWdlcy5cbiAgICogU2VlIHRoZSBmb2xsb3dpbmcgcG9zdCBmb3IgbW9yZSBjb250ZXh0OlxuICAgKiBodHRwczovL251Y2xpZGUuaW8vYmxvZy8yMDE2LzAxLzEzL051Y2xpZGUtdjAuMTExLjAtVGhlLVVuaWZpZWQtUGFja2FnZS9cbiAgICovXG4gIGxldCBkaXNwb3NhYmxlczogP1VuaXZlcnNhbERpc3Bvc2FibGU7XG4gIGNvbnN0IGZlYXR1cmVMb2FkZXIgPSBuZXcgRmVhdHVyZUxvYWRlcih7XG4gICAgcGtnTmFtZTogJ2F0b20taWRlLXVpJyxcbiAgICBjb25maWc6IHt9LFxuICAgIGZlYXR1cmVzLFxuICB9KTtcbiAgZmVhdHVyZUxvYWRlci5sb2FkKCk7XG5cbiAgbW9kdWxlLmV4cG9ydHMgPSB7XG4gICAgY29uZmlnOiBmZWF0dXJlTG9hZGVyLmdldENvbmZpZygpLFxuICAgIGFjdGl2YXRlKCkge1xuICAgICAgZGlzcG9zYWJsZXMgPSBuZXcgVW5pdmVyc2FsRGlzcG9zYWJsZShcbiAgICAgICAgcmVxdWlyZSgnbnVjbGlkZS1jb21tb25zLXVpJyksXG4gICAgICAgIGF0b20ucGFja2FnZXMub25EaWRBY3RpdmF0ZVBhY2thZ2UocGtnID0+IHtcbiAgICAgICAgICBpZiAocGtnLm5hbWUgPT09ICdudWNsaWRlJykge1xuICAgICAgICAgICAgZGlzcGxheU51Y2xpZGVXYXJuaW5nKCk7XG4gICAgICAgICAgfVxuICAgICAgICB9KSxcbiAgICAgICk7XG4gICAgICBmZWF0dXJlTG9hZGVyLmFjdGl2YXRlKCk7XG4gICAgfSxcbiAgICBkZWFjdGl2YXRlKCkge1xuICAgICAgZmVhdHVyZUxvYWRlci5kZWFjdGl2YXRlKCk7XG4gICAgICBpZiAoZGlzcG9zYWJsZXMgIT0gbnVsbCkge1xuICAgICAgICBkaXNwb3NhYmxlcy5kaXNwb3NlKCk7XG4gICAgICAgIGRpc3Bvc2FibGVzID0gbnVsbDtcbiAgICAgIH1cbiAgICB9LFxuICAgIHNlcmlhbGl6ZSgpIHtcbiAgICAgIGZlYXR1cmVMb2FkZXIuc2VyaWFsaXplKCk7XG4gICAgfSxcbiAgfTtcbn1cbiJdfQ==