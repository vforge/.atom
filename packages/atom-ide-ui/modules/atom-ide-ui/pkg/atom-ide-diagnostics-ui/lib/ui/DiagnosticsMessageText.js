'use strict';

var cov_uo8am505o = function () {
  var path = '/Users/hansonw/atom-ide-ui/modules/atom-ide-ui/pkg/atom-ide-diagnostics-ui/lib/ui/DiagnosticsMessageText.js',
      hash = '1aaaf7700a54ded2f8eeee2c45013c3997cd099a',
      global = new Function('return this')(),
      gcv = '__coverage__',
      coverageData = {
    path: '/Users/hansonw/atom-ide-ui/modules/atom-ide-ui/pkg/atom-ide-diagnostics-ui/lib/ui/DiagnosticsMessageText.js',
    statementMap: {
      '0': {
        start: {
          line: 40,
          column: 19
        },
        end: {
          line: 40,
          column: 66
        }
      },
      '1': {
        start: {
          line: 42,
          column: 15
        },
        end: {
          line: 42,
          column: 38
        }
      },
      '2': {
        start: {
          line: 43,
          column: 18
        },
        end: {
          line: 43,
          column: 41
        }
      },
      '3': {
        start: {
          line: 45,
          column: 34
        },
        end: {
          line: 50,
          column: 3
        }
      },
      '4': {
        start: {
          line: 51,
          column: 2
        },
        end: {
          line: 61,
          column: 3
        }
      },
      '5': {
        start: {
          line: 52,
          column: 4
        },
        end: {
          line: 52,
          column: 28
        }
      },
      '6': {
        start: {
          line: 53,
          column: 4
        },
        end: {
          line: 56,
          column: 7
        }
      },
      '7': {
        start: {
          line: 57,
          column: 4
        },
        end: {
          line: 60,
          column: 7
        }
      },
      '8': {
        start: {
          line: 62,
          column: 2
        },
        end: {
          line: 62,
          column: 15
        }
      },
      '9': {
        start: {
          line: 65,
          column: 30
        },
        end: {
          line: 65,
          column: 36
        }
      },
      '10': {
        start: {
          line: 66,
          column: 13
        },
        end: {
          line: 66,
          column: 19
        }
      },
      '11': {
        start: {
          line: 71,
          column: 32
        },
        end: {
          line: 74,
          column: 3
        }
      },
      '12': {
        start: {
          line: 73,
          column: 18
        },
        end: {
          line: 73,
          column: 48
        }
      },
      '13': {
        start: {
          line: 75,
          column: 16
        },
        end: {
          line: 88,
          column: 4
        }
      },
      '14': {
        start: {
          line: 76,
          column: 4
        },
        end: {
          line: 87,
          column: 5
        }
      },
      '15': {
        start: {
          line: 77,
          column: 6
        },
        end: {
          line: 77,
          column: 23
        }
      },
      '16': {
        start: {
          line: 79,
          column: 22
        },
        end: {
          line: 81,
          column: 7
        }
      },
      '17': {
        start: {
          line: 80,
          column: 8
        },
        end: {
          line: 80,
          column: 37
        }
      },
      '18': {
        start: {
          line: 82,
          column: 6
        },
        end: {
          line: 86,
          column: 8
        }
      },
      '19': {
        start: {
          line: 90,
          column: 2
        },
        end: {
          line: 96,
          column: 4
        }
      },
      '20': {
        start: {
          line: 99,
          column: 38
        },
        end: {
          line: 117,
          column: 1
        }
      },
      '21': {
        start: {
          line: 100,
          column: 20
        },
        end: {
          line: 100,
          column: 25
        }
      },
      '22': {
        start: {
          line: 101,
          column: 2
        },
        end: {
          line: 116,
          column: 3
        }
      },
      '23': {
        start: {
          line: 102,
          column: 4
        },
        end: {
          line: 107,
          column: 6
        }
      },
      '24': {
        start: {
          line: 108,
          column: 9
        },
        end: {
          line: 116,
          column: 3
        }
      },
      '25': {
        start: {
          line: 110,
          column: 6
        },
        end: {
          line: 112,
          column: 24
        }
      },
      '26': {
        start: {
          line: 113,
          column: 4
        },
        end: {
          line: 113,
          column: 76
        }
      },
      '27': {
        start: {
          line: 115,
          column: 4
        },
        end: {
          line: 115,
          column: 50
        }
      }
    },
    fnMap: {
      '0': {
        name: 'separateUrls',
        decl: {
          start: {
            line: 36,
            column: 16
          },
          end: {
            line: 36,
            column: 28
          }
        },
        loc: {
          start: {
            line: 36,
            column: 64
          },
          end: {
            line: 63,
            column: 1
          }
        },
        line: 36
      },
      '1': {
        name: 'renderRowWithLinks',
        decl: {
          start: {
            line: 67,
            column: 9
          },
          end: {
            line: 67,
            column: 27
          }
        },
        loc: {
          start: {
            line: 70,
            column: 22
          },
          end: {
            line: 97,
            column: 1
          }
        },
        line: 70
      },
      '2': {
        name: '(anonymous_2)',
        decl: {
          start: {
            line: 73,
            column: 4
          },
          end: {
            line: 73,
            column: 5
          }
        },
        loc: {
          start: {
            line: 73,
            column: 18
          },
          end: {
            line: 73,
            column: 48
          }
        },
        line: 73
      },
      '3': {
        name: '(anonymous_3)',
        decl: {
          start: {
            line: 75,
            column: 56
          },
          end: {
            line: 75,
            column: 57
          }
        },
        loc: {
          start: {
            line: 75,
            column: 73
          },
          end: {
            line: 88,
            column: 3
          }
        },
        line: 75
      },
      '4': {
        name: '(anonymous_4)',
        decl: {
          start: {
            line: 79,
            column: 22
          },
          end: {
            line: 79,
            column: 23
          }
        },
        loc: {
          start: {
            line: 79,
            column: 28
          },
          end: {
            line: 81,
            column: 7
          }
        },
        line: 79
      },
      '5': {
        name: '(anonymous_5)',
        decl: {
          start: {
            line: 99,
            column: 38
          },
          end: {
            line: 99,
            column: 39
          }
        },
        loc: {
          start: {
            line: 99,
            column: 78
          },
          end: {
            line: 117,
            column: 1
          }
        },
        line: 99
      }
    },
    branchMap: {
      '0': {
        loc: {
          start: {
            line: 76,
            column: 4
          },
          end: {
            line: 87,
            column: 5
          }
        },
        type: 'if',
        locations: [{
          start: {
            line: 76,
            column: 4
          },
          end: {
            line: 87,
            column: 5
          }
        }, {
          start: {
            line: 76,
            column: 4
          },
          end: {
            line: 87,
            column: 5
          }
        }],
        line: 76
      },
      '1': {
        loc: {
          start: {
            line: 101,
            column: 2
          },
          end: {
            line: 116,
            column: 3
          }
        },
        type: 'if',
        locations: [{
          start: {
            line: 101,
            column: 2
          },
          end: {
            line: 116,
            column: 3
          }
        }, {
          start: {
            line: 101,
            column: 2
          },
          end: {
            line: 116,
            column: 3
          }
        }],
        line: 101
      },
      '2': {
        loc: {
          start: {
            line: 108,
            column: 9
          },
          end: {
            line: 116,
            column: 3
          }
        },
        type: 'if',
        locations: [{
          start: {
            line: 108,
            column: 9
          },
          end: {
            line: 116,
            column: 3
          }
        }, {
          start: {
            line: 108,
            column: 9
          },
          end: {
            line: 116,
            column: 3
          }
        }],
        line: 108
      },
      '3': {
        loc: {
          start: {
            line: 110,
            column: 6
          },
          end: {
            line: 112,
            column: 24
          }
        },
        type: 'cond-expr',
        locations: [{
          start: {
            line: 111,
            column: 10
          },
          end: {
            line: 111,
            column: 34
          }
        }, {
          start: {
            line: 112,
            column: 10
          },
          end: {
            line: 112,
            column: 24
          }
        }],
        line: 110
      }
    },
    s: {
      '0': 0,
      '1': 0,
      '2': 0,
      '3': 0,
      '4': 0,
      '5': 0,
      '6': 0,
      '7': 0,
      '8': 0,
      '9': 0,
      '10': 0,
      '11': 0,
      '12': 0,
      '13': 0,
      '14': 0,
      '15': 0,
      '16': 0,
      '17': 0,
      '18': 0,
      '19': 0,
      '20': 0,
      '21': 0,
      '22': 0,
      '23': 0,
      '24': 0,
      '25': 0,
      '26': 0,
      '27': 0
    },
    f: {
      '0': 0,
      '1': 0,
      '2': 0,
      '3': 0,
      '4': 0,
      '5': 0
    },
    b: {
      '0': [0, 0],
      '1': [0, 0],
      '2': [0, 0],
      '3': [0, 0]
    },
    _coverageSchema: '332fd63041d2c1bcb487cc26dd0d5f7d97098a6c'
  },
      coverage = global[gcv] || (global[gcv] = {});

  if (coverage[path] && coverage[path].hash === hash) {
    return coverage[path];
  }

  coverageData.hash = hash;
  return coverage[path] = coverageData;
}();

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.DiagnosticsMessageText = undefined;
exports.separateUrls = separateUrls;

var _react = _interopRequireWildcard(require('react'));

var _electron = require('electron');

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }

// Exported for testing.
function separateUrls(message) {
  cov_uo8am505o.f[0]++;

  // Don't match periods at the end of URLs, because those are usually just to
  // end the sentence and not actually part of the URL. Optionally match
  // parameters following a question mark.
  const urlRegex = (cov_uo8am505o.s[0]++, /https?:\/\/[\w/._-]*[\w/_-](?:\?[\w/_=&-]*)?/g);

  const urls = (cov_uo8am505o.s[1]++, message.match(urlRegex));
  const nonUrls = (cov_uo8am505o.s[2]++, message.split(urlRegex));

  const parts = (cov_uo8am505o.s[3]++, [{
    isUrl: false,
    text: nonUrls[0]
  }]);
  cov_uo8am505o.s[4]++;
  for (let i = 1; i < nonUrls.length; i++) {
    cov_uo8am505o.s[5]++;

    if (!(urls != null)) {
      throw new Error('Invariant violation: "urls != null"');
    }

    cov_uo8am505o.s[6]++;

    parts.push({
      isUrl: true,
      url: urls[i - 1]
    });
    cov_uo8am505o.s[7]++;
    parts.push({
      isUrl: false,
      text: nonUrls[i]
    });
  }
  cov_uo8am505o.s[8]++;
  return parts;
} /**
   * Copyright (c) 2017-present, Facebook, Inc.
   * All rights reserved.
   *
   * This source code is licensed under the BSD-style license found in the
   * LICENSE file in the root directory of this source tree. An additional grant
   * of patent rights can be found in the PATENTS file in the same directory.
   *
   * 
   * @format
   */

const LEADING_WHITESPACE_RE = (cov_uo8am505o.s[9]++, /^\s+/);
const NBSP = (cov_uo8am505o.s[10]++, '\xa0');
function renderRowWithLinks(message, rowIndex) {
  cov_uo8am505o.f[1]++;

  const messageWithWhitespace = (cov_uo8am505o.s[11]++, message.replace(LEADING_WHITESPACE_RE, whitespace => {
    cov_uo8am505o.f[2]++;
    cov_uo8am505o.s[12]++;
    return NBSP.repeat(whitespace.length);
  }));
  const parts = (cov_uo8am505o.s[13]++, separateUrls(messageWithWhitespace).map((part, index) => {
    cov_uo8am505o.f[3]++;
    cov_uo8am505o.s[14]++;

    if (!part.isUrl) {
      cov_uo8am505o.b[0][0]++;
      cov_uo8am505o.s[15]++;

      return part.text;
    } else {
      cov_uo8am505o.b[0][1]++;
      cov_uo8am505o.s[16]++;

      const openUrl = () => {
        cov_uo8am505o.f[4]++;
        cov_uo8am505o.s[17]++;

        _electron.shell.openExternal(part.url);
      };
      cov_uo8am505o.s[18]++;
      return _react.createElement(
        'a',
        { href: '#', key: index, onClick: openUrl },
        part.url
      );
    }
  }));

  cov_uo8am505o.s[19]++;
  return (
    // We need to use a span here instead of a div so that `text-overflow: ellipsis` works.
    _react.createElement(
      'span',
      { key: rowIndex },
      parts,
      _react.createElement('br', null)
    )
  );
}

cov_uo8am505o.s[20]++;
const DiagnosticsMessageText = exports.DiagnosticsMessageText = props => {
  cov_uo8am505o.f[5]++;

  const { message } = (cov_uo8am505o.s[21]++, props);
  cov_uo8am505o.s[22]++;
  if (message.html != null) {
    cov_uo8am505o.b[1][0]++;
    cov_uo8am505o.s[23]++;

    return _react.createElement('span', {
      title: message.text,
      dangerouslySetInnerHTML: { __html: message.html }
    });
  } else {
      cov_uo8am505o.b[1][1]++;
      cov_uo8am505o.s[24]++;
      if (message.text != null) {
        cov_uo8am505o.b[2][0]++;

        const rows = (cov_uo8am505o.s[25]++, props.preserveNewlines !== false ? (cov_uo8am505o.b[3][0]++, message.text.split('\n')) : (cov_uo8am505o.b[3][1]++, [message.text]));
        cov_uo8am505o.s[26]++;
        return _react.createElement(
          'span',
          { title: message.text },
          rows.map(renderRowWithLinks)
        );
      } else {
        cov_uo8am505o.b[2][1]++;
        cov_uo8am505o.s[27]++;

        return _react.createElement(
          'span',
          null,
          'Diagnostic lacks message.'
        );
      }
    }
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkRpYWdub3N0aWNzTWVzc2FnZVRleHQuanMiXSwibmFtZXMiOlsic2VwYXJhdGVVcmxzIiwibWVzc2FnZSIsInVybFJlZ2V4IiwidXJscyIsIm1hdGNoIiwibm9uVXJscyIsInNwbGl0IiwicGFydHMiLCJpc1VybCIsInRleHQiLCJpIiwibGVuZ3RoIiwicHVzaCIsInVybCIsIkxFQURJTkdfV0hJVEVTUEFDRV9SRSIsIk5CU1AiLCJyZW5kZXJSb3dXaXRoTGlua3MiLCJyb3dJbmRleCIsIm1lc3NhZ2VXaXRoV2hpdGVzcGFjZSIsInJlcGxhY2UiLCJ3aGl0ZXNwYWNlIiwicmVwZWF0IiwibWFwIiwicGFydCIsImluZGV4Iiwib3BlblVybCIsIm9wZW5FeHRlcm5hbCIsIkRpYWdub3N0aWNzTWVzc2FnZVRleHQiLCJwcm9wcyIsImh0bWwiLCJfX2h0bWwiLCJyb3dzIiwicHJlc2VydmVOZXdsaW5lcyJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7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QUFBQTs7QUFDL0IsY0FBTXNCLCtCQUNKSCxNQUFNSSxnQkFBTixLQUEyQixLQUEzQiw2QkFDSS9CLFFBQVFRLElBQVIsQ0FBYUgsS0FBYixDQUFtQixJQUFuQixDQURKLDhCQUVJLENBQUNMLFFBQVFRLElBQVQsQ0FGSixDQURJLENBQU47QUFEK0I7QUFLL0IsZUFBTztBQUFBO0FBQUEsWUFBTSxPQUFPUixRQUFRUSxJQUFyQjtBQUE0QnNCLGVBQUtULEdBQUwsQ0FBU04sa0JBQVQ7QUFBNUIsU0FBUDtBQUNELE9BTk0sTUFNQTtBQUFBO0FBQUE7O0FBQ0wsZUFBTztBQUFBO0FBQUE7QUFBQTtBQUFBLFNBQVA7QUFDRDtBQUFBO0FBQ0YsQ0FsQk0iLCJmaWxlIjoiRGlhZ25vc3RpY3NNZXNzYWdlVGV4dC5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogQ29weXJpZ2h0IChjKSAyMDE3LXByZXNlbnQsIEZhY2Vib29rLCBJbmMuXG4gKiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuICpcbiAqIFRoaXMgc291cmNlIGNvZGUgaXMgbGljZW5zZWQgdW5kZXIgdGhlIEJTRC1zdHlsZSBsaWNlbnNlIGZvdW5kIGluIHRoZVxuICogTElDRU5TRSBmaWxlIGluIHRoZSByb290IGRpcmVjdG9yeSBvZiB0aGlzIHNvdXJjZSB0cmVlLiBBbiBhZGRpdGlvbmFsIGdyYW50XG4gKiBvZiBwYXRlbnQgcmlnaHRzIGNhbiBiZSBmb3VuZCBpbiB0aGUgUEFURU5UUyBmaWxlIGluIHRoZSBzYW1lIGRpcmVjdG9yeS5cbiAqXG4gKiBAZmxvd1xuICogQGZvcm1hdFxuICovXG5cbmltcG9ydCBpbnZhcmlhbnQgZnJvbSAnYXNzZXJ0JztcbmltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcbmltcG9ydCB7c2hlbGx9IGZyb20gJ2VsZWN0cm9uJztcblxudHlwZSBEaWFnbm9zdGljc01lc3NhZ2VUZXh0UHJvcHMgPSB7XG4gIHByZXNlcnZlTmV3bGluZXM/OiBib29sZWFuLCAvLyBkZWZhdWx0cyB0byB0cnVlXG4gIG1lc3NhZ2U6IHtcbiAgICBodG1sPzogc3RyaW5nLFxuICAgIHRleHQ/OiBzdHJpbmcsXG4gIH0sXG59O1xuXG50eXBlIFVybE9yVGV4dCA9XG4gIHwge1xuICAgICAgaXNVcmw6IHRydWUsXG4gICAgICB1cmw6IHN0cmluZyxcbiAgICB9XG4gIHwge1xuICAgICAgaXNVcmw6IGZhbHNlLFxuICAgICAgdGV4dDogc3RyaW5nLFxuICAgIH07XG5cbi8vIEV4cG9ydGVkIGZvciB0ZXN0aW5nLlxuZXhwb3J0IGZ1bmN0aW9uIHNlcGFyYXRlVXJscyhtZXNzYWdlOiBzdHJpbmcpOiBBcnJheTxVcmxPclRleHQ+IHtcbiAgLy8gRG9uJ3QgbWF0Y2ggcGVyaW9kcyBhdCB0aGUgZW5kIG9mIFVSTHMsIGJlY2F1c2UgdGhvc2UgYXJlIHVzdWFsbHkganVzdCB0b1xuICAvLyBlbmQgdGhlIHNlbnRlbmNlIGFuZCBub3QgYWN0dWFsbHkgcGFydCBvZiB0aGUgVVJMLiBPcHRpb25hbGx5IG1hdGNoXG4gIC8vIHBhcmFtZXRlcnMgZm9sbG93aW5nIGEgcXVlc3Rpb24gbWFyay5cbiAgY29uc3QgdXJsUmVnZXggPSAvaHR0cHM/OlxcL1xcL1tcXHcvLl8tXSpbXFx3L18tXSg/OlxcP1tcXHcvXz0mLV0qKT8vZztcblxuICBjb25zdCB1cmxzID0gbWVzc2FnZS5tYXRjaCh1cmxSZWdleCk7XG4gIGNvbnN0IG5vblVybHMgPSBtZXNzYWdlLnNwbGl0KHVybFJlZ2V4KTtcblxuICBjb25zdCBwYXJ0czogQXJyYXk8VXJsT3JUZXh0PiA9IFtcbiAgICB7XG4gICAgICBpc1VybDogZmFsc2UsXG4gICAgICB0ZXh0OiBub25VcmxzWzBdLFxuICAgIH0sXG4gIF07XG4gIGZvciAobGV0IGkgPSAxOyBpIDwgbm9uVXJscy5sZW5ndGg7IGkrKykge1xuICAgIGludmFyaWFudCh1cmxzICE9IG51bGwpO1xuICAgIHBhcnRzLnB1c2goe1xuICAgICAgaXNVcmw6IHRydWUsXG4gICAgICB1cmw6IHVybHNbaSAtIDFdLFxuICAgIH0pO1xuICAgIHBhcnRzLnB1c2goe1xuICAgICAgaXNVcmw6IGZhbHNlLFxuICAgICAgdGV4dDogbm9uVXJsc1tpXSxcbiAgICB9KTtcbiAgfVxuICByZXR1cm4gcGFydHM7XG59XG5cbmNvbnN0IExFQURJTkdfV0hJVEVTUEFDRV9SRSA9IC9eXFxzKy87XG5jb25zdCBOQlNQID0gJ1xceGEwJztcbmZ1bmN0aW9uIHJlbmRlclJvd1dpdGhMaW5rcyhcbiAgbWVzc2FnZTogc3RyaW5nLFxuICByb3dJbmRleDogbnVtYmVyLFxuKTogUmVhY3QuRWxlbWVudDxhbnk+IHtcbiAgY29uc3QgbWVzc2FnZVdpdGhXaGl0ZXNwYWNlID0gbWVzc2FnZS5yZXBsYWNlKFxuICAgIExFQURJTkdfV0hJVEVTUEFDRV9SRSxcbiAgICB3aGl0ZXNwYWNlID0+IE5CU1AucmVwZWF0KHdoaXRlc3BhY2UubGVuZ3RoKSxcbiAgKTtcbiAgY29uc3QgcGFydHMgPSBzZXBhcmF0ZVVybHMobWVzc2FnZVdpdGhXaGl0ZXNwYWNlKS5tYXAoKHBhcnQsIGluZGV4KSA9PiB7XG4gICAgaWYgKCFwYXJ0LmlzVXJsKSB7XG4gICAgICByZXR1cm4gcGFydC50ZXh0O1xuICAgIH0gZWxzZSB7XG4gICAgICBjb25zdCBvcGVuVXJsID0gKCkgPT4ge1xuICAgICAgICBzaGVsbC5vcGVuRXh0ZXJuYWwocGFydC51cmwpO1xuICAgICAgfTtcbiAgICAgIHJldHVybiAoXG4gICAgICAgIDxhIGhyZWY9XCIjXCIga2V5PXtpbmRleH0gb25DbGljaz17b3BlblVybH0+XG4gICAgICAgICAge3BhcnQudXJsfVxuICAgICAgICA8L2E+XG4gICAgICApO1xuICAgIH1cbiAgfSk7XG5cbiAgcmV0dXJuIChcbiAgICAvLyBXZSBuZWVkIHRvIHVzZSBhIHNwYW4gaGVyZSBpbnN0ZWFkIG9mIGEgZGl2IHNvIHRoYXQgYHRleHQtb3ZlcmZsb3c6IGVsbGlwc2lzYCB3b3Jrcy5cbiAgICA8c3BhbiBrZXk9e3Jvd0luZGV4fT5cbiAgICAgIHtwYXJ0c31cbiAgICAgIDxiciAvPlxuICAgIDwvc3Bhbj5cbiAgKTtcbn1cblxuZXhwb3J0IGNvbnN0IERpYWdub3N0aWNzTWVzc2FnZVRleHQgPSAocHJvcHM6IERpYWdub3N0aWNzTWVzc2FnZVRleHRQcm9wcykgPT4ge1xuICBjb25zdCB7bWVzc2FnZX0gPSBwcm9wcztcbiAgaWYgKG1lc3NhZ2UuaHRtbCAhPSBudWxsKSB7XG4gICAgcmV0dXJuIChcbiAgICAgIDxzcGFuXG4gICAgICAgIHRpdGxlPXttZXNzYWdlLnRleHR9XG4gICAgICAgIGRhbmdlcm91c2x5U2V0SW5uZXJIVE1MPXt7X19odG1sOiBtZXNzYWdlLmh0bWx9fVxuICAgICAgLz5cbiAgICApO1xuICB9IGVsc2UgaWYgKG1lc3NhZ2UudGV4dCAhPSBudWxsKSB7XG4gICAgY29uc3Qgcm93cyA9XG4gICAgICBwcm9wcy5wcmVzZXJ2ZU5ld2xpbmVzICE9PSBmYWxzZVxuICAgICAgICA/IG1lc3NhZ2UudGV4dC5zcGxpdCgnXFxuJylcbiAgICAgICAgOiBbbWVzc2FnZS50ZXh0XTtcbiAgICByZXR1cm4gPHNwYW4gdGl0bGU9e21lc3NhZ2UudGV4dH0+e3Jvd3MubWFwKHJlbmRlclJvd1dpdGhMaW5rcyl9PC9zcGFuPjtcbiAgfSBlbHNlIHtcbiAgICByZXR1cm4gPHNwYW4+RGlhZ25vc3RpYyBsYWNrcyBtZXNzYWdlLjwvc3Bhbj47XG4gIH1cbn07XG4iXX0=