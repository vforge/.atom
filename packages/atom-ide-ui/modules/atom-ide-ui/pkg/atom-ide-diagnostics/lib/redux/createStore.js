'use strict';

var cov_2f90625lek = function () {
  var path = '/Users/hansonw/atom-ide-ui/modules/atom-ide-ui/pkg/atom-ide-diagnostics/lib/redux/createStore.js',
      hash = 'e3d3fd20cf607a1b2f31fff95480742b25ac4281',
      global = new Function('return this')(),
      gcv = '__coverage__',
      coverageData = {
    path: '/Users/hansonw/atom-ide-ui/modules/atom-ide-ui/pkg/atom-ide-diagnostics/lib/redux/createStore.js',
    statementMap: {
      '0': {
        start: {
          line: 36,
          column: 16
        },
        end: {
          line: 38,
          column: 47
        }
      },
      '1': {
        start: {
          line: 37,
          column: 14
        },
        end: {
          line: 37,
          column: 22
        }
      },
      '2': {
        start: {
          line: 38,
          column: 20
        },
        end: {
          line: 38,
          column: 46
        }
      },
      '3': {
        start: {
          line: 39,
          column: 19
        },
        end: {
          line: 45,
          column: 8
        }
      },
      '4': {
        start: {
          line: 40,
          column: 4
        },
        end: {
          line: 45,
          column: 8
        }
      },
      '5': {
        start: {
          line: 43,
          column: 8
        },
        end: {
          line: 43,
          column: 53
        }
      },
      '6': {
        start: {
          line: 44,
          column: 8
        },
        end: {
          line: 44,
          column: 22
        }
      },
      '7': {
        start: {
          line: 46,
          column: 16
        },
        end: {
          line: 50,
          column: 3
        }
      },
      '8': {
        start: {
          line: 53,
          column: 28
        },
        end: {
          line: 55,
          column: 46
        }
      },
      '9': {
        start: {
          line: 54,
          column: 23
        },
        end: {
          line: 54,
          column: 76
        }
      },
      '10': {
        start: {
          line: 54,
          column: 56
        },
        end: {
          line: 54,
          column: 75
        }
      },
      '11': {
        start: {
          line: 55,
          column: 26
        },
        end: {
          line: 55,
          column: 45
        }
      },
      '12': {
        start: {
          line: 56,
          column: 2
        },
        end: {
          line: 63,
          column: 5
        }
      },
      '13': {
        start: {
          line: 57,
          column: 4
        },
        end: {
          line: 59,
          column: 5
        }
      },
      '14': {
        start: {
          line: 58,
          column: 6
        },
        end: {
          line: 58,
          column: 49
        }
      },
      '15': {
        start: {
          line: 60,
          column: 4
        },
        end: {
          line: 62,
          column: 5
        }
      },
      '16': {
        start: {
          line: 61,
          column: 6
        },
        end: {
          line: 61,
          column: 54
        }
      },
      '17': {
        start: {
          line: 65,
          column: 2
        },
        end: {
          line: 65,
          column: 15
        }
      },
      '18': {
        start: {
          line: 68,
          column: 22
        },
        end: {
          line: 74,
          column: 1
        }
      },
      '19': {
        start: {
          line: 78,
          column: 39
        },
        end: {
          line: 78,
          column: 61
        }
      },
      '20': {
        start: {
          line: 79,
          column: 2
        },
        end: {
          line: 88,
          column: 7
        }
      },
      '21': {
        start: {
          line: 80,
          column: 18
        },
        end: {
          line: 80,
          column: 32
        }
      },
      '22': {
        start: {
          line: 83,
          column: 34
        },
        end: {
          line: 83,
          column: 56
        }
      },
      '23': {
        start: {
          line: 84,
          column: 26
        },
        end: {
          line: 86,
          column: 7
        }
      },
      '24': {
        start: {
          line: 85,
          column: 39
        },
        end: {
          line: 85,
          column: 70
        }
      },
      '25': {
        start: {
          line: 87,
          column: 6
        },
        end: {
          line: 87,
          column: 34
        }
      }
    },
    fnMap: {
      '0': {
        name: 'createStore',
        decl: {
          start: {
            line: 32,
            column: 24
          },
          end: {
            line: 32,
            column: 35
          }
        },
        loc: {
          start: {
            line: 35,
            column: 9
          },
          end: {
            line: 66,
            column: 1
          }
        },
        line: 35
      },
      '1': {
        name: '(anonymous_1)',
        decl: {
          start: {
            line: 37,
            column: 9
          },
          end: {
            line: 37,
            column: 10
          }
        },
        loc: {
          start: {
            line: 37,
            column: 14
          },
          end: {
            line: 37,
            column: 22
          }
        },
        line: 37
      },
      '2': {
        name: '(anonymous_2)',
        decl: {
          start: {
            line: 38,
            column: 12
          },
          end: {
            line: 38,
            column: 13
          }
        },
        loc: {
          start: {
            line: 38,
            column: 20
          },
          end: {
            line: 38,
            column: 46
          }
        },
        line: 38
      },
      '3': {
        name: '(anonymous_3)',
        decl: {
          start: {
            line: 39,
            column: 19
          },
          end: {
            line: 39,
            column: 20
          }
        },
        loc: {
          start: {
            line: 40,
            column: 4
          },
          end: {
            line: 45,
            column: 8
          }
        },
        line: 40
      },
      '4': {
        name: '(anonymous_4)',
        decl: {
          start: {
            line: 42,
            column: 13
          },
          end: {
            line: 42,
            column: 14
          }
        },
        loc: {
          start: {
            line: 42,
            column: 30
          },
          end: {
            line: 45,
            column: 7
          }
        },
        line: 42
      },
      '5': {
        name: '(anonymous_5)',
        decl: {
          start: {
            line: 54,
            column: 9
          },
          end: {
            line: 54,
            column: 10
          }
        },
        loc: {
          start: {
            line: 54,
            column: 23
          },
          end: {
            line: 54,
            column: 76
          }
        },
        line: 54
      },
      '6': {
        name: '(anonymous_6)',
        decl: {
          start: {
            line: 54,
            column: 45
          },
          end: {
            line: 54,
            column: 46
          }
        },
        loc: {
          start: {
            line: 54,
            column: 56
          },
          end: {
            line: 54,
            column: 75
          }
        },
        line: 54
      },
      '7': {
        name: '(anonymous_7)',
        decl: {
          start: {
            line: 55,
            column: 12
          },
          end: {
            line: 55,
            column: 13
          }
        },
        loc: {
          start: {
            line: 55,
            column: 26
          },
          end: {
            line: 55,
            column: 45
          }
        },
        line: 55
      },
      '8': {
        name: '(anonymous_8)',
        decl: {
          start: {
            line: 56,
            column: 40
          },
          end: {
            line: 56,
            column: 41
          }
        },
        loc: {
          start: {
            line: 56,
            column: 62
          },
          end: {
            line: 63,
            column: 3
          }
        },
        line: 56
      },
      '9': {
        name: 'getFileMessages',
        decl: {
          start: {
            line: 76,
            column: 9
          },
          end: {
            line: 76,
            column: 24
          }
        },
        loc: {
          start: {
            line: 76,
            column: 79
          },
          end: {
            line: 89,
            column: 1
          }
        },
        line: 76
      },
      '10': {
        name: '(anonymous_10)',
        decl: {
          start: {
            line: 80,
            column: 9
          },
          end: {
            line: 80,
            column: 10
          }
        },
        loc: {
          start: {
            line: 80,
            column: 18
          },
          end: {
            line: 80,
            column: 32
          }
        },
        line: 80
      },
      '11': {
        name: '(anonymous_11)',
        decl: {
          start: {
            line: 82,
            column: 9
          },
          end: {
            line: 82,
            column: 10
          }
        },
        loc: {
          start: {
            line: 82,
            column: 21
          },
          end: {
            line: 88,
            column: 5
          }
        },
        line: 82
      },
      '12': {
        name: '(anonymous_12)',
        decl: {
          start: {
            line: 85,
            column: 32
          },
          end: {
            line: 85,
            column: 33
          }
        },
        loc: {
          start: {
            line: 85,
            column: 39
          },
          end: {
            line: 85,
            column: 70
          }
        },
        line: 85
      }
    },
    branchMap: {
      '0': {
        loc: {
          start: {
            line: 34,
            column: 2
          },
          end: {
            line: 34,
            column: 40
          }
        },
        type: 'default-arg',
        locations: [{
          start: {
            line: 34,
            column: 27
          },
          end: {
            line: 34,
            column: 40
          }
        }],
        line: 34
      },
      '1': {
        loc: {
          start: {
            line: 57,
            column: 4
          },
          end: {
            line: 59,
            column: 5
          }
        },
        type: 'if',
        locations: [{
          start: {
            line: 57,
            column: 4
          },
          end: {
            line: 59,
            column: 5
          }
        }, {
          start: {
            line: 57,
            column: 4
          },
          end: {
            line: 59,
            column: 5
          }
        }],
        line: 57
      },
      '2': {
        loc: {
          start: {
            line: 60,
            column: 4
          },
          end: {
            line: 62,
            column: 5
          }
        },
        type: 'if',
        locations: [{
          start: {
            line: 60,
            column: 4
          },
          end: {
            line: 62,
            column: 5
          }
        }, {
          start: {
            line: 60,
            column: 4
          },
          end: {
            line: 62,
            column: 5
          }
        }],
        line: 60
      }
    },
    s: {
      '0': 0,
      '1': 0,
      '2': 0,
      '3': 0,
      '4': 0,
      '5': 0,
      '6': 0,
      '7': 0,
      '8': 0,
      '9': 0,
      '10': 0,
      '11': 0,
      '12': 0,
      '13': 0,
      '14': 0,
      '15': 0,
      '16': 0,
      '17': 0,
      '18': 0,
      '19': 0,
      '20': 0,
      '21': 0,
      '22': 0,
      '23': 0,
      '24': 0,
      '25': 0
    },
    f: {
      '0': 0,
      '1': 0,
      '2': 0,
      '3': 0,
      '4': 0,
      '5': 0,
      '6': 0,
      '7': 0,
      '8': 0,
      '9': 0,
      '10': 0,
      '11': 0,
      '12': 0
    },
    b: {
      '0': [0],
      '1': [0, 0],
      '2': [0, 0]
    },
    _coverageSchema: '332fd63041d2c1bcb487cc26dd0d5f7d97098a6c'
  },
      coverage = global[gcv] || (global[gcv] = {});

  if (coverage[path] && coverage[path].hash === hash) {
    return coverage[path];
  }

  coverageData.hash = hash;
  return coverage[path] = coverageData;
}();

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = createStore;

var _reduxObservable;

function _load_reduxObservable() {
  return _reduxObservable = require('nuclide-commons/redux-observable');
}

var _collection;

function _load_collection() {
  return _collection = require('nuclide-commons/collection');
}

var _observable;

function _load_observable() {
  return _observable = require('nuclide-commons/observable');
}

var _Reducers;

function _load_Reducers() {
  return _Reducers = _interopRequireWildcard(require('./Reducers'));
}

var _Epics;

function _load_Epics() {
  return _Epics = _interopRequireWildcard(require('./Epics'));
}

var _log4js;

function _load_log4js() {
  return _log4js = require('log4js');
}

var _redux;

function _load_redux() {
  return _redux = require('redux');
}

var _rxjsBundlesRxMinJs = require('rxjs/bundles/Rx.min.js');

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }

/**
 * Copyright (c) 2017-present, Facebook, Inc.
 * All rights reserved.
 *
 * This source code is licensed under the BSD-style license found in the
 * LICENSE file in the root directory of this source tree. An additional grant
 * of patent rights can be found in the PATENTS file in the same directory.
 *
 * 
 * @format
 */

function createStore(messageRangeTracker, initialState = (cov_2f90625lek.b[0][0]++, INITIAL_STATE)) {
  cov_2f90625lek.f[0]++;

  const epics = (cov_2f90625lek.s[0]++, Object.keys(_Epics || _load_Epics()).map(k => {
    cov_2f90625lek.f[1]++;
    cov_2f90625lek.s[1]++;
    return (_Epics || _load_Epics())[k];
  }).filter(epic => {
    cov_2f90625lek.f[2]++;
    cov_2f90625lek.s[2]++;
    return typeof epic === 'function';
  }));
  cov_2f90625lek.s[3]++;
  const rootEpic = (actions, store) => {
    cov_2f90625lek.f[3]++;
    cov_2f90625lek.s[4]++;
    return (0, (_reduxObservable || _load_reduxObservable()).combineEpics)(...epics)(actions, store, { messageRangeTracker })
    // Log errors and continue.
    .catch((err, stream) => {
      cov_2f90625lek.f[4]++;
      cov_2f90625lek.s[5]++;

      (0, (_log4js || _load_log4js()).getLogger)('atom-ide-diagnostics').error(err);
      cov_2f90625lek.s[6]++;
      return stream;
    });
  };
  const store = (cov_2f90625lek.s[7]++, (0, (_redux || _load_redux()).createStore)((0, (_redux || _load_redux()).combineReducers)(_Reducers || _load_Reducers()), initialState, (0, (_redux || _load_redux()).applyMiddleware)((0, (_reduxObservable || _load_reduxObservable()).createEpicMiddleware)(rootEpic))));

  // When we get new messages with fixes, track them.
  const messagesWithFixes = (cov_2f90625lek.s[8]++, getFileMessages(store).map(messageSet => {
    cov_2f90625lek.f[5]++;
    cov_2f90625lek.s[9]++;
    return (0, (_collection || _load_collection()).setFilter)(messageSet, message => {
      cov_2f90625lek.f[6]++;
      cov_2f90625lek.s[10]++;
      return message.fix != null;
    });
  }).filter(messageSet => {
    cov_2f90625lek.f[7]++;
    cov_2f90625lek.s[11]++;
    return messageSet.size > 0;
  }));
  cov_2f90625lek.s[12]++;
  (0, (_observable || _load_observable()).diffSets)(messagesWithFixes).subscribe(({ added, removed }) => {
    cov_2f90625lek.f[8]++;
    cov_2f90625lek.s[13]++;

    if (added.size > 0) {
      cov_2f90625lek.b[1][0]++;
      cov_2f90625lek.s[14]++;

      messageRangeTracker.addFileMessages(added);
    } else {
      cov_2f90625lek.b[1][1]++;
    }
    cov_2f90625lek.s[15]++;
    if (removed.size > 0) {
      cov_2f90625lek.b[2][0]++;
      cov_2f90625lek.s[16]++;

      messageRangeTracker.removeFileMessages(removed);
    } else {
      cov_2f90625lek.b[2][1]++;
    }
  });

  cov_2f90625lek.s[17]++;
  return store;
}

const INITIAL_STATE = (cov_2f90625lek.s[18]++, {
  messages: new Map(),
  projectMessages: new Map(),
  codeActionFetcher: null,
  codeActionsForMessage: new Map(),
  providers: new Set()
});

function getFileMessages(store) {
  cov_2f90625lek.f[9]++;

  // $FlowFixMe: Flow doesn't understand Symbol.observable.
  const states = (cov_2f90625lek.s[19]++, _rxjsBundlesRxMinJs.Observable.from(store));
  cov_2f90625lek.s[20]++;
  return states.map(state => {
    cov_2f90625lek.f[10]++;
    cov_2f90625lek.s[21]++;
    return state.messages;
  }).distinctUntilChanged().map(messages => {
    cov_2f90625lek.f[11]++;

    const pathsToFileMessages = (cov_2f90625lek.s[22]++, [...messages.values()]);
    const allMessages = (cov_2f90625lek.s[23]++, (0, (_collection || _load_collection()).arrayFlatten)(pathsToFileMessages.map(map => {
      cov_2f90625lek.f[12]++;
      cov_2f90625lek.s[24]++;
      return (0, (_collection || _load_collection()).arrayFlatten)([...map.values()]);
    })));
    cov_2f90625lek.s[25]++;
    return new Set(allMessages);
  });
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNyZWF0ZVN0b3JlLmpzIl0sIm5hbWVzIjpbImNyZWF0ZVN0b3JlIiwibWVzc2FnZVJhbmdlVHJhY2tlciIsImluaXRpYWxTdGF0ZSIsIklOSVRJQUxfU1RBVEUiLCJlcGljcyIsIk9iamVjdCIsImtleXMiLCJtYXAiLCJrIiwiZmlsdGVyIiwiZXBpYyIsInJvb3RFcGljIiwiYWN0aW9ucyIsInN0b3JlIiwiY2F0Y2giLCJlcnIiLCJzdHJlYW0iLCJlcnJvciIsIm1lc3NhZ2VzV2l0aEZpeGVzIiwiZ2V0RmlsZU1lc3NhZ2VzIiwibWVzc2FnZVNldCIsIm1lc3NhZ2UiLCJmaXgiLCJzaXplIiwic3Vic2NyaWJlIiwiYWRkZWQiLCJyZW1vdmVkIiwiYWRkRmlsZU1lc3NhZ2VzIiwicmVtb3ZlRmlsZU1lc3NhZ2VzIiwibWVzc2FnZXMiLCJNYXAiLCJwcm9qZWN0TWVzc2FnZXMiLCJjb2RlQWN0aW9uRmV0Y2hlciIsImNvZGVBY3Rpb25zRm9yTWVzc2FnZSIsInByb3ZpZGVycyIsIlNldCIsInN0YXRlcyIsImZyb20iLCJzdGF0ZSIsImRpc3RpbmN0VW50aWxDaGFuZ2VkIiwicGF0aHNUb0ZpbGVNZXNzYWdlcyIsInZhbHVlcyIsImFsbE1lc3NhZ2VzIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7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LHlDQUFnQjtBQUNwQjBCLFlBQVUsSUFBSUMsR0FBSixFQURVO0FBRXBCQyxtQkFBaUIsSUFBSUQsR0FBSixFQUZHO0FBR3BCRSxxQkFBbUIsSUFIQztBQUlwQkMseUJBQXVCLElBQUlILEdBQUosRUFKSDtBQUtwQkksYUFBVyxJQUFJQyxHQUFKO0FBTFMsQ0FBaEIsQ0FBTjs7QUFRQSxTQUFTaEIsZUFBVCxDQUF5Qk4sS0FBekIsRUFBK0U7QUFBQTs7QUFDN0U7QUFDQSxRQUFNdUIsa0NBQStCLCtCQUFXQyxJQUFYLENBQWdCeEIsS0FBaEIsQ0FBL0IsQ0FBTjtBQUY2RTtBQUc3RSxTQUFPdUIsT0FDSjdCLEdBREksQ0FDQStCLFNBQVM7QUFBQTtBQUFBO0FBQUEsaUJBQU1ULFFBQU47QUFBYyxHQUR2QixFQUVKVSxvQkFGSSxHQUdKaEMsR0FISSxDQUdBc0IsWUFBWTtBQUFBOztBQUNmLFVBQU1XLCtDQUFzQixDQUFDLEdBQUdYLFNBQVNZLE1BQVQsRUFBSixDQUF0QixDQUFOO0FBQ0EsVUFBTUMsdUNBQWMsc0RBQ2xCRixvQkFBb0JqQyxHQUFwQixDQUF3QkEsT0FBTztBQUFBO0FBQUE7QUFBQSxtRUFBYSxDQUFDLEdBQUdBLElBQUlrQyxNQUFKLEVBQUosQ0FBYjtBQUErQixLQUE5RCxDQURrQixDQUFkLENBQU47QUFGZTtBQUtmLFdBQU8sSUFBSU4sR0FBSixDQUFRTyxXQUFSLENBQVA7QUFDRCxHQVRJLENBQVA7QUFVRCIsImZpbGUiOiJjcmVhdGVTdG9yZS5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogQ29weXJpZ2h0IChjKSAyMDE3LXByZXNlbnQsIEZhY2Vib29rLCBJbmMuXG4gKiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuICpcbiAqIFRoaXMgc291cmNlIGNvZGUgaXMgbGljZW5zZWQgdW5kZXIgdGhlIEJTRC1zdHlsZSBsaWNlbnNlIGZvdW5kIGluIHRoZVxuICogTElDRU5TRSBmaWxlIGluIHRoZSByb290IGRpcmVjdG9yeSBvZiB0aGlzIHNvdXJjZSB0cmVlLiBBbiBhZGRpdGlvbmFsIGdyYW50XG4gKiBvZiBwYXRlbnQgcmlnaHRzIGNhbiBiZSBmb3VuZCBpbiB0aGUgUEFURU5UUyBmaWxlIGluIHRoZSBzYW1lIGRpcmVjdG9yeS5cbiAqXG4gKiBAZmxvd1xuICogQGZvcm1hdFxuICovXG5cbmltcG9ydCB0eXBlIHtBcHBTdGF0ZSwgRmlsZURpYWdub3N0aWNNZXNzYWdlLCBTdG9yZX0gZnJvbSAnLi4vdHlwZXMnO1xuaW1wb3J0IHR5cGUgTWVzc2FnZVJhbmdlVHJhY2tlciBmcm9tICcuLi9NZXNzYWdlUmFuZ2VUcmFja2VyJztcblxuaW1wb3J0IHtcbiAgY29tYmluZUVwaWNzLFxuICBjcmVhdGVFcGljTWlkZGxld2FyZSxcbn0gZnJvbSAnbnVjbGlkZS1jb21tb25zL3JlZHV4LW9ic2VydmFibGUnO1xuaW1wb3J0IHthcnJheUZsYXR0ZW4sIHNldEZpbHRlcn0gZnJvbSAnbnVjbGlkZS1jb21tb25zL2NvbGxlY3Rpb24nO1xuaW1wb3J0IHtkaWZmU2V0c30gZnJvbSAnbnVjbGlkZS1jb21tb25zL29ic2VydmFibGUnO1xuaW1wb3J0ICogYXMgUmVkdWNlcnMgZnJvbSAnLi9SZWR1Y2Vycyc7XG5pbXBvcnQgKiBhcyBFcGljcyBmcm9tICcuL0VwaWNzJztcbmltcG9ydCB7Z2V0TG9nZ2VyfSBmcm9tICdsb2c0anMnO1xuaW1wb3J0IHtcbiAgYXBwbHlNaWRkbGV3YXJlLFxuICBjb21iaW5lUmVkdWNlcnMsXG4gIGNyZWF0ZVN0b3JlIGFzIF9jcmVhdGVTdG9yZSxcbn0gZnJvbSAncmVkdXgnO1xuaW1wb3J0IHtPYnNlcnZhYmxlfSBmcm9tICdyeGpzJztcblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gY3JlYXRlU3RvcmUoXG4gIG1lc3NhZ2VSYW5nZVRyYWNrZXI6IE1lc3NhZ2VSYW5nZVRyYWNrZXIsXG4gIGluaXRpYWxTdGF0ZTogQXBwU3RhdGUgPSBJTklUSUFMX1NUQVRFLFxuKTogU3RvcmUge1xuICBjb25zdCBlcGljcyA9IE9iamVjdC5rZXlzKEVwaWNzKVxuICAgIC5tYXAoayA9PiBFcGljc1trXSlcbiAgICAuZmlsdGVyKGVwaWMgPT4gdHlwZW9mIGVwaWMgPT09ICdmdW5jdGlvbicpO1xuICBjb25zdCByb290RXBpYyA9IChhY3Rpb25zLCBzdG9yZSkgPT5cbiAgICBjb21iaW5lRXBpY3MoLi4uZXBpY3MpKGFjdGlvbnMsIHN0b3JlLCB7bWVzc2FnZVJhbmdlVHJhY2tlcn0pXG4gICAgICAvLyBMb2cgZXJyb3JzIGFuZCBjb250aW51ZS5cbiAgICAgIC5jYXRjaCgoZXJyLCBzdHJlYW0pID0+IHtcbiAgICAgICAgZ2V0TG9nZ2VyKCdhdG9tLWlkZS1kaWFnbm9zdGljcycpLmVycm9yKGVycik7XG4gICAgICAgIHJldHVybiBzdHJlYW07XG4gICAgICB9KTtcbiAgY29uc3Qgc3RvcmUgPSBfY3JlYXRlU3RvcmUoXG4gICAgY29tYmluZVJlZHVjZXJzKFJlZHVjZXJzKSxcbiAgICBpbml0aWFsU3RhdGUsXG4gICAgYXBwbHlNaWRkbGV3YXJlKGNyZWF0ZUVwaWNNaWRkbGV3YXJlKHJvb3RFcGljKSksXG4gICk7XG5cbiAgLy8gV2hlbiB3ZSBnZXQgbmV3IG1lc3NhZ2VzIHdpdGggZml4ZXMsIHRyYWNrIHRoZW0uXG4gIGNvbnN0IG1lc3NhZ2VzV2l0aEZpeGVzID0gZ2V0RmlsZU1lc3NhZ2VzKHN0b3JlKVxuICAgIC5tYXAobWVzc2FnZVNldCA9PiBzZXRGaWx0ZXIobWVzc2FnZVNldCwgbWVzc2FnZSA9PiBtZXNzYWdlLmZpeCAhPSBudWxsKSlcbiAgICAuZmlsdGVyKG1lc3NhZ2VTZXQgPT4gbWVzc2FnZVNldC5zaXplID4gMCk7XG4gIGRpZmZTZXRzKG1lc3NhZ2VzV2l0aEZpeGVzKS5zdWJzY3JpYmUoKHthZGRlZCwgcmVtb3ZlZH0pID0+IHtcbiAgICBpZiAoYWRkZWQuc2l6ZSA+IDApIHtcbiAgICAgIG1lc3NhZ2VSYW5nZVRyYWNrZXIuYWRkRmlsZU1lc3NhZ2VzKGFkZGVkKTtcbiAgICB9XG4gICAgaWYgKHJlbW92ZWQuc2l6ZSA+IDApIHtcbiAgICAgIG1lc3NhZ2VSYW5nZVRyYWNrZXIucmVtb3ZlRmlsZU1lc3NhZ2VzKHJlbW92ZWQpO1xuICAgIH1cbiAgfSk7XG5cbiAgcmV0dXJuIHN0b3JlO1xufVxuXG5jb25zdCBJTklUSUFMX1NUQVRFID0ge1xuICBtZXNzYWdlczogbmV3IE1hcCgpLFxuICBwcm9qZWN0TWVzc2FnZXM6IG5ldyBNYXAoKSxcbiAgY29kZUFjdGlvbkZldGNoZXI6IG51bGwsXG4gIGNvZGVBY3Rpb25zRm9yTWVzc2FnZTogbmV3IE1hcCgpLFxuICBwcm92aWRlcnM6IG5ldyBTZXQoKSxcbn07XG5cbmZ1bmN0aW9uIGdldEZpbGVNZXNzYWdlcyhzdG9yZTogU3RvcmUpOiBPYnNlcnZhYmxlPFNldDxGaWxlRGlhZ25vc3RpY01lc3NhZ2U+PiB7XG4gIC8vICRGbG93Rml4TWU6IEZsb3cgZG9lc24ndCB1bmRlcnN0YW5kIFN5bWJvbC5vYnNlcnZhYmxlLlxuICBjb25zdCBzdGF0ZXM6IE9ic2VydmFibGU8QXBwU3RhdGU+ID0gT2JzZXJ2YWJsZS5mcm9tKHN0b3JlKTtcbiAgcmV0dXJuIHN0YXRlc1xuICAgIC5tYXAoc3RhdGUgPT4gc3RhdGUubWVzc2FnZXMpXG4gICAgLmRpc3RpbmN0VW50aWxDaGFuZ2VkKClcbiAgICAubWFwKG1lc3NhZ2VzID0+IHtcbiAgICAgIGNvbnN0IHBhdGhzVG9GaWxlTWVzc2FnZXMgPSBbLi4ubWVzc2FnZXMudmFsdWVzKCldO1xuICAgICAgY29uc3QgYWxsTWVzc2FnZXMgPSBhcnJheUZsYXR0ZW4oXG4gICAgICAgIHBhdGhzVG9GaWxlTWVzc2FnZXMubWFwKG1hcCA9PiBhcnJheUZsYXR0ZW4oWy4uLm1hcC52YWx1ZXMoKV0pKSxcbiAgICAgICk7XG4gICAgICByZXR1cm4gbmV3IFNldChhbGxNZXNzYWdlcyk7XG4gICAgfSk7XG59XG4iXX0=