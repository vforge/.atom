'use strict';

var cov_n1m7r3rr6 = function () {
  var path = '/Users/hansonw/atom-ide-ui/modules/atom-ide-ui/pkg/atom-ide-outline-view/lib/OutlineViewSearch.js',
      hash = '28943b128c49a9deac7ab943cd1c7c6d63dc72f8',
      global = new Function('return this')(),
      gcv = '__coverage__',
      coverageData = {
    path: '/Users/hansonw/atom-ide-ui/modules/atom-ide-ui/pkg/atom-ide-outline-view/lib/OutlineViewSearch.js',
    statementMap: {
      '0': {
        start: {
          line: 23,
          column: 24
        },
        end: {
          line: 23,
          column: 27
        }
      },
      '1': {
        start: {
          line: 47,
          column: 4
        },
        end: {
          line: 47,
          column: 17
        }
      },
      '2': {
        start: {
          line: 51,
          column: 4
        },
        end: {
          line: 51,
          column: 35
        }
      },
      '3': {
        start: {
          line: 52,
          column: 4
        },
        end: {
          line: 54,
          column: 6
        }
      },
      '4': {
        start: {
          line: 61,
          column: 4
        },
        end: {
          line: 63,
          column: 5
        }
      },
      '5': {
        start: {
          line: 62,
          column: 6
        },
        end: {
          line: 62,
          column: 13
        }
      },
      '6': {
        start: {
          line: 64,
          column: 4
        },
        end: {
          line: 67,
          column: 5
        }
      },
      '7': {
        start: {
          line: 65,
          column: 6
        },
        end: {
          line: 65,
          column: 48
        }
      },
      '8': {
        start: {
          line: 66,
          column: 6
        },
        end: {
          line: 66,
          column: 13
        }
      },
      '9': {
        start: {
          line: 68,
          column: 4
        },
        end: {
          line: 71,
          column: 5
        }
      },
      '10': {
        start: {
          line: 69,
          column: 6
        },
        end: {
          line: 69,
          column: 40
        }
      },
      '11': {
        start: {
          line: 70,
          column: 6
        },
        end: {
          line: 70,
          column: 13
        }
      },
      '12': {
        start: {
          line: 72,
          column: 4
        },
        end: {
          line: 88,
          column: 5
        }
      },
      '13': {
        start: {
          line: 76,
          column: 21
        },
        end: {
          line: 76,
          column: 30
        }
      },
      '14': {
        start: {
          line: 77,
          column: 6
        },
        end: {
          line: 85,
          column: 8
        }
      },
      '15': {
        start: {
          line: 78,
          column: 8
        },
        end: {
          line: 84,
          column: 9
        }
      },
      '16': {
        start: {
          line: 86,
          column: 6
        },
        end: {
          line: 86,
          column: 34
        }
      },
      '17': {
        start: {
          line: 87,
          column: 6
        },
        end: {
          line: 87,
          column: 57
        }
      },
      '18': {
        start: {
          line: 95,
          column: 4
        },
        end: {
          line: 104,
          column: 5
        }
      },
      '19': {
        start: {
          line: 96,
          column: 21
        },
        end: {
          line: 96,
          column: 47
        }
      },
      '20': {
        start: {
          line: 97,
          column: 6
        },
        end: {
          line: 99,
          column: 7
        }
      },
      '21': {
        start: {
          line: 98,
          column: 8
        },
        end: {
          line: 98,
          column: 23
        }
      },
      '22': {
        start: {
          line: 100,
          column: 20
        },
        end: {
          line: 100,
          column: 74
        }
      },
      '23': {
        start: {
          line: 101,
          column: 6
        },
        end: {
          line: 103,
          column: 7
        }
      },
      '24': {
        start: {
          line: 102,
          column: 8
        },
        end: {
          line: 102,
          column: 21
        }
      },
      '25': {
        start: {
          line: 108,
          column: 25
        },
        end: {
          line: 111,
          column: 5
        }
      },
      '26': {
        start: {
          line: 112,
          column: 4
        },
        end: {
          line: 114,
          column: 5
        }
      },
      '27': {
        start: {
          line: 113,
          column: 6
        },
        end: {
          line: 113,
          column: 13
        }
      },
      '28': {
        start: {
          line: 115,
          column: 17
        },
        end: {
          line: 115,
          column: 62
        }
      },
      '29': {
        start: {
          line: 116,
          column: 4
        },
        end: {
          line: 118,
          column: 5
        }
      },
      '30': {
        start: {
          line: 117,
          column: 6
        },
        end: {
          line: 117,
          column: 13
        }
      },
      '31': {
        start: {
          line: 119,
          column: 4
        },
        end: {
          line: 119,
          column: 49
        }
      },
      '32': {
        start: {
          line: 120,
          column: 4
        },
        end: {
          line: 120,
          column: 20
        }
      },
      '33': {
        start: {
          line: 121,
          column: 4
        },
        end: {
          line: 121,
          column: 41
        }
      },
      '34': {
        start: {
          line: 122,
          column: 4
        },
        end: {
          line: 125,
          column: 7
        }
      },
      '35': {
        start: {
          line: 126,
          column: 4
        },
        end: {
          line: 126,
          column: 38
        }
      },
      '36': {
        start: {
          line: 130,
          column: 4
        },
        end: {
          line: 130,
          column: 41
        }
      },
      '37': {
        start: {
          line: 134,
          column: 4
        },
        end: {
          line: 134,
          column: 38
        }
      },
      '38': {
        start: {
          line: 138,
          column: 4
        },
        end: {
          line: 158,
          column: 6
        }
      },
      '39': {
        start: {
          line: 170,
          column: 2
        },
        end: {
          line: 172,
          column: 4
        }
      },
      '40': {
        start: {
          line: 171,
          column: 4
        },
        end: {
          line: 171,
          column: 58
        }
      },
      '41': {
        start: {
          line: 175,
          column: 2
        },
        end: {
          line: 185,
          column: 3
        }
      },
      '42': {
        start: {
          line: 176,
          column: 27
        },
        end: {
          line: 176,
          column: 44
        }
      },
      '43': {
        start: {
          line: 177,
          column: 4
        },
        end: {
          line: 184,
          column: 5
        }
      },
      '44': {
        start: {
          line: 182,
          column: 6
        },
        end: {
          line: 182,
          column: 36
        }
      },
      '45': {
        start: {
          line: 183,
          column: 6
        },
        end: {
          line: 183,
          column: 13
        }
      },
      '46': {
        start: {
          line: 186,
          column: 15
        },
        end: {
          line: 188,
          column: 26
        }
      },
      '47': {
        start: {
          line: 187,
          column: 34
        },
        end: {
          line: 187,
          column: 41
        }
      },
      '48': {
        start: {
          line: 190,
          column: 4
        },
        end: {
          line: 192,
          column: 21
        }
      },
      '49': {
        start: {
          line: 194,
          column: 4
        },
        end: {
          line: 200,
          column: 5
        }
      },
      '50': {
        start: {
          line: 197,
          column: 28
        },
        end: {
          line: 197,
          column: 42
        }
      },
      '51': {
        start: {
          line: 198,
          column: 8
        },
        end: {
          line: 198,
          column: 51
        }
      },
      '52': {
        start: {
          line: 202,
          column: 2
        },
        end: {
          line: 204,
          column: 3
        }
      },
      '53': {
        start: {
          line: 203,
          column: 4
        },
        end: {
          line: 203,
          column: 59
        }
      },
      '54': {
        start: {
          line: 205,
          column: 2
        },
        end: {
          line: 205,
          column: 56
        }
      }
    },
    fnMap: {
      '0': {
        name: '(anonymous_0)',
        decl: {
          start: {
            line: 46,
            column: 2
          },
          end: {
            line: 46,
            column: 3
          }
        },
        loc: {
          start: {
            line: 46,
            column: 28
          },
          end: {
            line: 55,
            column: 3
          }
        },
        line: 46
      },
      '1': {
        name: '(anonymous_1)',
        decl: {
          start: {
            line: 60,
            column: 2
          },
          end: {
            line: 60,
            column: 3
          }
        },
        loc: {
          start: {
            line: 60,
            column: 57
          },
          end: {
            line: 89,
            column: 3
          }
        },
        line: 60
      },
      '2': {
        name: '(anonymous_2)',
        decl: {
          start: {
            line: 77,
            column: 38
          },
          end: {
            line: 77,
            column: 39
          }
        },
        loc: {
          start: {
            line: 78,
            column: 8
          },
          end: {
            line: 84,
            column: 9
          }
        },
        line: 78
      },
      '3': {
        name: '(anonymous_3)',
        decl: {
          start: {
            line: 91,
            column: 2
          },
          end: {
            line: 91,
            column: 3
          }
        },
        loc: {
          start: {
            line: 94,
            column: 23
          },
          end: {
            line: 105,
            column: 3
          }
        },
        line: 94
      },
      '4': {
        name: '(anonymous_4)',
        decl: {
          start: {
            line: 107,
            column: 15
          },
          end: {
            line: 107,
            column: 16
          }
        },
        loc: {
          start: {
            line: 107,
            column: 21
          },
          end: {
            line: 127,
            column: 3
          }
        },
        line: 107
      },
      '5': {
        name: '(anonymous_5)',
        decl: {
          start: {
            line: 129,
            column: 26
          },
          end: {
            line: 129,
            column: 27
          }
        },
        loc: {
          start: {
            line: 129,
            column: 35
          },
          end: {
            line: 131,
            column: 3
          }
        },
        line: 129
      },
      '6': {
        name: '(anonymous_6)',
        decl: {
          start: {
            line: 133,
            column: 16
          },
          end: {
            line: 133,
            column: 17
          }
        },
        loc: {
          start: {
            line: 133,
            column: 22
          },
          end: {
            line: 135,
            column: 3
          }
        },
        line: 133
      },
      '7': {
        name: '(anonymous_7)',
        decl: {
          start: {
            line: 137,
            column: 2
          },
          end: {
            line: 137,
            column: 3
          }
        },
        loc: {
          start: {
            line: 137,
            column: 23
          },
          end: {
            line: 159,
            column: 3
          }
        },
        line: 137
      },
      '8': {
        name: 'updateSearchSet',
        decl: {
          start: {
            line: 163,
            column: 16
          },
          end: {
            line: 163,
            column: 31
          }
        },
        loc: {
          start: {
            line: 169,
            column: 8
          },
          end: {
            line: 206,
            column: 1
          }
        },
        line: 169
      },
      '9': {
        name: '(anonymous_9)',
        decl: {
          start: {
            line: 170,
            column: 24
          },
          end: {
            line: 170,
            column: 25
          }
        },
        loc: {
          start: {
            line: 171,
            column: 4
          },
          end: {
            line: 171,
            column: 58
          }
        },
        line: 171
      },
      '10': {
        name: '(anonymous_10)',
        decl: {
          start: {
            line: 187,
            column: 29
          },
          end: {
            line: 187,
            column: 30
          }
        },
        loc: {
          start: {
            line: 187,
            column: 34
          },
          end: {
            line: 187,
            column: 41
          }
        },
        line: 187
      },
      '11': {
        name: '(anonymous_11)',
        decl: {
          start: {
            line: 196,
            column: 25
          },
          end: {
            line: 196,
            column: 26
          }
        },
        loc: {
          start: {
            line: 196,
            column: 34
          },
          end: {
            line: 199,
            column: 7
          }
        },
        line: 196
      }
    },
    branchMap: {
      '0': {
        loc: {
          start: {
            line: 61,
            column: 4
          },
          end: {
            line: 63,
            column: 5
          }
        },
        type: 'if',
        locations: [{
          start: {
            line: 61,
            column: 4
          },
          end: {
            line: 63,
            column: 5
          }
        }, {
          start: {
            line: 61,
            column: 4
          },
          end: {
            line: 63,
            column: 5
          }
        }],
        line: 61
      },
      '1': {
        loc: {
          start: {
            line: 61,
            column: 8
          },
          end: {
            line: 61,
            column: 71
          }
        },
        type: 'binary-expr',
        locations: [{
          start: {
            line: 61,
            column: 8
          },
          end: {
            line: 61,
            column: 37
          }
        }, {
          start: {
            line: 61,
            column: 41
          },
          end: {
            line: 61,
            column: 71
          }
        }],
        line: 61
      },
      '2': {
        loc: {
          start: {
            line: 64,
            column: 4
          },
          end: {
            line: 67,
            column: 5
          }
        },
        type: 'if',
        locations: [{
          start: {
            line: 64,
            column: 4
          },
          end: {
            line: 67,
            column: 5
          }
        }, {
          start: {
            line: 64,
            column: 4
          },
          end: {
            line: 67,
            column: 5
          }
        }],
        line: 64
      },
      '3': {
        loc: {
          start: {
            line: 68,
            column: 4
          },
          end: {
            line: 71,
            column: 5
          }
        },
        type: 'if',
        locations: [{
          start: {
            line: 68,
            column: 4
          },
          end: {
            line: 71,
            column: 5
          }
        }, {
          start: {
            line: 68,
            column: 4
          },
          end: {
            line: 71,
            column: 5
          }
        }],
        line: 68
      },
      '4': {
        loc: {
          start: {
            line: 72,
            column: 4
          },
          end: {
            line: 88,
            column: 5
          }
        },
        type: 'if',
        locations: [{
          start: {
            line: 72,
            column: 4
          },
          end: {
            line: 88,
            column: 5
          }
        }, {
          start: {
            line: 72,
            column: 4
          },
          end: {
            line: 88,
            column: 5
          }
        }],
        line: 72
      },
      '5': {
        loc: {
          start: {
            line: 73,
            column: 6
          },
          end: {
            line: 74,
            column: 56
          }
        },
        type: 'binary-expr',
        locations: [{
          start: {
            line: 73,
            column: 6
          },
          end: {
            line: 73,
            column: 56
          }
        }, {
          start: {
            line: 74,
            column: 6
          },
          end: {
            line: 74,
            column: 56
          }
        }],
        line: 73
      },
      '6': {
        loc: {
          start: {
            line: 97,
            column: 6
          },
          end: {
            line: 99,
            column: 7
          }
        },
        type: 'if',
        locations: [{
          start: {
            line: 97,
            column: 6
          },
          end: {
            line: 99,
            column: 7
          }
        }, {
          start: {
            line: 97,
            column: 6
          },
          end: {
            line: 99,
            column: 7
          }
        }],
        line: 97
      },
      '7': {
        loc: {
          start: {
            line: 97,
            column: 10
          },
          end: {
            line: 97,
            column: 34
          }
        },
        type: 'binary-expr',
        locations: [{
          start: {
            line: 97,
            column: 10
          },
          end: {
            line: 97,
            column: 16
          }
        }, {
          start: {
            line: 97,
            column: 20
          },
          end: {
            line: 97,
            column: 34
          }
        }],
        line: 97
      },
      '8': {
        loc: {
          start: {
            line: 101,
            column: 6
          },
          end: {
            line: 103,
            column: 7
          }
        },
        type: 'if',
        locations: [{
          start: {
            line: 101,
            column: 6
          },
          end: {
            line: 103,
            column: 7
          }
        }, {
          start: {
            line: 101,
            column: 6
          },
          end: {
            line: 103,
            column: 7
          }
        }],
        line: 101
      },
      '9': {
        loc: {
          start: {
            line: 112,
            column: 4
          },
          end: {
            line: 114,
            column: 5
          }
        },
        type: 'if',
        locations: [{
          start: {
            line: 112,
            column: 4
          },
          end: {
            line: 114,
            column: 5
          }
        }, {
          start: {
            line: 112,
            column: 4
          },
          end: {
            line: 114,
            column: 5
          }
        }],
        line: 112
      },
      '10': {
        loc: {
          start: {
            line: 116,
            column: 4
          },
          end: {
            line: 118,
            column: 5
          }
        },
        type: 'if',
        locations: [{
          start: {
            line: 116,
            column: 4
          },
          end: {
            line: 118,
            column: 5
          }
        }, {
          start: {
            line: 116,
            column: 4
          },
          end: {
            line: 118,
            column: 5
          }
        }],
        line: 116
      },
      '11': {
        loc: {
          start: {
            line: 146,
            column: 27
          },
          end: {
            line: 146,
            column: 77
          }
        },
        type: 'binary-expr',
        locations: [{
          start: {
            line: 146,
            column: 27
          },
          end: {
            line: 146,
            column: 50
          }
        }, {
          start: {
            line: 146,
            column: 54
          },
          end: {
            line: 146,
            column: 77
          }
        }],
        line: 146
      },
      '12': {
        loc: {
          start: {
            line: 150,
            column: 9
          },
          end: {
            line: 156,
            column: 16
          }
        },
        type: 'cond-expr',
        locations: [{
          start: {
            line: 151,
            column: 10
          },
          end: {
            line: 155,
            column: 12
          }
        }, {
          start: {
            line: 156,
            column: 12
          },
          end: {
            line: 156,
            column: 16
          }
        }],
        line: 150
      },
      '13': {
        loc: {
          start: {
            line: 175,
            column: 2
          },
          end: {
            line: 185,
            column: 3
          }
        },
        type: 'if',
        locations: [{
          start: {
            line: 175,
            column: 2
          },
          end: {
            line: 185,
            column: 3
          }
        }, {
          start: {
            line: 175,
            column: 2
          },
          end: {
            line: 185,
            column: 3
          }
        }],
        line: 175
      },
      '14': {
        loc: {
          start: {
            line: 177,
            column: 4
          },
          end: {
            line: 184,
            column: 5
          }
        },
        type: 'if',
        locations: [{
          start: {
            line: 177,
            column: 4
          },
          end: {
            line: 184,
            column: 5
          }
        }, {
          start: {
            line: 177,
            column: 4
          },
          end: {
            line: 184,
            column: 5
          }
        }],
        line: 177
      },
      '15': {
        loc: {
          start: {
            line: 178,
            column: 6
          },
          end: {
            line: 180,
            column: 65
          }
        },
        type: 'binary-expr',
        locations: [{
          start: {
            line: 178,
            column: 6
          },
          end: {
            line: 178,
            column: 20
          }
        }, {
          start: {
            line: 179,
            column: 7
          },
          end: {
            line: 179,
            column: 26
          }
        }, {
          start: {
            line: 180,
            column: 9
          },
          end: {
            line: 180,
            column: 36
          }
        }, {
          start: {
            line: 180,
            column: 40
          },
          end: {
            line: 180,
            column: 63
          }
        }],
        line: 178
      },
      '16': {
        loc: {
          start: {
            line: 186,
            column: 15
          },
          end: {
            line: 188,
            column: 26
          }
        },
        type: 'cond-expr',
        locations: [{
          start: {
            line: 187,
            column: 6
          },
          end: {
            line: 187,
            column: 51
          }
        }, {
          start: {
            line: 188,
            column: 6
          },
          end: {
            line: 188,
            column: 26
          }
        }],
        line: 186
      },
      '17': {
        loc: {
          start: {
            line: 188,
            column: 6
          },
          end: {
            line: 188,
            column: 26
          }
        },
        type: 'binary-expr',
        locations: [{
          start: {
            line: 188,
            column: 6
          },
          end: {
            line: 188,
            column: 20
          }
        }, {
          start: {
            line: 188,
            column: 24
          },
          end: {
            line: 188,
            column: 26
          }
        }],
        line: 188
      },
      '18': {
        loc: {
          start: {
            line: 190,
            column: 4
          },
          end: {
            line: 192,
            column: 21
          }
        },
        type: 'binary-expr',
        locations: [{
          start: {
            line: 190,
            column: 4
          },
          end: {
            line: 190,
            column: 16
          }
        }, {
          start: {
            line: 191,
            column: 4
          },
          end: {
            line: 192,
            column: 21
          }
        }],
        line: 190
      },
      '19': {
        loc: {
          start: {
            line: 194,
            column: 4
          },
          end: {
            line: 200,
            column: 5
          }
        },
        type: 'binary-expr',
        locations: [{
          start: {
            line: 194,
            column: 4
          },
          end: {
            line: 194,
            column: 11
          }
        }, {
          start: {
            line: 195,
            column: 4
          },
          end: {
            line: 200,
            column: 5
          }
        }],
        line: 194
      },
      '20': {
        loc: {
          start: {
            line: 198,
            column: 15
          },
          end: {
            line: 198,
            column: 50
          }
        },
        type: 'binary-expr',
        locations: [{
          start: {
            line: 198,
            column: 15
          },
          end: {
            line: 198,
            column: 27
          }
        }, {
          start: {
            line: 198,
            column: 31
          },
          end: {
            line: 198,
            column: 50
          }
        }],
        line: 198
      },
      '21': {
        loc: {
          start: {
            line: 202,
            column: 2
          },
          end: {
            line: 204,
            column: 3
          }
        },
        type: 'if',
        locations: [{
          start: {
            line: 202,
            column: 2
          },
          end: {
            line: 204,
            column: 3
          }
        }, {
          start: {
            line: 202,
            column: 2
          },
          end: {
            line: 204,
            column: 3
          }
        }],
        line: 202
      }
    },
    s: {
      '0': 0,
      '1': 0,
      '2': 0,
      '3': 0,
      '4': 0,
      '5': 0,
      '6': 0,
      '7': 0,
      '8': 0,
      '9': 0,
      '10': 0,
      '11': 0,
      '12': 0,
      '13': 0,
      '14': 0,
      '15': 0,
      '16': 0,
      '17': 0,
      '18': 0,
      '19': 0,
      '20': 0,
      '21': 0,
      '22': 0,
      '23': 0,
      '24': 0,
      '25': 0,
      '26': 0,
      '27': 0,
      '28': 0,
      '29': 0,
      '30': 0,
      '31': 0,
      '32': 0,
      '33': 0,
      '34': 0,
      '35': 0,
      '36': 0,
      '37': 0,
      '38': 0,
      '39': 0,
      '40': 0,
      '41': 0,
      '42': 0,
      '43': 0,
      '44': 0,
      '45': 0,
      '46': 0,
      '47': 0,
      '48': 0,
      '49': 0,
      '50': 0,
      '51': 0,
      '52': 0,
      '53': 0,
      '54': 0
    },
    f: {
      '0': 0,
      '1': 0,
      '2': 0,
      '3': 0,
      '4': 0,
      '5': 0,
      '6': 0,
      '7': 0,
      '8': 0,
      '9': 0,
      '10': 0,
      '11': 0
    },
    b: {
      '0': [0, 0],
      '1': [0, 0],
      '2': [0, 0],
      '3': [0, 0],
      '4': [0, 0],
      '5': [0, 0],
      '6': [0, 0],
      '7': [0, 0],
      '8': [0, 0],
      '9': [0, 0],
      '10': [0, 0],
      '11': [0, 0],
      '12': [0, 0],
      '13': [0, 0],
      '14': [0, 0],
      '15': [0, 0, 0, 0],
      '16': [0, 0],
      '17': [0, 0],
      '18': [0, 0],
      '19': [0, 0],
      '20': [0, 0],
      '21': [0, 0]
    },
    _coverageSchema: '332fd63041d2c1bcb487cc26dd0d5f7d97098a6c'
  },
      coverage = global[gcv] || (global[gcv] = {});

  if (coverage[path] && coverage[path].hash === hash) {
    return coverage[path];
  }

  coverageData.hash = hash;
  return coverage[path] = coverageData;
}();

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.OutlineViewSearchComponent = undefined;
exports.updateSearchSet = updateSearchSet;

var _react = _interopRequireWildcard(require('react'));

var _AtomInput;

function _load_AtomInput() {
  return _AtomInput = require('nuclide-commons-ui/AtomInput');
}

var _Icon;

function _load_Icon() {
  return _Icon = require('nuclide-commons-ui/Icon');
}

var _goToLocation;

function _load_goToLocation() {
  return _goToLocation = require('nuclide-commons-atom/go-to-location');
}

var _debounce;

function _load_debounce() {
  return _debounce = _interopRequireDefault(require('nuclide-commons/debounce'));
}

var _analytics;

function _load_analytics() {
  return _analytics = _interopRequireDefault(require('nuclide-commons-atom/analytics'));
}

var _fuzzaldrinPlus;

function _load_fuzzaldrinPlus() {
  return _fuzzaldrinPlus = _interopRequireDefault(require('fuzzaldrin-plus'));
}

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }

const SCORE_THRESHOLD = (cov_n1m7r3rr6.s[0]++, 0.1); /**
                                                      * Copyright (c) 2017-present, Facebook, Inc.
                                                      * All rights reserved.
                                                      *
                                                      * This source code is licensed under the BSD-style license found in the
                                                      * LICENSE file in the root directory of this source tree. An additional grant
                                                      * of patent rights can be found in the PATENTS file in the same directory.
                                                      *
                                                      * 
                                                      * @format
                                                      */

class OutlineViewSearchComponent extends _react.Component {

  constructor(props) {
    cov_n1m7r3rr6.f[0]++;
    cov_n1m7r3rr6.s[1]++;

    super(props);
    // An element is considered visible if it is not in the Map or if it has a
    // Search result that has the visible property set to true. Therefore, all
    // elements are visible when the Map is empty.
    this.SEARCH_PLACEHOLDER = 'Search Outline';
    this.DEBOUNCE_TIME = 100;

    this._onConfirm = () => {
      cov_n1m7r3rr6.f[4]++;

      const firstElement = (cov_n1m7r3rr6.s[25]++, this._findFirstResult(this.searchResults, this.props.outlineTrees));
      cov_n1m7r3rr6.s[26]++;
      if (firstElement == null) {
        cov_n1m7r3rr6.b[9][0]++;
        cov_n1m7r3rr6.s[27]++;

        return;
      } else {
        cov_n1m7r3rr6.b[9][1]++;
      }
      const pane = (cov_n1m7r3rr6.s[28]++, atom.workspace.paneForItem(this.props.editor));
      cov_n1m7r3rr6.s[29]++;
      if (pane == null) {
        cov_n1m7r3rr6.b[10][0]++;
        cov_n1m7r3rr6.s[30]++;

        return;
      } else {
        cov_n1m7r3rr6.b[10][1]++;
      }
      cov_n1m7r3rr6.s[31]++;
      (_analytics || _load_analytics()).default.track('outline-view:search-enter');
      cov_n1m7r3rr6.s[32]++;
      pane.activate();
      cov_n1m7r3rr6.s[33]++;
      pane.activateItem(this.props.editor);
      cov_n1m7r3rr6.s[34]++;
      (0, (_goToLocation || _load_goToLocation()).goToLocationInEditor)(this.props.editor, {
        line: firstElement.startPosition.row,
        column: firstElement.startPosition.column
      });
      cov_n1m7r3rr6.s[35]++;
      this.setState({ currentQuery: '' });
    };

    this._onDidChange = (0, (_debounce || _load_debounce()).default)(query => {
      cov_n1m7r3rr6.f[5]++;
      cov_n1m7r3rr6.s[36]++;

      this.setState({ currentQuery: query });
    }, this.DEBOUNCE_TIME);

    this._onDidClear = () => {
      cov_n1m7r3rr6.f[6]++;
      cov_n1m7r3rr6.s[37]++;

      this.setState({ currentQuery: '' });
    };

    cov_n1m7r3rr6.s[2]++;
    this.searchResults = new Map();
    cov_n1m7r3rr6.s[3]++;
    this.state = {
      currentQuery: ''
    };
  }

  componentDidUpdate(prevProps, prevState) {
    cov_n1m7r3rr6.f[1]++;
    cov_n1m7r3rr6.s[4]++;

    if ((cov_n1m7r3rr6.b[1][0]++, prevState.currentQuery === '') && (cov_n1m7r3rr6.b[1][1]++, this.state.currentQuery === '')) {
      cov_n1m7r3rr6.b[0][0]++;
      cov_n1m7r3rr6.s[5]++;

      return;
    } else {
      cov_n1m7r3rr6.b[0][1]++;
    }
    cov_n1m7r3rr6.s[6]++;
    if (this.state.currentQuery === '') {
      cov_n1m7r3rr6.b[2][0]++;
      cov_n1m7r3rr6.s[7]++;

      this.props.updateSearchResults(new Map());
      cov_n1m7r3rr6.s[8]++;
      return;
    } else {
      cov_n1m7r3rr6.b[2][1]++;
    }
    cov_n1m7r3rr6.s[9]++;
    if (prevProps.editor !== this.props.editor) {
      cov_n1m7r3rr6.b[3][0]++;
      cov_n1m7r3rr6.s[10]++;

      this.setState({ currentQuery: '' });
      cov_n1m7r3rr6.s[11]++;
      return;
    } else {
      cov_n1m7r3rr6.b[3][1]++;
    }
    cov_n1m7r3rr6.s[12]++;
    if ((cov_n1m7r3rr6.b[5][0]++, prevState.currentQuery !== this.state.currentQuery) || (cov_n1m7r3rr6.b[5][1]++, prevProps.outlineTrees !== this.props.outlineTrees)) {
      cov_n1m7r3rr6.b[4][0]++;

      const newMap = (cov_n1m7r3rr6.s[13]++, new Map());
      cov_n1m7r3rr6.s[14]++;
      this.props.outlineTrees.forEach(root => {
        cov_n1m7r3rr6.f[2]++;
        cov_n1m7r3rr6.s[15]++;
        return updateSearchSet(this.state.currentQuery, root, newMap, this.searchResults, prevState.currentQuery);
      });
      cov_n1m7r3rr6.s[16]++;
      this.searchResults = newMap;
      cov_n1m7r3rr6.s[17]++;
      this.props.updateSearchResults(this.searchResults);
    } else {
      cov_n1m7r3rr6.b[4][1]++;
    }
  }

  _findFirstResult(searchResults, tree) {
    cov_n1m7r3rr6.f[3]++;
    cov_n1m7r3rr6.s[18]++;

    for (let i = 0; i < tree.length; i++) {
      const result = (cov_n1m7r3rr6.s[19]++, searchResults.get(tree[i]));
      cov_n1m7r3rr6.s[20]++;
      if ((cov_n1m7r3rr6.b[7][0]++, result) && (cov_n1m7r3rr6.b[7][1]++, result.matches)) {
        cov_n1m7r3rr6.b[6][0]++;
        cov_n1m7r3rr6.s[21]++;

        return tree[i];
      } else {
        cov_n1m7r3rr6.b[6][1]++;
      }
      const child = (cov_n1m7r3rr6.s[22]++, this._findFirstResult(searchResults, tree[i].children));
      cov_n1m7r3rr6.s[23]++;
      if (child) {
        cov_n1m7r3rr6.b[8][0]++;
        cov_n1m7r3rr6.s[24]++;

        return child;
      } else {
        cov_n1m7r3rr6.b[8][1]++;
      }
    }
  }

  render() {
    cov_n1m7r3rr6.f[7]++;
    cov_n1m7r3rr6.s[38]++;

    return _react.createElement(
      'div',
      { className: 'outline-view-search-bar' },
      _react.createElement((_Icon || _load_Icon()).Icon, { icon: 'search', className: 'outline-view-search-icon' }),
      _react.createElement((_AtomInput || _load_AtomInput()).AtomInput, {
        className: 'outline-view-search-pane',
        onConfirm: this._onConfirm,
        onCancel: this._onDidClear,
        onDidChange: this._onDidChange,
        placeholderText: (cov_n1m7r3rr6.b[11][0]++, this.state.currentQuery) || (cov_n1m7r3rr6.b[11][1]++, this.SEARCH_PLACEHOLDER),
        value: this.state.currentQuery,
        size: 'sm'
      }),
      this.state.currentQuery.length > 0 ? (cov_n1m7r3rr6.b[12][0]++, _react.createElement((_Icon || _load_Icon()).Icon, {
        icon: 'x',
        className: 'outline-view-search-clear',
        onClick: this._onDidClear
      })) : (cov_n1m7r3rr6.b[12][1]++, null)
    );
  }
}

exports.OutlineViewSearchComponent = OutlineViewSearchComponent; /* Exported for testing */

function updateSearchSet(query, root, map, prevMap, prevQuery) {
  cov_n1m7r3rr6.f[8]++;
  cov_n1m7r3rr6.s[39]++;

  root.children.forEach(child => {
    cov_n1m7r3rr6.f[9]++;
    cov_n1m7r3rr6.s[40]++;
    return updateSearchSet(query, child, map, prevMap, prevQuery);
  });
  // Optimization using results from previous query.
  // flowlint-next-line sketchy-null-string:off
  cov_n1m7r3rr6.s[41]++;
  if (prevQuery) {
    cov_n1m7r3rr6.b[13][0]++;

    const previousResult = (cov_n1m7r3rr6.s[42]++, prevMap.get(root));
    cov_n1m7r3rr6.s[43]++;
    if ((cov_n1m7r3rr6.b[15][0]++, previousResult) && ((cov_n1m7r3rr6.b[15][1]++, query === prevQuery) || (cov_n1m7r3rr6.b[15][2]++, query.startsWith(prevQuery)) && (cov_n1m7r3rr6.b[15][3]++, !previousResult.visible))) {
      cov_n1m7r3rr6.b[14][0]++;
      cov_n1m7r3rr6.s[44]++;

      map.set(root, previousResult);
      cov_n1m7r3rr6.s[45]++;
      return;
    } else {
      cov_n1m7r3rr6.b[14][1]++;
    }
  } else {
    cov_n1m7r3rr6.b[13][1]++;
  }
  const text = (cov_n1m7r3rr6.s[46]++, root.tokenizedText ? (cov_n1m7r3rr6.b[16][0]++, root.tokenizedText.map(e => {
    cov_n1m7r3rr6.f[10]++;
    cov_n1m7r3rr6.s[47]++;
    return e.value;
  }).join('')) : (cov_n1m7r3rr6.b[16][1]++, (cov_n1m7r3rr6.b[17][0]++, root.plainText) || (cov_n1m7r3rr6.b[17][1]++, '')));
  const matches = (cov_n1m7r3rr6.s[48]++, (cov_n1m7r3rr6.b[18][0]++, query === '') || (cov_n1m7r3rr6.b[18][1]++, (_fuzzaldrinPlus || _load_fuzzaldrinPlus()).default.score(text, query) / (_fuzzaldrinPlus || _load_fuzzaldrinPlus()).default.score(query, query) > SCORE_THRESHOLD));
  const visible = (cov_n1m7r3rr6.s[49]++, (cov_n1m7r3rr6.b[19][0]++, matches) || (cov_n1m7r3rr6.b[19][1]++, Boolean(root.children.find(child => {
    cov_n1m7r3rr6.f[11]++;

    const childResult = (cov_n1m7r3rr6.s[50]++, map.get(child));
    cov_n1m7r3rr6.s[51]++;
    return (cov_n1m7r3rr6.b[20][0]++, !childResult) || (cov_n1m7r3rr6.b[20][1]++, childResult.visible);
  }))));
  let matchingCharacters;
  cov_n1m7r3rr6.s[52]++;
  if (matches) {
    cov_n1m7r3rr6.b[21][0]++;
    cov_n1m7r3rr6.s[53]++;

    matchingCharacters = (_fuzzaldrinPlus || _load_fuzzaldrinPlus()).default.match(text, query);
  } else {
    cov_n1m7r3rr6.b[21][1]++;
  }
  cov_n1m7r3rr6.s[54]++;
  map.set(root, { matches, visible, matchingCharacters });
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIk91dGxpbmVWaWV3U2VhcmNoLmpzIl0sIm5hbWVzIjpbInVwZGF0ZVNlYXJjaFNldCIsIlNDT1JFX1RIUkVTSE9MRCIsIk91dGxpbmVWaWV3U2VhcmNoQ29tcG9uZW50IiwiQ29tcG9uZW50IiwiY29uc3RydWN0b3IiLCJwcm9wcyIsIlNFQVJDSF9QTEFDRUhPTERFUiIsIkRFQk9VTkNFX1RJTUUiLCJfb25Db25maXJtIiwiZmlyc3RFbGVtZW50IiwiX2ZpbmRGaXJzdFJlc3VsdCIsInNlYXJjaFJlc3VsdHMiLCJvdXRsaW5lVHJlZXMiLCJwYW5lIiwiYXRvbSIsIndvcmtzcGFjZSIsInBhbmVGb3JJdGVtIiwiZWRpdG9yIiwidHJhY2siLCJhY3RpdmF0ZSIsImFjdGl2YXRlSXRlbSIsImxpbmUiLCJzdGFydFBvc2l0aW9uIiwicm93IiwiY29sdW1uIiwic2V0U3RhdGUiLCJjdXJyZW50UXVlcnkiLCJfb25EaWRDaGFuZ2UiLCJxdWVyeSIsIl9vbkRpZENsZWFyIiwiTWFwIiwic3RhdGUiLCJjb21wb25lbnREaWRVcGRhdGUiLCJwcmV2UHJvcHMiLCJwcmV2U3RhdGUiLCJ1cGRhdGVTZWFyY2hSZXN1bHRzIiwibmV3TWFwIiwiZm9yRWFjaCIsInJvb3QiLCJ0cmVlIiwiaSIsImxlbmd0aCIsInJlc3VsdCIsImdldCIsIm1hdGNoZXMiLCJjaGlsZCIsImNoaWxkcmVuIiwicmVuZGVyIiwibWFwIiwicHJldk1hcCIsInByZXZRdWVyeSIsInByZXZpb3VzUmVzdWx0Iiwic3RhcnRzV2l0aCIsInZpc2libGUiLCJzZXQiLCJ0ZXh0IiwidG9rZW5pemVkVGV4dCIsImUiLCJ2YWx1ZSIsImpvaW4iLCJwbGFpblRleHQiLCJzY29yZSIsIkJvb2xlYW4iLCJmaW5kIiwiY2hpbGRSZXN1bHQiLCJtYXRjaGluZ0NoYXJhY3RlcnMiLCJtYXRjaCJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztRQWtLZ0JBLGUsR0FBQUEsZTs7QUF0SmhCOzs7O0FBQ0E7QUFBQTtBQUFBOzs7O0FBQ0E7QUFBQTtBQUFBOzs7O0FBQ0E7QUFBQTtBQUFBOzs7O0FBQ0E7QUFBQTtBQUFBOzs7O0FBQ0E7QUFBQTtBQUFBOzs7O0FBRUE7QUFBQTtBQUFBOzs7Ozs7QUFHQSxNQUFN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LCtCQUFPakIsS0FBS2tCLGFBQUwsOEJBQ1RsQixLQUFLa0IsYUFBTCxDQUFtQlIsR0FBbkIsQ0FBdUJTLEtBQUs7QUFBQTtBQUFBO0FBQUEsYUFBRUMsS0FBRjtBQUFPLEdBQW5DLEVBQXFDQyxJQUFyQyxDQUEwQyxFQUExQyxDQURTLCtCQUVULGdDQUFLQyxTQUFMLGdDQUFrQixFQUFsQixDQUZTLENBQVAsQ0FBTjtBQUdBLFFBQU1oQixrQ0FDSixxQ0FBVSxFQUFWLGdDQUNBLG9EQUFlaUIsS0FBZixDQUFxQk4sSUFBckIsRUFBMkIzQixLQUEzQixJQUFvQyxvREFBZWlDLEtBQWYsQ0FBcUJqQyxLQUFyQixFQUE0QkEsS0FBNUIsQ0FBcEMsR0FDRTNCLGVBRkYsQ0FESSxDQUFOO0FBSUEsUUFBTW9ELGtDQUNKLGtFQUNBUyxRQUNFeEIsS0FBS1EsUUFBTCxDQUFjaUIsSUFBZCxDQUFtQmxCLFNBQVM7QUFBQTs7QUFDMUIsVUFBTW1CLHNDQUFjaEIsSUFBSUwsR0FBSixDQUFRRSxLQUFSLENBQWQsQ0FBTjtBQUQwQjtBQUUxQixXQUFPLDRCQUFDbUIsV0FBRCxnQ0FBZ0JBLFlBQVlYLE9BQTVCLENBQVA7QUFDRCxHQUhELENBREYsQ0FEQSxDQURJLENBQU47QUFRQSxNQUFJWSxrQkFBSjtBQWhDTTtBQWlDTixNQUFJckIsT0FBSixFQUFhO0FBQUE7QUFBQTs7QUFDWHFCLHlCQUFxQixvREFBZUMsS0FBZixDQUFxQlgsSUFBckIsRUFBMkIzQixLQUEzQixDQUFyQjtBQUNELEdBRkQ7QUFBQTtBQUFBO0FBakNNO0FBb0NOb0IsTUFBSU0sR0FBSixDQUFRaEIsSUFBUixFQUFjLEVBQUNNLE9BQUQsRUFBVVMsT0FBVixFQUFtQlksa0JBQW5CLEVBQWQ7QUFDRCIsImZpbGUiOiJPdXRsaW5lVmlld1NlYXJjaC5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogQ29weXJpZ2h0IChjKSAyMDE3LXByZXNlbnQsIEZhY2Vib29rLCBJbmMuXG4gKiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuICpcbiAqIFRoaXMgc291cmNlIGNvZGUgaXMgbGljZW5zZWQgdW5kZXIgdGhlIEJTRC1zdHlsZSBsaWNlbnNlIGZvdW5kIGluIHRoZVxuICogTElDRU5TRSBmaWxlIGluIHRoZSByb290IGRpcmVjdG9yeSBvZiB0aGlzIHNvdXJjZSB0cmVlLiBBbiBhZGRpdGlvbmFsIGdyYW50XG4gKiBvZiBwYXRlbnQgcmlnaHRzIGNhbiBiZSBmb3VuZCBpbiB0aGUgUEFURU5UUyBmaWxlIGluIHRoZSBzYW1lIGRpcmVjdG9yeS5cbiAqXG4gKiBAZmxvd1xuICogQGZvcm1hdFxuICovXG5cbmltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcbmltcG9ydCB7QXRvbUlucHV0fSBmcm9tICdudWNsaWRlLWNvbW1vbnMtdWkvQXRvbUlucHV0JztcbmltcG9ydCB7SWNvbn0gZnJvbSAnbnVjbGlkZS1jb21tb25zLXVpL0ljb24nO1xuaW1wb3J0IHtnb1RvTG9jYXRpb25JbkVkaXRvcn0gZnJvbSAnbnVjbGlkZS1jb21tb25zLWF0b20vZ28tdG8tbG9jYXRpb24nO1xuaW1wb3J0IGRlYm91bmNlIGZyb20gJ251Y2xpZGUtY29tbW9ucy9kZWJvdW5jZSc7XG5pbXBvcnQgYW5hbHl0aWNzIGZyb20gJ251Y2xpZGUtY29tbW9ucy1hdG9tL2FuYWx5dGljcyc7XG5cbmltcG9ydCBmdXp6YWxkcmluUGx1cyBmcm9tICdmdXp6YWxkcmluLXBsdXMnO1xuaW1wb3J0IHR5cGUge091dGxpbmVUcmVlRm9yVWl9IGZyb20gJy4vY3JlYXRlT3V0bGluZXMnO1xuXG5jb25zdCBTQ09SRV9USFJFU0hPTEQgPSAwLjE7XG5cbmV4cG9ydCB0eXBlIFNlYXJjaFJlc3VsdCA9IHtcbiAgbWF0Y2hlczogYm9vbGVhbixcbiAgdmlzaWJsZTogYm9vbGVhbixcbiAgbWF0Y2hpbmdDaGFyYWN0ZXJzPzogQXJyYXk8bnVtYmVyPixcbn07XG5cbnR5cGUgUHJvcHMgPSB7XG4gIGVkaXRvcjogYXRvbSRUZXh0RWRpdG9yLFxuICBvdXRsaW5lVHJlZXM6IEFycmF5PE91dGxpbmVUcmVlRm9yVWk+LFxuICB1cGRhdGVTZWFyY2hSZXN1bHRzOiAoXG4gICAgc2VhcmNoUmVzdWx0czogTWFwPE91dGxpbmVUcmVlRm9yVWksIFNlYXJjaFJlc3VsdD4sXG4gICkgPT4gdm9pZCxcbn07XG5cbnR5cGUgU3RhdGUgPSB7XG4gIGN1cnJlbnRRdWVyeTogc3RyaW5nLFxufTtcblxuZXhwb3J0IGNsYXNzIE91dGxpbmVWaWV3U2VhcmNoQ29tcG9uZW50IGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50PFByb3BzLCBTdGF0ZT4ge1xuICBzZWFyY2hSZXN1bHRzOiBNYXA8T3V0bGluZVRyZWVGb3JVaSwgU2VhcmNoUmVzdWx0PjtcblxuICBjb25zdHJ1Y3Rvcihwcm9wczogUHJvcHMpIHtcbiAgICBzdXBlcihwcm9wcyk7XG4gICAgLy8gQW4gZWxlbWVudCBpcyBjb25zaWRlcmVkIHZpc2libGUgaWYgaXQgaXMgbm90IGluIHRoZSBNYXAgb3IgaWYgaXQgaGFzIGFcbiAgICAvLyBTZWFyY2ggcmVzdWx0IHRoYXQgaGFzIHRoZSB2aXNpYmxlIHByb3BlcnR5IHNldCB0byB0cnVlLiBUaGVyZWZvcmUsIGFsbFxuICAgIC8vIGVsZW1lbnRzIGFyZSB2aXNpYmxlIHdoZW4gdGhlIE1hcCBpcyBlbXB0eS5cbiAgICB0aGlzLnNlYXJjaFJlc3VsdHMgPSBuZXcgTWFwKCk7XG4gICAgdGhpcy5zdGF0ZSA9IHtcbiAgICAgIGN1cnJlbnRRdWVyeTogJycsXG4gICAgfTtcbiAgfVxuXG4gIFNFQVJDSF9QTEFDRUhPTERFUiA9ICdTZWFyY2ggT3V0bGluZSc7XG4gIERFQk9VTkNFX1RJTUUgPSAxMDA7XG5cbiAgY29tcG9uZW50RGlkVXBkYXRlKHByZXZQcm9wczogUHJvcHMsIHByZXZTdGF0ZTogU3RhdGUpIHtcbiAgICBpZiAocHJldlN0YXRlLmN1cnJlbnRRdWVyeSA9PT0gJycgJiYgdGhpcy5zdGF0ZS5jdXJyZW50UXVlcnkgPT09ICcnKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGlmICh0aGlzLnN0YXRlLmN1cnJlbnRRdWVyeSA9PT0gJycpIHtcbiAgICAgIHRoaXMucHJvcHMudXBkYXRlU2VhcmNoUmVzdWx0cyhuZXcgTWFwKCkpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBpZiAocHJldlByb3BzLmVkaXRvciAhPT0gdGhpcy5wcm9wcy5lZGl0b3IpIHtcbiAgICAgIHRoaXMuc2V0U3RhdGUoe2N1cnJlbnRRdWVyeTogJyd9KTtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaWYgKFxuICAgICAgcHJldlN0YXRlLmN1cnJlbnRRdWVyeSAhPT0gdGhpcy5zdGF0ZS5jdXJyZW50UXVlcnkgfHxcbiAgICAgIHByZXZQcm9wcy5vdXRsaW5lVHJlZXMgIT09IHRoaXMucHJvcHMub3V0bGluZVRyZWVzXG4gICAgKSB7XG4gICAgICBjb25zdCBuZXdNYXAgPSBuZXcgTWFwKCk7XG4gICAgICB0aGlzLnByb3BzLm91dGxpbmVUcmVlcy5mb3JFYWNoKHJvb3QgPT5cbiAgICAgICAgdXBkYXRlU2VhcmNoU2V0KFxuICAgICAgICAgIHRoaXMuc3RhdGUuY3VycmVudFF1ZXJ5LFxuICAgICAgICAgIHJvb3QsXG4gICAgICAgICAgbmV3TWFwLFxuICAgICAgICAgIHRoaXMuc2VhcmNoUmVzdWx0cyxcbiAgICAgICAgICBwcmV2U3RhdGUuY3VycmVudFF1ZXJ5LFxuICAgICAgICApLFxuICAgICAgKTtcbiAgICAgIHRoaXMuc2VhcmNoUmVzdWx0cyA9IG5ld01hcDtcbiAgICAgIHRoaXMucHJvcHMudXBkYXRlU2VhcmNoUmVzdWx0cyh0aGlzLnNlYXJjaFJlc3VsdHMpO1xuICAgIH1cbiAgfVxuXG4gIF9maW5kRmlyc3RSZXN1bHQoXG4gICAgc2VhcmNoUmVzdWx0czogTWFwPE91dGxpbmVUcmVlRm9yVWksIFNlYXJjaFJlc3VsdD4sXG4gICAgdHJlZTogQXJyYXk8T3V0bGluZVRyZWVGb3JVaT4sXG4gICk6ID9PdXRsaW5lVHJlZUZvclVpIHtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRyZWUubGVuZ3RoOyBpKyspIHtcbiAgICAgIGNvbnN0IHJlc3VsdCA9IHNlYXJjaFJlc3VsdHMuZ2V0KHRyZWVbaV0pO1xuICAgICAgaWYgKHJlc3VsdCAmJiByZXN1bHQubWF0Y2hlcykge1xuICAgICAgICByZXR1cm4gdHJlZVtpXTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IGNoaWxkID0gdGhpcy5fZmluZEZpcnN0UmVzdWx0KHNlYXJjaFJlc3VsdHMsIHRyZWVbaV0uY2hpbGRyZW4pO1xuICAgICAgaWYgKGNoaWxkKSB7XG4gICAgICAgIHJldHVybiBjaGlsZDtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBfb25Db25maXJtID0gKCkgPT4ge1xuICAgIGNvbnN0IGZpcnN0RWxlbWVudCA9IHRoaXMuX2ZpbmRGaXJzdFJlc3VsdChcbiAgICAgIHRoaXMuc2VhcmNoUmVzdWx0cyxcbiAgICAgIHRoaXMucHJvcHMub3V0bGluZVRyZWVzLFxuICAgICk7XG4gICAgaWYgKGZpcnN0RWxlbWVudCA9PSBudWxsKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGNvbnN0IHBhbmUgPSBhdG9tLndvcmtzcGFjZS5wYW5lRm9ySXRlbSh0aGlzLnByb3BzLmVkaXRvcik7XG4gICAgaWYgKHBhbmUgPT0gbnVsbCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBhbmFseXRpY3MudHJhY2soJ291dGxpbmUtdmlldzpzZWFyY2gtZW50ZXInKTtcbiAgICBwYW5lLmFjdGl2YXRlKCk7XG4gICAgcGFuZS5hY3RpdmF0ZUl0ZW0odGhpcy5wcm9wcy5lZGl0b3IpO1xuICAgIGdvVG9Mb2NhdGlvbkluRWRpdG9yKHRoaXMucHJvcHMuZWRpdG9yLCB7XG4gICAgICBsaW5lOiBmaXJzdEVsZW1lbnQuc3RhcnRQb3NpdGlvbi5yb3csXG4gICAgICBjb2x1bW46IGZpcnN0RWxlbWVudC5zdGFydFBvc2l0aW9uLmNvbHVtbixcbiAgICB9KTtcbiAgICB0aGlzLnNldFN0YXRlKHtjdXJyZW50UXVlcnk6ICcnfSk7XG4gIH07XG5cbiAgX29uRGlkQ2hhbmdlID0gZGVib3VuY2UocXVlcnkgPT4ge1xuICAgIHRoaXMuc2V0U3RhdGUoe2N1cnJlbnRRdWVyeTogcXVlcnl9KTtcbiAgfSwgdGhpcy5ERUJPVU5DRV9USU1FKTtcblxuICBfb25EaWRDbGVhciA9ICgpID0+IHtcbiAgICB0aGlzLnNldFN0YXRlKHtjdXJyZW50UXVlcnk6ICcnfSk7XG4gIH07XG5cbiAgcmVuZGVyKCk6IFJlYWN0Lk5vZGUge1xuICAgIHJldHVybiAoXG4gICAgICA8ZGl2IGNsYXNzTmFtZT1cIm91dGxpbmUtdmlldy1zZWFyY2gtYmFyXCI+XG4gICAgICAgIDxJY29uIGljb249XCJzZWFyY2hcIiBjbGFzc05hbWU9XCJvdXRsaW5lLXZpZXctc2VhcmNoLWljb25cIiAvPlxuICAgICAgICA8QXRvbUlucHV0XG4gICAgICAgICAgY2xhc3NOYW1lPVwib3V0bGluZS12aWV3LXNlYXJjaC1wYW5lXCJcbiAgICAgICAgICBvbkNvbmZpcm09e3RoaXMuX29uQ29uZmlybX1cbiAgICAgICAgICBvbkNhbmNlbD17dGhpcy5fb25EaWRDbGVhcn1cbiAgICAgICAgICBvbkRpZENoYW5nZT17dGhpcy5fb25EaWRDaGFuZ2V9XG4gICAgICAgICAgcGxhY2Vob2xkZXJUZXh0PXt0aGlzLnN0YXRlLmN1cnJlbnRRdWVyeSB8fCB0aGlzLlNFQVJDSF9QTEFDRUhPTERFUn1cbiAgICAgICAgICB2YWx1ZT17dGhpcy5zdGF0ZS5jdXJyZW50UXVlcnl9XG4gICAgICAgICAgc2l6ZT1cInNtXCJcbiAgICAgICAgLz5cbiAgICAgICAge3RoaXMuc3RhdGUuY3VycmVudFF1ZXJ5Lmxlbmd0aCA+IDAgPyAoXG4gICAgICAgICAgPEljb25cbiAgICAgICAgICAgIGljb249XCJ4XCJcbiAgICAgICAgICAgIGNsYXNzTmFtZT1cIm91dGxpbmUtdmlldy1zZWFyY2gtY2xlYXJcIlxuICAgICAgICAgICAgb25DbGljaz17dGhpcy5fb25EaWRDbGVhcn1cbiAgICAgICAgICAvPlxuICAgICAgICApIDogbnVsbH1cbiAgICAgIDwvZGl2PlxuICAgICk7XG4gIH1cbn1cblxuLyogRXhwb3J0ZWQgZm9yIHRlc3RpbmcgKi9cbmV4cG9ydCBmdW5jdGlvbiB1cGRhdGVTZWFyY2hTZXQoXG4gIHF1ZXJ5OiBzdHJpbmcsXG4gIHJvb3Q6IE91dGxpbmVUcmVlRm9yVWksXG4gIG1hcDogTWFwPE91dGxpbmVUcmVlRm9yVWksIFNlYXJjaFJlc3VsdD4sXG4gIHByZXZNYXA6IE1hcDxPdXRsaW5lVHJlZUZvclVpLCBTZWFyY2hSZXN1bHQ+LFxuICBwcmV2UXVlcnk6ID9zdHJpbmcsXG4pOiB2b2lkIHtcbiAgcm9vdC5jaGlsZHJlbi5mb3JFYWNoKGNoaWxkID0+XG4gICAgdXBkYXRlU2VhcmNoU2V0KHF1ZXJ5LCBjaGlsZCwgbWFwLCBwcmV2TWFwLCBwcmV2UXVlcnkpLFxuICApO1xuICAvLyBPcHRpbWl6YXRpb24gdXNpbmcgcmVzdWx0cyBmcm9tIHByZXZpb3VzIHF1ZXJ5LlxuICAvLyBmbG93bGludC1uZXh0LWxpbmUgc2tldGNoeS1udWxsLXN0cmluZzpvZmZcbiAgaWYgKHByZXZRdWVyeSkge1xuICAgIGNvbnN0IHByZXZpb3VzUmVzdWx0ID0gcHJldk1hcC5nZXQocm9vdCk7XG4gICAgaWYgKFxuICAgICAgcHJldmlvdXNSZXN1bHQgJiZcbiAgICAgIChxdWVyeSA9PT0gcHJldlF1ZXJ5IHx8XG4gICAgICAgIChxdWVyeS5zdGFydHNXaXRoKHByZXZRdWVyeSkgJiYgIXByZXZpb3VzUmVzdWx0LnZpc2libGUpKVxuICAgICkge1xuICAgICAgbWFwLnNldChyb290LCBwcmV2aW91c1Jlc3VsdCk7XG4gICAgICByZXR1cm47XG4gICAgfVxuICB9XG4gIGNvbnN0IHRleHQgPSByb290LnRva2VuaXplZFRleHRcbiAgICA/IHJvb3QudG9rZW5pemVkVGV4dC5tYXAoZSA9PiBlLnZhbHVlKS5qb2luKCcnKVxuICAgIDogcm9vdC5wbGFpblRleHQgfHwgJyc7XG4gIGNvbnN0IG1hdGNoZXMgPVxuICAgIHF1ZXJ5ID09PSAnJyB8fFxuICAgIGZ1enphbGRyaW5QbHVzLnNjb3JlKHRleHQsIHF1ZXJ5KSAvIGZ1enphbGRyaW5QbHVzLnNjb3JlKHF1ZXJ5LCBxdWVyeSkgPlxuICAgICAgU0NPUkVfVEhSRVNIT0xEO1xuICBjb25zdCB2aXNpYmxlID1cbiAgICBtYXRjaGVzIHx8XG4gICAgQm9vbGVhbihcbiAgICAgIHJvb3QuY2hpbGRyZW4uZmluZChjaGlsZCA9PiB7XG4gICAgICAgIGNvbnN0IGNoaWxkUmVzdWx0ID0gbWFwLmdldChjaGlsZCk7XG4gICAgICAgIHJldHVybiAhY2hpbGRSZXN1bHQgfHwgY2hpbGRSZXN1bHQudmlzaWJsZTtcbiAgICAgIH0pLFxuICAgICk7XG4gIGxldCBtYXRjaGluZ0NoYXJhY3RlcnM7XG4gIGlmIChtYXRjaGVzKSB7XG4gICAgbWF0Y2hpbmdDaGFyYWN0ZXJzID0gZnV6emFsZHJpblBsdXMubWF0Y2godGV4dCwgcXVlcnkpO1xuICB9XG4gIG1hcC5zZXQocm9vdCwge21hdGNoZXMsIHZpc2libGUsIG1hdGNoaW5nQ2hhcmFjdGVyc30pO1xufVxuIl19