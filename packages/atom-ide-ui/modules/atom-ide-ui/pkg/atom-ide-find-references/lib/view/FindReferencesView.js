'use strict';

var cov_1i1jrgxzsi = function () {
  var path = '/Users/hansonw/atom-ide-ui/modules/atom-ide-ui/pkg/atom-ide-find-references/lib/view/FindReferencesView.js',
      hash = '638d6df218da2664a253e069b9c3fd6b93621834',
      global = new Function('return this')(),
      gcv = '__coverage__',
      coverageData = {
    path: '/Users/hansonw/atom-ide-ui/modules/atom-ide-ui/pkg/atom-ide-find-references/lib/view/FindReferencesView.js',
    statementMap: {
      '0': {
        start: {
          line: 21,
          column: 18
        },
        end: {
          line: 21,
          column: 20
        }
      },
      '1': {
        start: {
          line: 23,
          column: 30
        },
        end: {
          line: 23,
          column: 33
        }
      },
      '2': {
        start: {
          line: 38,
          column: 4
        },
        end: {
          line: 38,
          column: 17
        }
      },
      '3': {
        start: {
          line: 39,
          column: 4
        },
        end: {
          line: 44,
          column: 6
        }
      },
      '4': {
        start: {
          line: 46,
          column: 4
        },
        end: {
          line: 46,
          column: 56
        }
      },
      '5': {
        start: {
          line: 47,
          column: 4
        },
        end: {
          line: 47,
          column: 54
        }
      },
      '6': {
        start: {
          line: 48,
          column: 4
        },
        end: {
          line: 48,
          column: 58
        }
      },
      '7': {
        start: {
          line: 52,
          column: 4
        },
        end: {
          line: 52,
          column: 31
        }
      },
      '8': {
        start: {
          line: 56,
          column: 17
        },
        end: {
          line: 59,
          column: 5
        }
      },
      '9': {
        start: {
          line: 60,
          column: 4
        },
        end: {
          line: 64,
          column: 7
        }
      },
      '10': {
        start: {
          line: 68,
          column: 17
        },
        end: {
          line: 68,
          column: 31
        }
      },
      '11': {
        start: {
          line: 69,
          column: 4
        },
        end: {
          line: 71,
          column: 5
        }
      },
      '12': {
        start: {
          line: 70,
          column: 6
        },
        end: {
          line: 70,
          column: 13
        }
      },
      '13': {
        start: {
          line: 72,
          column: 25
        },
        end: {
          line: 72,
          column: 59
        }
      },
      '14': {
        start: {
          line: 73,
          column: 4
        },
        end: {
          line: 76,
          column: 5
        }
      },
      '15': {
        start: {
          line: 74,
          column: 6
        },
        end: {
          line: 74,
          column: 37
        }
      },
      '16': {
        start: {
          line: 75,
          column: 6
        },
        end: {
          line: 75,
          column: 33
        }
      },
      '17': {
        start: {
          line: 80,
          column: 4
        },
        end: {
          line: 80,
          column: 66
        }
      },
      '18': {
        start: {
          line: 84,
          column: 21
        },
        end: {
          line: 92,
          column: 6
        }
      },
      '19': {
        start: {
          line: 85,
          column: 6
        },
        end: {
          line: 91,
          column: 8
        }
      },
      '20': {
        start: {
          line: 90,
          column: 29
        },
        end: {
          line: 90,
          column: 48
        }
      },
      '21': {
        start: {
          line: 94,
          column: 21
        },
        end: {
          line: 94,
          column: 57
        }
      },
      '22': {
        start: {
          line: 95,
          column: 22
        },
        end: {
          line: 95,
          column: 53
        }
      },
      '23': {
        start: {
          line: 96,
          column: 4
        },
        end: {
          line: 103,
          column: 5
        }
      },
      '24': {
        start: {
          line: 97,
          column: 6
        },
        end: {
          line: 102,
          column: 8
        }
      },
      '25': {
        start: {
          line: 105,
          column: 4
        },
        end: {
          line: 122,
          column: 6
        }
      }
    },
    fnMap: {
      '0': {
        name: '(anonymous_0)',
        decl: {
          start: {
            line: 37,
            column: 2
          },
          end: {
            line: 37,
            column: 3
          }
        },
        loc: {
          start: {
            line: 37,
            column: 28
          },
          end: {
            line: 49,
            column: 3
          }
        },
        line: 37
      },
      '1': {
        name: '(anonymous_1)',
        decl: {
          start: {
            line: 51,
            column: 2
          },
          end: {
            line: 51,
            column: 3
          }
        },
        loc: {
          start: {
            line: 51,
            column: 22
          },
          end: {
            line: 53,
            column: 3
          }
        },
        line: 51
      },
      '2': {
        name: '(anonymous_2)',
        decl: {
          start: {
            line: 55,
            column: 2
          },
          end: {
            line: 55,
            column: 3
          }
        },
        loc: {
          start: {
            line: 55,
            column: 49
          },
          end: {
            line: 65,
            column: 3
          }
        },
        line: 55
      },
      '3': {
        name: '(anonymous_3)',
        decl: {
          start: {
            line: 67,
            column: 2
          },
          end: {
            line: 67,
            column: 3
          }
        },
        loc: {
          start: {
            line: 67,
            column: 24
          },
          end: {
            line: 77,
            column: 3
          }
        },
        line: 67
      },
      '4': {
        name: '(anonymous_4)',
        decl: {
          start: {
            line: 79,
            column: 2
          },
          end: {
            line: 79,
            column: 3
          }
        },
        loc: {
          start: {
            line: 79,
            column: 25
          },
          end: {
            line: 81,
            column: 3
          }
        },
        line: 79
      },
      '5': {
        name: '(anonymous_5)',
        decl: {
          start: {
            line: 83,
            column: 2
          },
          end: {
            line: 83,
            column: 3
          }
        },
        loc: {
          start: {
            line: 83,
            column: 23
          },
          end: {
            line: 123,
            column: 3
          }
        },
        line: 83
      },
      '6': {
        name: '(anonymous_6)',
        decl: {
          start: {
            line: 84,
            column: 47
          },
          end: {
            line: 84,
            column: 48
          }
        },
        loc: {
          start: {
            line: 85,
            column: 6
          },
          end: {
            line: 91,
            column: 8
          }
        },
        line: 85
      },
      '7': {
        name: '(anonymous_7)',
        decl: {
          start: {
            line: 90,
            column: 23
          },
          end: {
            line: 90,
            column: 24
          }
        },
        loc: {
          start: {
            line: 90,
            column: 29
          },
          end: {
            line: 90,
            column: 48
          }
        },
        line: 90
      }
    },
    branchMap: {
      '0': {
        loc: {
          start: {
            line: 69,
            column: 4
          },
          end: {
            line: 71,
            column: 5
          }
        },
        type: 'if',
        locations: [{
          start: {
            line: 69,
            column: 4
          },
          end: {
            line: 71,
            column: 5
          }
        }, {
          start: {
            line: 69,
            column: 4
          },
          end: {
            line: 71,
            column: 5
          }
        }],
        line: 69
      },
      '1': {
        loc: {
          start: {
            line: 69,
            column: 8
          },
          end: {
            line: 69,
            column: 68
          }
        },
        type: 'binary-expr',
        locations: [{
          start: {
            line: 69,
            column: 8
          },
          end: {
            line: 69,
            column: 26
          }
        }, {
          start: {
            line: 69,
            column: 30
          },
          end: {
            line: 69,
            column: 68
          }
        }],
        line: 69
      },
      '2': {
        loc: {
          start: {
            line: 73,
            column: 4
          },
          end: {
            line: 76,
            column: 5
          }
        },
        type: 'if',
        locations: [{
          start: {
            line: 73,
            column: 4
          },
          end: {
            line: 76,
            column: 5
          }
        }, {
          start: {
            line: 73,
            column: 4
          },
          end: {
            line: 76,
            column: 5
          }
        }],
        line: 73
      },
      '3': {
        loc: {
          start: {
            line: 80,
            column: 29
          },
          end: {
            line: 80,
            column: 63
          }
        },
        type: 'cond-expr',
        locations: [{
          start: {
            line: 80,
            column: 57
          },
          end: {
            line: 80,
            column: 59
          }
        }, {
          start: {
            line: 80,
            column: 62
          },
          end: {
            line: 80,
            column: 63
          }
        }],
        line: 80
      },
      '4': {
        loc: {
          start: {
            line: 96,
            column: 4
          },
          end: {
            line: 103,
            column: 5
          }
        },
        type: 'if',
        locations: [{
          start: {
            line: 96,
            column: 4
          },
          end: {
            line: 103,
            column: 5
          }
        }, {
          start: {
            line: 96,
            column: 4
          },
          end: {
            line: 103,
            column: 5
          }
        }],
        line: 96
      }
    },
    s: {
      '0': 0,
      '1': 0,
      '2': 0,
      '3': 0,
      '4': 0,
      '5': 0,
      '6': 0,
      '7': 0,
      '8': 0,
      '9': 0,
      '10': 0,
      '11': 0,
      '12': 0,
      '13': 0,
      '14': 0,
      '15': 0,
      '16': 0,
      '17': 0,
      '18': 0,
      '19': 0,
      '20': 0,
      '21': 0,
      '22': 0,
      '23': 0,
      '24': 0,
      '25': 0
    },
    f: {
      '0': 0,
      '1': 0,
      '2': 0,
      '3': 0,
      '4': 0,
      '5': 0,
      '6': 0,
      '7': 0
    },
    b: {
      '0': [0, 0],
      '1': [0, 0],
      '2': [0, 0],
      '3': [0, 0],
      '4': [0, 0]
    },
    _coverageSchema: '332fd63041d2c1bcb487cc26dd0d5f7d97098a6c'
  },
      coverage = global[gcv] || (global[gcv] = {});

  if (coverage[path] && coverage[path].hash === hash) {
    return coverage[path];
  }

  coverageData.hash = hash;
  return coverage[path] = coverageData;
}();

Object.defineProperty(exports, "__esModule", {
  value: true
});

var _asyncToGenerator = _interopRequireDefault(require('async-to-generator'));

var _react = _interopRequireWildcard(require('react'));

var _FileReferencesView;

function _load_FileReferencesView() {
  return _FileReferencesView = _interopRequireDefault(require('./FileReferencesView'));
}

var _FindReferencesModel;

function _load_FindReferencesModel() {
  return _FindReferencesModel = _interopRequireDefault(require('../FindReferencesModel'));
}

var _string;

function _load_string() {
  return _string = require('nuclide-commons/string');
}

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

// Number of files to show on every page.
const PAGE_SIZE = (cov_1i1jrgxzsi.s[0]++, 10);
// Start loading more once the user scrolls within this many pixels of the bottom.
/**
 * Copyright (c) 2017-present, Facebook, Inc.
 * All rights reserved.
 *
 * This source code is licensed under the BSD-style license found in the
 * LICENSE file in the root directory of this source tree. An additional grant
 * of patent rights can be found in the PATENTS file in the same directory.
 *
 * 
 * @format
 */

const SCROLL_LOAD_THRESHOLD = (cov_1i1jrgxzsi.s[1]++, 250);

class FindReferencesView extends _react.Component {
  constructor(props) {
    cov_1i1jrgxzsi.f[0]++;
    cov_1i1jrgxzsi.s[2]++;

    super(props);
    cov_1i1jrgxzsi.s[3]++;
    this.state = {
      loading: true,
      fetched: 0,
      selected: -1,
      references: []
    };

    cov_1i1jrgxzsi.s[4]++;
    this._fetchMore = this._fetchMore.bind(this);
    cov_1i1jrgxzsi.s[5]++;
    this._onScroll = this._onScroll.bind(this);
    cov_1i1jrgxzsi.s[6]++;
    this._childClick = this._childClick.bind(this);
  }

  componentDidMount() {
    cov_1i1jrgxzsi.f[1]++;
    cov_1i1jrgxzsi.s[7]++;

    this._fetchMore(PAGE_SIZE);
  }

  _fetchMore(count) {
    var _this = this;

    return (0, _asyncToGenerator.default)(function* () {
      cov_1i1jrgxzsi.f[2]++;

      const next = (cov_1i1jrgxzsi.s[8]++, yield _this.props.model.getFileReferences(_this.state.fetched, PAGE_SIZE));
      cov_1i1jrgxzsi.s[9]++;
      _this.setState({
        loading: false,
        fetched: _this.state.fetched + PAGE_SIZE,
        references: _this.state.references.concat(next)
      });
    })();
  }

  _onScroll(evt) {
    cov_1i1jrgxzsi.f[3]++;

    const root = (cov_1i1jrgxzsi.s[10]++, this.refs.root);
    cov_1i1jrgxzsi.s[11]++;
    if ((cov_1i1jrgxzsi.b[1][0]++, this.state.loading) || (cov_1i1jrgxzsi.b[1][1]++, root.clientHeight >= root.scrollHeight)) {
      cov_1i1jrgxzsi.b[0][0]++;
      cov_1i1jrgxzsi.s[12]++;

      return;
    } else {
      cov_1i1jrgxzsi.b[0][1]++;
    }
    const scrollBottom = (cov_1i1jrgxzsi.s[13]++, root.scrollTop + root.clientHeight);
    cov_1i1jrgxzsi.s[14]++;
    if (root.scrollHeight - scrollBottom <= SCROLL_LOAD_THRESHOLD) {
      cov_1i1jrgxzsi.b[2][0]++;
      cov_1i1jrgxzsi.s[15]++;

      this.setState({ loading: true });
      cov_1i1jrgxzsi.s[16]++;
      this._fetchMore(PAGE_SIZE);
    } else {
      cov_1i1jrgxzsi.b[2][1]++;
    }
  }

  _childClick(i) {
    cov_1i1jrgxzsi.f[4]++;
    cov_1i1jrgxzsi.s[17]++;

    this.setState({ selected: this.state.selected === i ? (cov_1i1jrgxzsi.b[3][0]++, -1) : (cov_1i1jrgxzsi.b[3][1]++, i) });
  }

  render() {
    cov_1i1jrgxzsi.f[5]++;

    const children = (cov_1i1jrgxzsi.s[18]++, this.state.references.map((fileRefs, i) => {
      cov_1i1jrgxzsi.f[6]++;
      cov_1i1jrgxzsi.s[19]++;
      return _react.createElement((_FileReferencesView || _load_FileReferencesView()).default, Object.assign({
        key: i,
        isSelected: this.state.selected === i
      }, fileRefs, {
        basePath: this.props.model.getBasePath(),
        clickCallback: () => {
          cov_1i1jrgxzsi.f[7]++;
          cov_1i1jrgxzsi.s[20]++;
          return this._childClick(i);
        }
      }));
    }));

    const refCount = (cov_1i1jrgxzsi.s[21]++, this.props.model.getReferenceCount());
    const fileCount = (cov_1i1jrgxzsi.s[22]++, this.props.model.getFileCount());
    cov_1i1jrgxzsi.s[23]++;
    if (this.state.fetched < fileCount) {
      cov_1i1jrgxzsi.b[4][0]++;
      cov_1i1jrgxzsi.s[24]++;

      children.push(_react.createElement('div', {
        key: 'loading',
        className: 'find-references-loading loading-spinner-medium'
      }));
    } else {
      cov_1i1jrgxzsi.b[4][1]++;
    }

    cov_1i1jrgxzsi.s[25]++;
    return _react.createElement(
      'div',
      { className: 'find-references' },
      _react.createElement(
        'div',
        { className: 'find-references-count panel-heading' },
        refCount,
        ' ',
        (0, (_string || _load_string()).pluralize)('reference', refCount),
        ' found in ',
        fileCount,
        ' ',
        (0, (_string || _load_string()).pluralize)('file', fileCount),
        ' for',
        ' ',
        _react.createElement(
          'span',
          { className: 'highlight-info' },
          this.props.model.getSymbolName()
        )
      ),
      _react.createElement(
        'ul',
        {
          className: 'find-references-files list-tree has-collapsable-children',
          onScroll: this._onScroll,
          ref: 'root',
          tabIndex: '0' },
        children
      )
    );
  }
}
exports.default = FindReferencesView;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkZpbmRSZWZlcmVuY2VzVmlldy5qcyJdLCJuYW1lcyI6WyJQQUdFX1NJWkUiLCJTQ1JPTExfTE9BRF9USFJFU0hPTEQiLCJGaW5kUmVmZXJlbmNlc1ZpZXciLCJDb21wb25lbnQiLCJjb25zdHJ1Y3RvciIsInByb3BzIiwic3RhdGUiLCJsb2FkaW5nIiwiZmV0Y2hlZCIsInNlbGVjdGVkIiwicmVmZXJlbmNlcyIsIl9mZXRjaE1vcmUiLCJiaW5kIiwiX29uU2Nyb2xsIiwiX2NoaWxkQ2xpY2siLCJjb21wb25lbnREaWRNb3VudCIsImNvdW50IiwibmV4dCIsIm1vZGVsIiwiZ2V0RmlsZVJlZmVyZW5jZXMiLCJzZXRTdGF0ZSIsImNvbmNhdCIsImV2dCIsInJvb3QiLCJyZWZzIiwiY2xpZW50SGVpZ2h0Iiwic2Nyb2xsSGVpZ2h0Iiwic2Nyb2xsQm90dG9tIiwic2Nyb2xsVG9wIiwiaSIsInJlbmRlciIsImNoaWxkcmVuIiwibWFwIiwiZmlsZVJlZnMiLCJnZXRCYXNlUGF0aCIsInJlZkNvdW50IiwiZ2V0UmVmZXJlbmNlQ291bnQiLCJmaWxlQ291bnQiLCJnZXRGaWxlQ291bnQiLCJwdXNoIiwiZ2V0U3ltYm9sTmFtZSJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7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QVYsRUFBa0JBLFNBQWxCLENBRkg7QUFBQTtBQUVxQyxXQUZyQztBQUdFO0FBQUE7QUFBQSxZQUFNLFdBQVUsZ0JBQWhCO0FBQ0csZUFBS2hDLEtBQUwsQ0FBV2EsS0FBWCxDQUFpQnNCLGFBQWpCO0FBREg7QUFIRixPQURGO0FBUUU7QUFBQTtBQUFBO0FBQ0UscUJBQVUsMERBRFo7QUFFRSxvQkFBVSxLQUFLM0IsU0FGakI7QUFHRSxlQUFJLE1BSE47QUFJRSxvQkFBUyxHQUpYO0FBS0drQjtBQUxIO0FBUkYsS0FERjtBQWtCRDtBQXZGMkU7a0JBQXpEN0Isa0IiLCJmaWxlIjoiRmluZFJlZmVyZW5jZXNWaWV3LmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTctcHJlc2VudCwgRmFjZWJvb2ssIEluYy5cbiAqIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4gKlxuICogVGhpcyBzb3VyY2UgY29kZSBpcyBsaWNlbnNlZCB1bmRlciB0aGUgQlNELXN0eWxlIGxpY2Vuc2UgZm91bmQgaW4gdGhlXG4gKiBMSUNFTlNFIGZpbGUgaW4gdGhlIHJvb3QgZGlyZWN0b3J5IG9mIHRoaXMgc291cmNlIHRyZWUuIEFuIGFkZGl0aW9uYWwgZ3JhbnRcbiAqIG9mIHBhdGVudCByaWdodHMgY2FuIGJlIGZvdW5kIGluIHRoZSBQQVRFTlRTIGZpbGUgaW4gdGhlIHNhbWUgZGlyZWN0b3J5LlxuICpcbiAqIEBmbG93XG4gKiBAZm9ybWF0XG4gKi9cblxuaW1wb3J0IHR5cGUge0ZpbGVSZWZlcmVuY2VzfSBmcm9tICcuLi90eXBlcyc7XG5cbmltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcbmltcG9ydCBGaWxlUmVmZXJlbmNlc1ZpZXcgZnJvbSAnLi9GaWxlUmVmZXJlbmNlc1ZpZXcnO1xuaW1wb3J0IEZpbmRSZWZlcmVuY2VzTW9kZWwgZnJvbSAnLi4vRmluZFJlZmVyZW5jZXNNb2RlbCc7XG5pbXBvcnQge3BsdXJhbGl6ZX0gZnJvbSAnbnVjbGlkZS1jb21tb25zL3N0cmluZyc7XG5cbi8vIE51bWJlciBvZiBmaWxlcyB0byBzaG93IG9uIGV2ZXJ5IHBhZ2UuXG5jb25zdCBQQUdFX1NJWkUgPSAxMDtcbi8vIFN0YXJ0IGxvYWRpbmcgbW9yZSBvbmNlIHRoZSB1c2VyIHNjcm9sbHMgd2l0aGluIHRoaXMgbWFueSBwaXhlbHMgb2YgdGhlIGJvdHRvbS5cbmNvbnN0IFNDUk9MTF9MT0FEX1RIUkVTSE9MRCA9IDI1MDtcblxudHlwZSBQcm9wcyA9IHtcbiAgbW9kZWw6IEZpbmRSZWZlcmVuY2VzTW9kZWwsXG59O1xuXG50eXBlIFN0YXRlID0ge1xuICBsb2FkaW5nOiBib29sZWFuLFxuICBmZXRjaGVkOiBudW1iZXIsXG4gIHNlbGVjdGVkOiBudW1iZXIsXG4gIHJlZmVyZW5jZXM6IEFycmF5PEZpbGVSZWZlcmVuY2VzPixcbn07XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEZpbmRSZWZlcmVuY2VzVmlldyBleHRlbmRzIFJlYWN0LkNvbXBvbmVudDxQcm9wcywgU3RhdGU+IHtcbiAgY29uc3RydWN0b3IocHJvcHM6IFByb3BzKSB7XG4gICAgc3VwZXIocHJvcHMpO1xuICAgIHRoaXMuc3RhdGUgPSB7XG4gICAgICBsb2FkaW5nOiB0cnVlLFxuICAgICAgZmV0Y2hlZDogMCxcbiAgICAgIHNlbGVjdGVkOiAtMSxcbiAgICAgIHJlZmVyZW5jZXM6IFtdLFxuICAgIH07XG5cbiAgICAodGhpczogYW55KS5fZmV0Y2hNb3JlID0gdGhpcy5fZmV0Y2hNb3JlLmJpbmQodGhpcyk7XG4gICAgKHRoaXM6IGFueSkuX29uU2Nyb2xsID0gdGhpcy5fb25TY3JvbGwuYmluZCh0aGlzKTtcbiAgICAodGhpczogYW55KS5fY2hpbGRDbGljayA9IHRoaXMuX2NoaWxkQ2xpY2suYmluZCh0aGlzKTtcbiAgfVxuXG4gIGNvbXBvbmVudERpZE1vdW50KCkge1xuICAgIHRoaXMuX2ZldGNoTW9yZShQQUdFX1NJWkUpO1xuICB9XG5cbiAgYXN5bmMgX2ZldGNoTW9yZShjb3VudDogbnVtYmVyKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgY29uc3QgbmV4dCA9IGF3YWl0IHRoaXMucHJvcHMubW9kZWwuZ2V0RmlsZVJlZmVyZW5jZXMoXG4gICAgICB0aGlzLnN0YXRlLmZldGNoZWQsXG4gICAgICBQQUdFX1NJWkUsXG4gICAgKTtcbiAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgIGxvYWRpbmc6IGZhbHNlLFxuICAgICAgZmV0Y2hlZDogdGhpcy5zdGF0ZS5mZXRjaGVkICsgUEFHRV9TSVpFLFxuICAgICAgcmVmZXJlbmNlczogdGhpcy5zdGF0ZS5yZWZlcmVuY2VzLmNvbmNhdChuZXh0KSxcbiAgICB9KTtcbiAgfVxuXG4gIF9vblNjcm9sbChldnQ6IEV2ZW50KSB7XG4gICAgY29uc3Qgcm9vdCA9IHRoaXMucmVmcy5yb290O1xuICAgIGlmICh0aGlzLnN0YXRlLmxvYWRpbmcgfHwgcm9vdC5jbGllbnRIZWlnaHQgPj0gcm9vdC5zY3JvbGxIZWlnaHQpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgY29uc3Qgc2Nyb2xsQm90dG9tID0gcm9vdC5zY3JvbGxUb3AgKyByb290LmNsaWVudEhlaWdodDtcbiAgICBpZiAocm9vdC5zY3JvbGxIZWlnaHQgLSBzY3JvbGxCb3R0b20gPD0gU0NST0xMX0xPQURfVEhSRVNIT0xEKSB7XG4gICAgICB0aGlzLnNldFN0YXRlKHtsb2FkaW5nOiB0cnVlfSk7XG4gICAgICB0aGlzLl9mZXRjaE1vcmUoUEFHRV9TSVpFKTtcbiAgICB9XG4gIH1cblxuICBfY2hpbGRDbGljayhpOiBudW1iZXIpIHtcbiAgICB0aGlzLnNldFN0YXRlKHtzZWxlY3RlZDogdGhpcy5zdGF0ZS5zZWxlY3RlZCA9PT0gaSA/IC0xIDogaX0pO1xuICB9XG5cbiAgcmVuZGVyKCk6IFJlYWN0Lk5vZGUge1xuICAgIGNvbnN0IGNoaWxkcmVuID0gdGhpcy5zdGF0ZS5yZWZlcmVuY2VzLm1hcCgoZmlsZVJlZnMsIGkpID0+IChcbiAgICAgIDxGaWxlUmVmZXJlbmNlc1ZpZXdcbiAgICAgICAga2V5PXtpfVxuICAgICAgICBpc1NlbGVjdGVkPXt0aGlzLnN0YXRlLnNlbGVjdGVkID09PSBpfVxuICAgICAgICB7Li4uZmlsZVJlZnN9XG4gICAgICAgIGJhc2VQYXRoPXt0aGlzLnByb3BzLm1vZGVsLmdldEJhc2VQYXRoKCl9XG4gICAgICAgIGNsaWNrQ2FsbGJhY2s9eygpID0+IHRoaXMuX2NoaWxkQ2xpY2soaSl9XG4gICAgICAvPlxuICAgICkpO1xuXG4gICAgY29uc3QgcmVmQ291bnQgPSB0aGlzLnByb3BzLm1vZGVsLmdldFJlZmVyZW5jZUNvdW50KCk7XG4gICAgY29uc3QgZmlsZUNvdW50ID0gdGhpcy5wcm9wcy5tb2RlbC5nZXRGaWxlQ291bnQoKTtcbiAgICBpZiAodGhpcy5zdGF0ZS5mZXRjaGVkIDwgZmlsZUNvdW50KSB7XG4gICAgICBjaGlsZHJlbi5wdXNoKFxuICAgICAgICA8ZGl2XG4gICAgICAgICAga2V5PVwibG9hZGluZ1wiXG4gICAgICAgICAgY2xhc3NOYW1lPVwiZmluZC1yZWZlcmVuY2VzLWxvYWRpbmcgbG9hZGluZy1zcGlubmVyLW1lZGl1bVwiXG4gICAgICAgIC8+LFxuICAgICAgKTtcbiAgICB9XG5cbiAgICByZXR1cm4gKFxuICAgICAgPGRpdiBjbGFzc05hbWU9XCJmaW5kLXJlZmVyZW5jZXNcIj5cbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJmaW5kLXJlZmVyZW5jZXMtY291bnQgcGFuZWwtaGVhZGluZ1wiPlxuICAgICAgICAgIHtyZWZDb3VudH0ge3BsdXJhbGl6ZSgncmVmZXJlbmNlJywgcmVmQ291bnQpfSBmb3VuZCBpbiB7ZmlsZUNvdW50fXsnICd9XG4gICAgICAgICAge3BsdXJhbGl6ZSgnZmlsZScsIGZpbGVDb3VudCl9IGZvcnsnICd9XG4gICAgICAgICAgPHNwYW4gY2xhc3NOYW1lPVwiaGlnaGxpZ2h0LWluZm9cIj5cbiAgICAgICAgICAgIHt0aGlzLnByb3BzLm1vZGVsLmdldFN5bWJvbE5hbWUoKX1cbiAgICAgICAgICA8L3NwYW4+XG4gICAgICAgIDwvZGl2PlxuICAgICAgICA8dWxcbiAgICAgICAgICBjbGFzc05hbWU9XCJmaW5kLXJlZmVyZW5jZXMtZmlsZXMgbGlzdC10cmVlIGhhcy1jb2xsYXBzYWJsZS1jaGlsZHJlblwiXG4gICAgICAgICAgb25TY3JvbGw9e3RoaXMuX29uU2Nyb2xsfVxuICAgICAgICAgIHJlZj1cInJvb3RcIlxuICAgICAgICAgIHRhYkluZGV4PVwiMFwiPlxuICAgICAgICAgIHtjaGlsZHJlbn1cbiAgICAgICAgPC91bD5cbiAgICAgIDwvZGl2PlxuICAgICk7XG4gIH1cbn1cbiJdfQ==