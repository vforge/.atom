'use strict';

var cov_xtzwdbr98 = function () {
  var path = '/Users/hansonw/atom-ide-ui/modules/atom-ide-ui/pkg/hyperclick/lib/Hyperclick.js',
      hash = '6f8e10b62fd6c6b06e728d6361b6d027c8bb041d',
      global = new Function('return this')(),
      gcv = '__coverage__',
      coverageData = {
    path: '/Users/hansonw/atom-ide-ui/modules/atom-ide-ui/pkg/hyperclick/lib/Hyperclick.js',
    statementMap: {
      '0': {
        start: {
          line: 35,
          column: 4
        },
        end: {
          line: 35,
          column: 45
        }
      },
      '1': {
        start: {
          line: 37,
          column: 4
        },
        end: {
          line: 37,
          column: 48
        }
      },
      '2': {
        start: {
          line: 38,
          column: 4
        },
        end: {
          line: 38,
          column: 47
        }
      },
      '3': {
        start: {
          line: 39,
          column: 4
        },
        end: {
          line: 41,
          column: 6
        }
      },
      '4': {
        start: {
          line: 45,
          column: 36
        },
        end: {
          line: 48,
          column: 5
        }
      },
      '5': {
        start: {
          line: 49,
          column: 4
        },
        end: {
          line: 49,
          column: 64
        }
      },
      '6': {
        start: {
          line: 50,
          column: 23
        },
        end: {
          line: 53,
          column: 6
        }
      },
      '7': {
        start: {
          line: 51,
          column: 6
        },
        end: {
          line: 51,
          column: 40
        }
      },
      '8': {
        start: {
          line: 52,
          column: 6
        },
        end: {
          line: 52,
          column: 69
        }
      },
      '9': {
        start: {
          line: 54,
          column: 4
        },
        end: {
          line: 57,
          column: 6
        }
      },
      '10': {
        start: {
          line: 55,
          column: 36
        },
        end: {
          line: 55,
          column: 56
        }
      },
      '11': {
        start: {
          line: 61,
          column: 4
        },
        end: {
          line: 61,
          column: 32
        }
      },
      '12': {
        start: {
          line: 62,
          column: 4
        },
        end: {
          line: 62,
          column: 43
        }
      },
      '13': {
        start: {
          line: 63,
          column: 4
        },
        end: {
          line: 63,
          column: 79
        }
      },
      '14': {
        start: {
          line: 63,
          column: 57
        },
        end: {
          line: 63,
          column: 77
        }
      },
      '15': {
        start: {
          line: 64,
          column: 4
        },
        end: {
          line: 64,
          column: 43
        }
      },
      '16': {
        start: {
          line: 70,
          column: 4
        },
        end: {
          line: 74,
          column: 5
        }
      },
      '17': {
        start: {
          line: 71,
          column: 6
        },
        end: {
          line: 73,
          column: 8
        }
      },
      '18': {
        start: {
          line: 72,
          column: 29
        },
        end: {
          line: 72,
          column: 59
        }
      },
      '19': {
        start: {
          line: 75,
          column: 4
        },
        end: {
          line: 75,
          column: 49
        }
      },
      '20': {
        start: {
          line: 85,
          column: 4
        },
        end: {
          line: 113,
          column: 5
        }
      },
      '21': {
        start: {
          line: 89,
          column: 6
        },
        end: {
          line: 109,
          column: 7
        }
      },
      '22': {
        start: {
          line: 91,
          column: 8
        },
        end: {
          line: 91,
          column: 68
        }
      },
      '23': {
        start: {
          line: 92,
          column: 13
        },
        end: {
          line: 109,
          column: 7
        }
      },
      '24': {
        start: {
          line: 93,
          column: 22
        },
        end: {
          line: 93,
          column: 79
        }
      },
      '25': {
        start: {
          line: 94,
          column: 8
        },
        end: {
          line: 96,
          column: 9
        }
      },
      '26': {
        start: {
          line: 95,
          column: 10
        },
        end: {
          line: 95,
          column: 19
        }
      },
      '27': {
        start: {
          line: 97,
          column: 35
        },
        end: {
          line: 97,
          column: 40
        }
      },
      '28': {
        start: {
          line: 98,
          column: 8
        },
        end: {
          line: 98,
          column: 49
        }
      },
      '29': {
        start: {
          line: 100,
          column: 8
        },
        end: {
          line: 104,
          column: 10
        }
      },
      '30': {
        start: {
          line: 106,
          column: 8
        },
        end: {
          line: 108,
          column: 10
        }
      },
      '31': {
        start: {
          line: 110,
          column: 6
        },
        end: {
          line: 112,
          column: 7
        }
      },
      '32': {
        start: {
          line: 111,
          column: 8
        },
        end: {
          line: 111,
          column: 22
        }
      },
      '33': {
        start: {
          line: 120,
          column: 4
        },
        end: {
          line: 120,
          column: 54
        }
      }
    },
    fnMap: {
      '0': {
        name: '(anonymous_0)',
        decl: {
          start: {
            line: 34,
            column: 2
          },
          end: {
            line: 34,
            column: 3
          }
        },
        loc: {
          start: {
            line: 34,
            column: 16
          },
          end: {
            line: 42,
            column: 3
          }
        },
        line: 34
      },
      '1': {
        name: '(anonymous_1)',
        decl: {
          start: {
            line: 44,
            column: 2
          },
          end: {
            line: 44,
            column: 3
          }
        },
        loc: {
          start: {
            line: 44,
            column: 57
          },
          end: {
            line: 58,
            column: 3
          }
        },
        line: 44
      },
      '2': {
        name: '(anonymous_2)',
        decl: {
          start: {
            line: 50,
            column: 47
          },
          end: {
            line: 50,
            column: 48
          }
        },
        loc: {
          start: {
            line: 50,
            column: 53
          },
          end: {
            line: 53,
            column: 5
          }
        },
        line: 50
      },
      '3': {
        name: '(anonymous_3)',
        decl: {
          start: {
            line: 55,
            column: 30
          },
          end: {
            line: 55,
            column: 31
          }
        },
        loc: {
          start: {
            line: 55,
            column: 36
          },
          end: {
            line: 55,
            column: 56
          }
        },
        line: 55
      },
      '4': {
        name: '(anonymous_4)',
        decl: {
          start: {
            line: 60,
            column: 2
          },
          end: {
            line: 60,
            column: 3
          }
        },
        loc: {
          start: {
            line: 60,
            column: 12
          },
          end: {
            line: 65,
            column: 3
          }
        },
        line: 60
      },
      '5': {
        name: '(anonymous_5)',
        decl: {
          start: {
            line: 63,
            column: 43
          },
          end: {
            line: 63,
            column: 44
          }
        },
        loc: {
          start: {
            line: 63,
            column: 57
          },
          end: {
            line: 63,
            column: 77
          }
        },
        line: 63
      },
      '6': {
        name: '(anonymous_6)',
        decl: {
          start: {
            line: 67,
            column: 2
          },
          end: {
            line: 67,
            column: 3
          }
        },
        loc: {
          start: {
            line: 69,
            column: 17
          },
          end: {
            line: 76,
            column: 3
          }
        },
        line: 69
      },
      '7': {
        name: '(anonymous_7)',
        decl: {
          start: {
            line: 72,
            column: 24
          },
          end: {
            line: 72,
            column: 25
          }
        },
        loc: {
          start: {
            line: 72,
            column: 29
          },
          end: {
            line: 72,
            column: 59
          }
        },
        line: 72
      },
      '8': {
        name: '(anonymous_8)',
        decl: {
          start: {
            line: 81,
            column: 2
          },
          end: {
            line: 81,
            column: 3
          }
        },
        loc: {
          start: {
            line: 84,
            column: 36
          },
          end: {
            line: 114,
            column: 3
          }
        },
        line: 84
      },
      '9': {
        name: '(anonymous_9)',
        decl: {
          start: {
            line: 116,
            column: 2
          },
          end: {
            line: 116,
            column: 3
          }
        },
        loc: {
          start: {
            line: 119,
            column: 10
          },
          end: {
            line: 121,
            column: 3
          }
        },
        line: 119
      }
    },
    branchMap: {
      '0': {
        loc: {
          start: {
            line: 70,
            column: 4
          },
          end: {
            line: 74,
            column: 5
          }
        },
        type: 'if',
        locations: [{
          start: {
            line: 70,
            column: 4
          },
          end: {
            line: 74,
            column: 5
          }
        }, {
          start: {
            line: 70,
            column: 4
          },
          end: {
            line: 74,
            column: 5
          }
        }],
        line: 70
      },
      '1': {
        loc: {
          start: {
            line: 89,
            column: 6
          },
          end: {
            line: 109,
            column: 7
          }
        },
        type: 'if',
        locations: [{
          start: {
            line: 89,
            column: 6
          },
          end: {
            line: 109,
            column: 7
          }
        }, {
          start: {
            line: 89,
            column: 6
          },
          end: {
            line: 109,
            column: 7
          }
        }],
        line: 89
      },
      '2': {
        loc: {
          start: {
            line: 92,
            column: 13
          },
          end: {
            line: 109,
            column: 7
          }
        },
        type: 'if',
        locations: [{
          start: {
            line: 92,
            column: 13
          },
          end: {
            line: 109,
            column: 7
          }
        }, {
          start: {
            line: 92,
            column: 13
          },
          end: {
            line: 109,
            column: 7
          }
        }],
        line: 92
      },
      '3': {
        loc: {
          start: {
            line: 94,
            column: 8
          },
          end: {
            line: 96,
            column: 9
          }
        },
        type: 'if',
        locations: [{
          start: {
            line: 94,
            column: 8
          },
          end: {
            line: 96,
            column: 9
          }
        }, {
          start: {
            line: 94,
            column: 8
          },
          end: {
            line: 96,
            column: 9
          }
        }],
        line: 94
      },
      '4': {
        loc: {
          start: {
            line: 110,
            column: 6
          },
          end: {
            line: 112,
            column: 7
          }
        },
        type: 'if',
        locations: [{
          start: {
            line: 110,
            column: 6
          },
          end: {
            line: 112,
            column: 7
          }
        }, {
          start: {
            line: 110,
            column: 6
          },
          end: {
            line: 112,
            column: 7
          }
        }],
        line: 110
      }
    },
    s: {
      '0': 0,
      '1': 0,
      '2': 0,
      '3': 0,
      '4': 0,
      '5': 0,
      '6': 0,
      '7': 0,
      '8': 0,
      '9': 0,
      '10': 0,
      '11': 0,
      '12': 0,
      '13': 0,
      '14': 0,
      '15': 0,
      '16': 0,
      '17': 0,
      '18': 0,
      '19': 0,
      '20': 0,
      '21': 0,
      '22': 0,
      '23': 0,
      '24': 0,
      '25': 0,
      '26': 0,
      '27': 0,
      '28': 0,
      '29': 0,
      '30': 0,
      '31': 0,
      '32': 0,
      '33': 0
    },
    f: {
      '0': 0,
      '1': 0,
      '2': 0,
      '3': 0,
      '4': 0,
      '5': 0,
      '6': 0,
      '7': 0,
      '8': 0,
      '9': 0
    },
    b: {
      '0': [0, 0],
      '1': [0, 0],
      '2': [0, 0],
      '3': [0, 0],
      '4': [0, 0]
    },
    _coverageSchema: '332fd63041d2c1bcb487cc26dd0d5f7d97098a6c'
  },
      coverage = global[gcv] || (global[gcv] = {});

  if (coverage[path] && coverage[path].hash === hash) {
    return coverage[path];
  }

  coverageData.hash = hash;
  return coverage[path] = coverageData;
}();

Object.defineProperty(exports, "__esModule", {
  value: true
});

var _asyncToGenerator = _interopRequireDefault(require('async-to-generator'));

var _HyperclickForTextEditor;

function _load_HyperclickForTextEditor() {
  return _HyperclickForTextEditor = _interopRequireDefault(require('./HyperclickForTextEditor'));
}

var _SuggestionList;

function _load_SuggestionList() {
  return _SuggestionList = _interopRequireDefault(require('./SuggestionList'));
}

var _UniversalDisposable;

function _load_UniversalDisposable() {
  return _UniversalDisposable = _interopRequireDefault(require('nuclide-commons/UniversalDisposable'));
}

var _ProviderRegistry;

function _load_ProviderRegistry() {
  return _ProviderRegistry = _interopRequireDefault(require('nuclide-commons-atom/ProviderRegistry'));
}

var _textEditor;

function _load_textEditor() {
  return _textEditor = require('nuclide-commons-atom/text-editor');
}

var _range;

function _load_range() {
  return _range = require('nuclide-commons-atom/range');
}

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

/**
 * Construct this object to enable Hyperclick in the Atom workspace.
 * Call `dispose` to disable the feature.
 */
class Hyperclick {

  constructor() {
    cov_xtzwdbr98.f[0]++;
    cov_xtzwdbr98.s[0]++;

    this._providers = new (_ProviderRegistry || _load_ProviderRegistry()).default();

    cov_xtzwdbr98.s[1]++;
    this._suggestionList = new (_SuggestionList || _load_SuggestionList()).default();
    cov_xtzwdbr98.s[2]++;
    this._hyperclickForTextEditors = new Set();
    cov_xtzwdbr98.s[3]++;
    this._textEditorSubscription = (0, (_textEditor || _load_textEditor()).observeTextEditors)(this.observeTextEditor.bind(this));
  }

  observeTextEditor(textEditor) {
    cov_xtzwdbr98.f[1]++;

    const hyperclickForTextEditor = (cov_xtzwdbr98.s[4]++, new (_HyperclickForTextEditor || _load_HyperclickForTextEditor()).default(textEditor, this));
    cov_xtzwdbr98.s[5]++;
    this._hyperclickForTextEditors.add(hyperclickForTextEditor);
    const disposable = (cov_xtzwdbr98.s[6]++, new (_UniversalDisposable || _load_UniversalDisposable()).default(() => {
      cov_xtzwdbr98.f[2]++;
      cov_xtzwdbr98.s[7]++;

      hyperclickForTextEditor.dispose();
      cov_xtzwdbr98.s[8]++;
      this._hyperclickForTextEditors.delete(hyperclickForTextEditor);
    }));
    cov_xtzwdbr98.s[9]++;
    return new (_UniversalDisposable || _load_UniversalDisposable()).default(textEditor.onDidDestroy(() => {
      cov_xtzwdbr98.f[3]++;
      cov_xtzwdbr98.s[10]++;
      return disposable.dispose();
    }), disposable);
  }

  dispose() {
    cov_xtzwdbr98.f[4]++;
    cov_xtzwdbr98.s[11]++;

    this._suggestionList.hide();
    cov_xtzwdbr98.s[12]++;
    this._textEditorSubscription.dispose();
    cov_xtzwdbr98.s[13]++;
    this._hyperclickForTextEditors.forEach(hyperclick => {
      cov_xtzwdbr98.f[5]++;
      cov_xtzwdbr98.s[14]++;
      return hyperclick.dispose();
    });
    cov_xtzwdbr98.s[15]++;
    this._hyperclickForTextEditors.clear();
  }

  addProvider(provider) {
    cov_xtzwdbr98.f[6]++;
    cov_xtzwdbr98.s[16]++;

    if (Array.isArray(provider)) {
      cov_xtzwdbr98.b[0][0]++;
      cov_xtzwdbr98.s[17]++;

      return new (_UniversalDisposable || _load_UniversalDisposable()).default(...provider.map(p => {
        cov_xtzwdbr98.f[7]++;
        cov_xtzwdbr98.s[18]++;
        return this._providers.addProvider(p);
      }));
    } else {
      cov_xtzwdbr98.b[0][1]++;
    }
    cov_xtzwdbr98.s[19]++;
    return this._providers.addProvider(provider);
  }

  /**
   * Returns the first suggestion from the consumed providers.
   */
  getSuggestion(textEditor, position) {
    var _this = this;

    return (0, _asyncToGenerator.default)(function* () {
      cov_xtzwdbr98.f[8]++;
      cov_xtzwdbr98.s[20]++;

      for (const provider of _this._providers.getAllProvidersForEditor(textEditor)) {
        let result;
        cov_xtzwdbr98.s[21]++;
        if (provider.getSuggestion) {
          cov_xtzwdbr98.b[1][0]++;
          cov_xtzwdbr98.s[22]++;

          // eslint-disable-next-line no-await-in-loop
          result = yield provider.getSuggestion(textEditor, position);
        } else {
            cov_xtzwdbr98.b[1][1]++;
            cov_xtzwdbr98.s[23]++;
            if (provider.getSuggestionForWord) {
              cov_xtzwdbr98.b[2][0]++;

              const match = (cov_xtzwdbr98.s[24]++, (0, (_range || _load_range()).wordAtPosition)(textEditor, position, provider.wordRegExp));
              cov_xtzwdbr98.s[25]++;
              if (match == null) {
                cov_xtzwdbr98.b[3][0]++;
                cov_xtzwdbr98.s[26]++;

                continue;
              } else {
                cov_xtzwdbr98.b[3][1]++;
              }
              const { wordMatch, range } = (cov_xtzwdbr98.s[27]++, match);
              cov_xtzwdbr98.s[28]++;

              if (!provider.getSuggestionForWord) {
                throw new Error('Invariant violation: "provider.getSuggestionForWord"');
              }
              // eslint-disable-next-line no-await-in-loop


              cov_xtzwdbr98.s[29]++;
              result = yield provider.getSuggestionForWord(textEditor, wordMatch[0], range);
            } else {
              cov_xtzwdbr98.b[2][1]++;
              cov_xtzwdbr98.s[30]++;

              throw new Error('Hyperclick must have either `getSuggestion` or `getSuggestionForWord`');
            }
          }cov_xtzwdbr98.s[31]++;
        if (result != null) {
          cov_xtzwdbr98.b[4][0]++;
          cov_xtzwdbr98.s[32]++;

          return result;
        } else {
          cov_xtzwdbr98.b[4][1]++;
        }
      }
    })();
  }

  showSuggestionList(textEditor, suggestion) {
    cov_xtzwdbr98.f[9]++;
    cov_xtzwdbr98.s[33]++;

    this._suggestionList.show(textEditor, suggestion);
  }
}
exports.default = Hyperclick; /**
                               * Copyright (c) 2017-present, Facebook, Inc.
                               * All rights reserved.
                               *
                               * This source code is licensed under the BSD-style license found in the
                               * LICENSE file in the root directory of this source tree. An additional grant
                               * of patent rights can be found in the PATENTS file in the same directory.
                               *
                               * 
                               * @format
                               */
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkh5cGVyY2xpY2suanMiXSwibmFtZXMiOlsiSHlwZXJjbGljayIsImNvbnN0cnVjdG9yIiwiX3Byb3ZpZGVycyIsIl9zdWdnZXN0aW9uTGlzdCIsIl9oeXBlcmNsaWNrRm9yVGV4dEVkaXRvcnMiLCJTZXQiLCJfdGV4dEVkaXRvclN1YnNjcmlwdGlvbiIsIm9ic2VydmVUZXh0RWRpdG9yIiwiYmluZCIsInRleHRFZGl0b3IiLCJoeXBlcmNsaWNrRm9yVGV4dEVkaXRvciIsImFkZCIsImRpc3Bvc2FibGUiLCJkaXNwb3NlIiwiZGVsZXRlIiwib25EaWREZXN0cm95IiwiaGlkZSIsImZvckVhY2giLCJoeXBlcmNsaWNrIiwiY2xlYXIiLCJhZGRQcm92aWRlciIsInByb3ZpZGVyIiwiQXJyYXkiLCJpc0FycmF5IiwibWFwIiwicCIsImdldFN1Z2dlc3Rpb24iLCJwb3NpdGlvbiIsImdldEFsbFByb3ZpZGVyc0ZvckVkaXRvciIsInJlc3VsdCIsImdldFN1Z2dlc3Rpb25Gb3JXb3JkIiwibWF0Y2giLCJ3b3JkUmVnRXhwIiwid29yZE1hdGNoIiwicmFuZ2UiLCJFcnJvciIsInNob3dTdWdnZXN0aW9uTGlzdCIsInN1Z2dlc3Rpb24iLCJzaG93Il0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBY0E7QUFBQTtBQUFBOzs7O0FBQ0E7QUFBQTtBQUFBOzs7O0FBR0E7QUFBQTtBQUFBOzs7O0FBQ0E7QUFBQTtBQUFBOzs7O0FBQ0E7QUFBQTtBQUFBOzs7O0FBQ0E7QUFBQTtBQUFBOzs7O0FBRUE7Ozs7QUFJZSxNQUFNQSxVQUFOLENBQWlCOztBQU05QkMsZ0JBQWM7QUFBQTtBQUFBOztBQUNaLFNBQUtDLFVBQUwsR0FBa0IsNkRBQWxCOztBQURZO0FBR1osU0FBS0MsZUFBTCxHQUF1Qix5REFBdkI7QUFIWTtBQUlaLFNBQUtDLHlCQUFMLEdBQWlDLElBQUlDLEdBQUosRUFBakM7QUFKWTtBQUtaLFNBQUtDLHVCQUFMLEdBQStCLDREQUM3QixLQUFLQyxpQkFBTCxDQUF1QkMsSUFBdkIsQ0FBNEIsSUFBNUIsQ0FENkIsQ0FBL0I7QUFHRDs7QUFFREQsb0JBQWtCRSxVQUFsQixFQUF1RDtBQUFBOztBQUNyRCxVQUFNQyxpREFBMEIsMEVBQzlCRCxVQUQ4QixFQUU5QixJQUY4QixDQUExQixDQUFOO0FBRHFEO0FBS3JELFNBQUtMLHlCQUFMLENBQStCTyxHQUEvQixDQUFtQ0QsdUJBQW5DO0FBQ0EsVUFBTUUsb0NBQWEsa0VBQXdCLE1BQU07QUFBQTtBQUFBOztBQUMvQ0YsOEJBQXdCRyxPQUF4QjtBQUQrQztBQUUvQyxXQUFLVCx5QkFBTCxDQUErQlUsTUFBL0IsQ0FBc0NKLHVCQUF0QztBQUNELEtBSGtCLENBQWIsQ0FBTjtBQU5xRDtBQVVyRCxXQUFPLGtFQUNMRCxXQUFXTSxZQUFYLENBQXdCLE1BQU07QUFBQTtBQUFBO0FBQUEsd0JBQVdGLE9BQVg7QUFBb0IsS0FBbEQsQ0FESyxFQUVMRCxVQUZLLENBQVA7QUFJRDs7QUFFREMsWUFBVTtBQUFBO0FBQUE7O0FBQ1IsU0FBS1YsZUFBTCxDQUFxQmEsSUFBckI7QUFEUTtBQUVSLFNBQUtWLHVCQUFMLENBQTZCTyxPQUE3QjtBQUZRO0FBR1IsU0FBS1QseUJBQUwsQ0FBK0JhLE9BQS9CLENBQXVDQyxjQUFjO0FBQUE7QUFBQTtBQUFBLHdCQUFXTCxPQUFYO0FBQW9CLEtBQXpFO0FBSFE7QUFJUixTQUFLVCx5QkFBTCxDQUErQmUsS0FBL0I7QUFDRDs7QUFFREMsY0FDRUMsUUFERixFQUVlO0FBQUE7QUFBQTs7QUFDYixRQUFJQyxNQUFNQyxPQUFOLENBQWNGLFFBQWQsQ0FBSixFQUE2QjtBQUFBO0FBQUE7O0FBQzNCLGFBQU8sa0VBQ0wsR0FBR0EsU0FBU0csR0FBVCxDQUFhQyxLQUFLO0FBQUE7QUFBQTtBQUFBLG9CQUFLdkIsVUFBTCxDQUFnQmtCLFdBQWhCLENBQTRCSyxDQUE1QjtBQUE4QixPQUFoRCxDQURFLENBQVA7QUFHRCxLQUpEO0FBQUE7QUFBQTtBQURhO0FBTWIsV0FBTyxLQUFLdkIsVUFBTCxDQUFnQmtCLFdBQWhCLENBQTRCQyxRQUE1QixDQUFQO0FBQ0Q7O0FBRUQ7OztBQUdNSyxlQUFOLENBQ0VqQixVQURGLEVBRUVrQixRQUZGLEVBR2tDO0FBQUE7O0FBQUE7QUFBQTtBQUFBOztBQUNoQyxXQUFLLE1BQU1OLFFBQVgsSUFBdUIsTUFBS25CLFVBQUwsQ0FBZ0IwQix3QkFBaEIsQ0FDckJuQixVQURxQixDQUF2QixFQUVHO0FBQ0QsWUFBSW9CLE1BQUo7QUFEQztBQUVELFlBQUlSLFNBQVNLLGFBQWIsRUFBNEI7QUFBQTtBQUFBOztBQUMxQjtBQUNBRyxtQkFBUyxNQUFNUixTQUFTSyxhQUFULENBQXVCakIsVUFBdkIsRUFBbUNrQixRQUFuQyxDQUFmO0FBQ0QsU0FIRCxNQUdPO0FBQUE7QUFBQTtBQUFBLGdCQUFJTixTQUFTUyxvQkFBYixFQUFtQztBQUFBOztBQUN4QyxvQkFBTUMsZ0NBQVEsOENBQWV0QixVQUFmLEVBQTJCa0IsUUFBM0IsRUFBcUNOLFNBQVNXLFVBQTlDLENBQVIsQ0FBTjtBQUR3QztBQUV4QyxrQkFBSUQsU0FBUyxJQUFiLEVBQW1CO0FBQUE7QUFBQTs7QUFDakI7QUFDRCxlQUZEO0FBQUE7QUFBQTtBQUdBLG9CQUFNLEVBQUNFLFNBQUQsRUFBWUMsS0FBWiw2QkFBcUJILEtBQXJCLENBQU47QUFMd0M7O0FBQUEsbUJBTTlCVixTQUFTUyxvQkFOcUI7QUFBQTtBQUFBO0FBT3hDOzs7QUFQd0M7QUFReENELHVCQUFTLE1BQU1SLFNBQVNTLG9CQUFULENBQ2JyQixVQURhLEVBRWJ3QixVQUFVLENBQVYsQ0FGYSxFQUdiQyxLQUhhLENBQWY7QUFLRCxhQWJNLE1BYUE7QUFBQTtBQUFBOztBQUNMLG9CQUFNLElBQUlDLEtBQUosQ0FDSix1RUFESSxDQUFOO0FBR0Q7QUFBQSxXQXRCQTtBQXVCRCxZQUFJTixVQUFVLElBQWQsRUFBb0I7QUFBQTtBQUFBOztBQUNsQixpQkFBT0EsTUFBUDtBQUNELFNBRkQ7QUFBQTtBQUFBO0FBR0Q7QUE3QitCO0FBOEJqQzs7QUFFRE8scUJBQ0UzQixVQURGLEVBRUU0QixVQUZGLEVBR1E7QUFBQTtBQUFBOztBQUNOLFNBQUtsQyxlQUFMLENBQXFCbUMsSUFBckIsQ0FBMEI3QixVQUExQixFQUFzQzRCLFVBQXRDO0FBQ0Q7QUE3RjZCO2tCQUFYckMsVSxFQTNCckIiLCJmaWxlIjoiSHlwZXJjbGljay5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogQ29weXJpZ2h0IChjKSAyMDE3LXByZXNlbnQsIEZhY2Vib29rLCBJbmMuXG4gKiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuICpcbiAqIFRoaXMgc291cmNlIGNvZGUgaXMgbGljZW5zZWQgdW5kZXIgdGhlIEJTRC1zdHlsZSBsaWNlbnNlIGZvdW5kIGluIHRoZVxuICogTElDRU5TRSBmaWxlIGluIHRoZSByb290IGRpcmVjdG9yeSBvZiB0aGlzIHNvdXJjZSB0cmVlLiBBbiBhZGRpdGlvbmFsIGdyYW50XG4gKiBvZiBwYXRlbnQgcmlnaHRzIGNhbiBiZSBmb3VuZCBpbiB0aGUgUEFURU5UUyBmaWxlIGluIHRoZSBzYW1lIGRpcmVjdG9yeS5cbiAqXG4gKiBAZmxvd1xuICogQGZvcm1hdFxuICovXG5cbmltcG9ydCB0eXBlIHtIeXBlcmNsaWNrU3VnZ2VzdGlvbiwgSHlwZXJjbGlja1Byb3ZpZGVyfSBmcm9tICcuL3R5cGVzJztcblxuaW1wb3J0IEh5cGVyY2xpY2tGb3JUZXh0RWRpdG9yIGZyb20gJy4vSHlwZXJjbGlja0ZvclRleHRFZGl0b3InO1xuaW1wb3J0IFN1Z2dlc3Rpb25MaXN0IGZyb20gJy4vU3VnZ2VzdGlvbkxpc3QnO1xuXG5pbXBvcnQgaW52YXJpYW50IGZyb20gJ2Fzc2VydCc7XG5pbXBvcnQgVW5pdmVyc2FsRGlzcG9zYWJsZSBmcm9tICdudWNsaWRlLWNvbW1vbnMvVW5pdmVyc2FsRGlzcG9zYWJsZSc7XG5pbXBvcnQgUHJvdmlkZXJSZWdpc3RyeSBmcm9tICdudWNsaWRlLWNvbW1vbnMtYXRvbS9Qcm92aWRlclJlZ2lzdHJ5JztcbmltcG9ydCB7b2JzZXJ2ZVRleHRFZGl0b3JzfSBmcm9tICdudWNsaWRlLWNvbW1vbnMtYXRvbS90ZXh0LWVkaXRvcic7XG5pbXBvcnQge3dvcmRBdFBvc2l0aW9ufSBmcm9tICdudWNsaWRlLWNvbW1vbnMtYXRvbS9yYW5nZSc7XG5cbi8qKlxuICogQ29uc3RydWN0IHRoaXMgb2JqZWN0IHRvIGVuYWJsZSBIeXBlcmNsaWNrIGluIHRoZSBBdG9tIHdvcmtzcGFjZS5cbiAqIENhbGwgYGRpc3Bvc2VgIHRvIGRpc2FibGUgdGhlIGZlYXR1cmUuXG4gKi9cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEh5cGVyY2xpY2sge1xuICBfcHJvdmlkZXJzOiBQcm92aWRlclJlZ2lzdHJ5PEh5cGVyY2xpY2tQcm92aWRlcj47XG4gIF9zdWdnZXN0aW9uTGlzdDogU3VnZ2VzdGlvbkxpc3Q7XG4gIF9oeXBlcmNsaWNrRm9yVGV4dEVkaXRvcnM6IFNldDxIeXBlcmNsaWNrRm9yVGV4dEVkaXRvcj47XG4gIF90ZXh0RWRpdG9yU3Vic2NyaXB0aW9uOiBJRGlzcG9zYWJsZTtcblxuICBjb25zdHJ1Y3RvcigpIHtcbiAgICB0aGlzLl9wcm92aWRlcnMgPSBuZXcgUHJvdmlkZXJSZWdpc3RyeSgpO1xuXG4gICAgdGhpcy5fc3VnZ2VzdGlvbkxpc3QgPSBuZXcgU3VnZ2VzdGlvbkxpc3QoKTtcbiAgICB0aGlzLl9oeXBlcmNsaWNrRm9yVGV4dEVkaXRvcnMgPSBuZXcgU2V0KCk7XG4gICAgdGhpcy5fdGV4dEVkaXRvclN1YnNjcmlwdGlvbiA9IG9ic2VydmVUZXh0RWRpdG9ycyhcbiAgICAgIHRoaXMub2JzZXJ2ZVRleHRFZGl0b3IuYmluZCh0aGlzKSxcbiAgICApO1xuICB9XG5cbiAgb2JzZXJ2ZVRleHRFZGl0b3IodGV4dEVkaXRvcjogVGV4dEVkaXRvcik6IElEaXNwb3NhYmxlIHtcbiAgICBjb25zdCBoeXBlcmNsaWNrRm9yVGV4dEVkaXRvciA9IG5ldyBIeXBlcmNsaWNrRm9yVGV4dEVkaXRvcihcbiAgICAgIHRleHRFZGl0b3IsXG4gICAgICB0aGlzLFxuICAgICk7XG4gICAgdGhpcy5faHlwZXJjbGlja0ZvclRleHRFZGl0b3JzLmFkZChoeXBlcmNsaWNrRm9yVGV4dEVkaXRvcik7XG4gICAgY29uc3QgZGlzcG9zYWJsZSA9IG5ldyBVbml2ZXJzYWxEaXNwb3NhYmxlKCgpID0+IHtcbiAgICAgIGh5cGVyY2xpY2tGb3JUZXh0RWRpdG9yLmRpc3Bvc2UoKTtcbiAgICAgIHRoaXMuX2h5cGVyY2xpY2tGb3JUZXh0RWRpdG9ycy5kZWxldGUoaHlwZXJjbGlja0ZvclRleHRFZGl0b3IpO1xuICAgIH0pO1xuICAgIHJldHVybiBuZXcgVW5pdmVyc2FsRGlzcG9zYWJsZShcbiAgICAgIHRleHRFZGl0b3Iub25EaWREZXN0cm95KCgpID0+IGRpc3Bvc2FibGUuZGlzcG9zZSgpKSxcbiAgICAgIGRpc3Bvc2FibGUsXG4gICAgKTtcbiAgfVxuXG4gIGRpc3Bvc2UoKSB7XG4gICAgdGhpcy5fc3VnZ2VzdGlvbkxpc3QuaGlkZSgpO1xuICAgIHRoaXMuX3RleHRFZGl0b3JTdWJzY3JpcHRpb24uZGlzcG9zZSgpO1xuICAgIHRoaXMuX2h5cGVyY2xpY2tGb3JUZXh0RWRpdG9ycy5mb3JFYWNoKGh5cGVyY2xpY2sgPT4gaHlwZXJjbGljay5kaXNwb3NlKCkpO1xuICAgIHRoaXMuX2h5cGVyY2xpY2tGb3JUZXh0RWRpdG9ycy5jbGVhcigpO1xuICB9XG5cbiAgYWRkUHJvdmlkZXIoXG4gICAgcHJvdmlkZXI6IEh5cGVyY2xpY2tQcm92aWRlciB8IEFycmF5PEh5cGVyY2xpY2tQcm92aWRlcj4sXG4gICk6IElEaXNwb3NhYmxlIHtcbiAgICBpZiAoQXJyYXkuaXNBcnJheShwcm92aWRlcikpIHtcbiAgICAgIHJldHVybiBuZXcgVW5pdmVyc2FsRGlzcG9zYWJsZShcbiAgICAgICAgLi4ucHJvdmlkZXIubWFwKHAgPT4gdGhpcy5fcHJvdmlkZXJzLmFkZFByb3ZpZGVyKHApKSxcbiAgICAgICk7XG4gICAgfVxuICAgIHJldHVybiB0aGlzLl9wcm92aWRlcnMuYWRkUHJvdmlkZXIocHJvdmlkZXIpO1xuICB9XG5cbiAgLyoqXG4gICAqIFJldHVybnMgdGhlIGZpcnN0IHN1Z2dlc3Rpb24gZnJvbSB0aGUgY29uc3VtZWQgcHJvdmlkZXJzLlxuICAgKi9cbiAgYXN5bmMgZ2V0U3VnZ2VzdGlvbihcbiAgICB0ZXh0RWRpdG9yOiBUZXh0RWRpdG9yLFxuICAgIHBvc2l0aW9uOiBhdG9tJFBvaW50LFxuICApOiBQcm9taXNlPD9IeXBlcmNsaWNrU3VnZ2VzdGlvbj4ge1xuICAgIGZvciAoY29uc3QgcHJvdmlkZXIgb2YgdGhpcy5fcHJvdmlkZXJzLmdldEFsbFByb3ZpZGVyc0ZvckVkaXRvcihcbiAgICAgIHRleHRFZGl0b3IsXG4gICAgKSkge1xuICAgICAgbGV0IHJlc3VsdDtcbiAgICAgIGlmIChwcm92aWRlci5nZXRTdWdnZXN0aW9uKSB7XG4gICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1hd2FpdC1pbi1sb29wXG4gICAgICAgIHJlc3VsdCA9IGF3YWl0IHByb3ZpZGVyLmdldFN1Z2dlc3Rpb24odGV4dEVkaXRvciwgcG9zaXRpb24pO1xuICAgICAgfSBlbHNlIGlmIChwcm92aWRlci5nZXRTdWdnZXN0aW9uRm9yV29yZCkge1xuICAgICAgICBjb25zdCBtYXRjaCA9IHdvcmRBdFBvc2l0aW9uKHRleHRFZGl0b3IsIHBvc2l0aW9uLCBwcm92aWRlci53b3JkUmVnRXhwKTtcbiAgICAgICAgaWYgKG1hdGNoID09IG51bGwpIHtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCB7d29yZE1hdGNoLCByYW5nZX0gPSBtYXRjaDtcbiAgICAgICAgaW52YXJpYW50KHByb3ZpZGVyLmdldFN1Z2dlc3Rpb25Gb3JXb3JkKTtcbiAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLWF3YWl0LWluLWxvb3BcbiAgICAgICAgcmVzdWx0ID0gYXdhaXQgcHJvdmlkZXIuZ2V0U3VnZ2VzdGlvbkZvcldvcmQoXG4gICAgICAgICAgdGV4dEVkaXRvcixcbiAgICAgICAgICB3b3JkTWF0Y2hbMF0sXG4gICAgICAgICAgcmFuZ2UsXG4gICAgICAgICk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXG4gICAgICAgICAgJ0h5cGVyY2xpY2sgbXVzdCBoYXZlIGVpdGhlciBgZ2V0U3VnZ2VzdGlvbmAgb3IgYGdldFN1Z2dlc3Rpb25Gb3JXb3JkYCcsXG4gICAgICAgICk7XG4gICAgICB9XG4gICAgICBpZiAocmVzdWx0ICE9IG51bGwpIHtcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBzaG93U3VnZ2VzdGlvbkxpc3QoXG4gICAgdGV4dEVkaXRvcjogVGV4dEVkaXRvcixcbiAgICBzdWdnZXN0aW9uOiBIeXBlcmNsaWNrU3VnZ2VzdGlvbixcbiAgKTogdm9pZCB7XG4gICAgdGhpcy5fc3VnZ2VzdGlvbkxpc3Quc2hvdyh0ZXh0RWRpdG9yLCBzdWdnZXN0aW9uKTtcbiAgfVxufVxuIl19