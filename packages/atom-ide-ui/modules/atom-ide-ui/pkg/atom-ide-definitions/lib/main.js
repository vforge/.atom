'use strict';

var cov_12q2q673xn = function () {
  var path = '/Users/hansonw/atom-ide-ui/modules/atom-ide-ui/pkg/atom-ide-definitions/lib/main.js',
      hash = '327ac49162cf7bd2e66a190441a3485c6ccda79e',
      global = new Function('return this')(),
      gcv = '__coverage__',
      coverageData = {
    path: '/Users/hansonw/atom-ide-ui/modules/atom-ide-ui/pkg/atom-ide-definitions/lib/main.js',
    statementMap: {
      '0': {
        start: {
          line: 58,
          column: 4
        },
        end: {
          line: 58,
          column: 45
        }
      },
      '1': {
        start: {
          line: 59,
          column: 4
        },
        end: {
          line: 59,
          column: 50
        }
      },
      '2': {
        start: {
          line: 60,
          column: 4
        },
        end: {
          line: 60,
          column: 34
        }
      },
      '3': {
        start: {
          line: 62,
          column: 4
        },
        end: {
          line: 72,
          column: 6
        }
      },
      '4': {
        start: {
          line: 66,
          column: 10
        },
        end: {
          line: 69,
          column: 23
        }
      },
      '5': {
        start: {
          line: 76,
          column: 4
        },
        end: {
          line: 76,
          column: 32
        }
      },
      '6': {
        start: {
          line: 83,
          column: 4
        },
        end: {
          line: 104,
          column: 5
        }
      },
      '7': {
        start: {
          line: 84,
          column: 6
        },
        end: {
          line: 103,
          column: 7
        }
      },
      '8': {
        start: {
          line: 86,
          column: 23
        },
        end: {
          line: 86,
          column: 69
        }
      },
      '9': {
        start: {
          line: 87,
          column: 8
        },
        end: {
          line: 97,
          column: 9
        }
      },
      '10': {
        start: {
          line: 88,
          column: 10
        },
        end: {
          line: 95,
          column: 11
        }
      },
      '11': {
        start: {
          line: 89,
          column: 26
        },
        end: {
          line: 91,
          column: 14
        }
      },
      '12': {
        start: {
          line: 92,
          column: 12
        },
        end: {
          line: 94,
          column: 14
        }
      },
      '13': {
        start: {
          line: 96,
          column: 10
        },
        end: {
          line: 96,
          column: 24
        }
      },
      '14': {
        start: {
          line: 99,
          column: 8
        },
        end: {
          line: 102,
          column: 10
        }
      },
      '15': {
        start: {
          line: 105,
          column: 4
        },
        end: {
          line: 105,
          column: 16
        }
      },
      '16': {
        start: {
          line: 112,
          column: 19
        },
        end: {
          line: 114,
          column: 5
        }
      },
      '17': {
        start: {
          line: 113,
          column: 6
        },
        end: {
          line: 113,
          column: 43
        }
      },
      '18': {
        start: {
          line: 116,
          column: 4
        },
        end: {
          line: 118,
          column: 5
        }
      },
      '19': {
        start: {
          line: 117,
          column: 6
        },
        end: {
          line: 117,
          column: 18
        }
      },
      '20': {
        start: {
          line: 120,
          column: 38
        },
        end: {
          line: 120,
          column: 44
        }
      },
      '21': {
        start: {
          line: 121,
          column: 4
        },
        end: {
          line: 121,
          column: 38
        }
      },
      '22': {
        start: {
          line: 124,
          column: 4
        },
        end: {
          line: 124,
          column: 34
        }
      },
      '23': {
        start: {
          line: 127,
          column: 6
        },
        end: {
          line: 132,
          column: 8
        }
      },
      '24': {
        start: {
          line: 128,
          column: 8
        },
        end: {
          line: 131,
          column: 11
        }
      },
      '25': {
        start: {
          line: 137,
          column: 8
        },
        end: {
          line: 139,
          column: 72
        }
      },
      '26': {
        start: {
          line: 140,
          column: 6
        },
        end: {
          line: 143,
          column: 7
        }
      },
      '27': {
        start: {
          line: 142,
          column: 8
        },
        end: {
          line: 142,
          column: 60
        }
      },
      '28': {
        start: {
          line: 144,
          column: 6
        },
        end: {
          line: 144,
          column: 48
        }
      },
      '29': {
        start: {
          line: 147,
          column: 4
        },
        end: {
          line: 162,
          column: 5
        }
      },
      '30': {
        start: {
          line: 148,
          column: 6
        },
        end: {
          line: 151,
          column: 8
        }
      },
      '31': {
        start: {
          line: 153,
          column: 6
        },
        end: {
          line: 161,
          column: 8
        }
      },
      '32': {
        start: {
          line: 156,
          column: 10
        },
        end: {
          line: 159,
          column: 12
        }
      },
      '33': {
        start: {
          line: 170,
          column: 4
        },
        end: {
          line: 176,
          column: 5
        }
      },
      '34': {
        start: {
          line: 173,
          column: 50
        },
        end: {
          line: 173,
          column: 67
        }
      },
      '35': {
        start: {
          line: 175,
          column: 6
        },
        end: {
          line: 175,
          column: 13
        }
      },
      '36': {
        start: {
          line: 178,
          column: 19
        },
        end: {
          line: 178,
          column: 62
        }
      },
      '37': {
        start: {
          line: 179,
          column: 4
        },
        end: {
          line: 181,
          column: 5
        }
      },
      '38': {
        start: {
          line: 180,
          column: 6
        },
        end: {
          line: 180,
          column: 18
        }
      },
      '39': {
        start: {
          line: 182,
          column: 23
        },
        end: {
          line: 182,
          column: 40
        }
      },
      '40': {
        start: {
          line: 185,
          column: 4
        },
        end: {
          line: 185,
          column: 34
        }
      },
      '41': {
        start: {
          line: 187,
          column: 20
        },
        end: {
          line: 187,
          column: 39
        }
      },
      '42': {
        start: {
          line: 188,
          column: 27
        },
        end: {
          line: 193,
          column: 5
        }
      },
      '43': {
        start: {
          line: 196,
          column: 4
        },
        end: {
          line: 201,
          column: 5
        }
      },
      '44': {
        start: {
          line: 197,
          column: 6
        },
        end: {
          line: 200,
          column: 9
        }
      },
      '45': {
        start: {
          line: 203,
          column: 4
        },
        end: {
          line: 203,
          column: 26
        }
      },
      '46': {
        start: {
          line: 207,
          column: 23
        },
        end: {
          line: 207,
          column: 60
        }
      },
      '47': {
        start: {
          line: 208,
          column: 4
        },
        end: {
          line: 208,
          column: 38
        }
      },
      '48': {
        start: {
          line: 209,
          column: 4
        },
        end: {
          line: 209,
          column: 22
        }
      },
      '49': {
        start: {
          line: 213,
          column: 4
        },
        end: {
          line: 213,
          column: 47
        }
      },
      '50': {
        start: {
          line: 217,
          column: 53
        },
        end: {
          line: 225,
          column: 5
        }
      },
      '51': {
        start: {
          line: 224,
          column: 11
        },
        end: {
          line: 224,
          column: 60
        }
      },
      '52': {
        start: {
          line: 227,
          column: 23
        },
        end: {
          line: 227,
          column: 67
        }
      },
      '53': {
        start: {
          line: 228,
          column: 4
        },
        end: {
          line: 228,
          column: 38
        }
      },
      '54': {
        start: {
          line: 229,
          column: 4
        },
        end: {
          line: 229,
          column: 22
        }
      },
      '55': {
        start: {
          line: 233,
          column: 4
        },
        end: {
          line: 237,
          column: 6
        }
      },
      '56': {
        start: {
          line: 236,
          column: 43
        },
        end: {
          line: 236,
          column: 79
        }
      },
      '57': {
        start: {
          line: 242,
          column: 2
        },
        end: {
          line: 246,
          column: 3
        }
      },
      '58': {
        start: {
          line: 243,
          column: 4
        },
        end: {
          line: 243,
          column: 42
        }
      },
      '59': {
        start: {
          line: 244,
          column: 9
        },
        end: {
          line: 246,
          column: 3
        }
      },
      '60': {
        start: {
          line: 245,
          column: 4
        },
        end: {
          line: 245,
          column: 41
        }
      },
      '61': {
        start: {
          line: 247,
          column: 2
        },
        end: {
          line: 247,
          column: 39
        }
      },
      '62': {
        start: {
          line: 250,
          column: 0
        },
        end: {
          line: 250,
          column: 42
        }
      }
    },
    fnMap: {
      '0': {
        name: '(anonymous_0)',
        decl: {
          start: {
            line: 57,
            column: 2
          },
          end: {
            line: 57,
            column: 3
          }
        },
        loc: {
          start: {
            line: 57,
            column: 16
          },
          end: {
            line: 73,
            column: 3
          }
        },
        line: 57
      },
      '1': {
        name: '(anonymous_1)',
        decl: {
          start: {
            line: 65,
            column: 8
          },
          end: {
            line: 65,
            column: 9
          }
        },
        loc: {
          start: {
            line: 65,
            column: 31
          },
          end: {
            line: 70,
            column: 9
          }
        },
        line: 65
      },
      '2': {
        name: '(anonymous_2)',
        decl: {
          start: {
            line: 75,
            column: 2
          },
          end: {
            line: 75,
            column: 3
          }
        },
        loc: {
          start: {
            line: 75,
            column: 12
          },
          end: {
            line: 77,
            column: 3
          }
        },
        line: 75
      },
      '3': {
        name: '(anonymous_3)',
        decl: {
          start: {
            line: 79,
            column: 2
          },
          end: {
            line: 79,
            column: 3
          }
        },
        loc: {
          start: {
            line: 82,
            column: 37
          },
          end: {
            line: 106,
            column: 3
          }
        },
        line: 82
      },
      '4': {
        name: '(anonymous_4)',
        decl: {
          start: {
            line: 108,
            column: 2
          },
          end: {
            line: 108,
            column: 3
          }
        },
        loc: {
          start: {
            line: 111,
            column: 36
          },
          end: {
            line: 163,
            column: 3
          }
        },
        line: 111
      },
      '5': {
        name: '(anonymous_5)',
        decl: {
          start: {
            line: 112,
            column: 69
          },
          end: {
            line: 112,
            column: 70
          }
        },
        loc: {
          start: {
            line: 113,
            column: 6
          },
          end: {
            line: 113,
            column: 43
          }
        },
        line: 113
      },
      '6': {
        name: 'createCallback',
        decl: {
          start: {
            line: 126,
            column: 13
          },
          end: {
            line: 126,
            column: 27
          }
        },
        loc: {
          start: {
            line: 126,
            column: 40
          },
          end: {
            line: 133,
            column: 5
          }
        },
        line: 126
      },
      '7': {
        name: '(anonymous_7)',
        decl: {
          start: {
            line: 127,
            column: 13
          },
          end: {
            line: 127,
            column: 14
          }
        },
        loc: {
          start: {
            line: 127,
            column: 19
          },
          end: {
            line: 132,
            column: 7
          }
        },
        line: 127
      },
      '8': {
        name: 'createTitle',
        decl: {
          start: {
            line: 135,
            column: 13
          },
          end: {
            line: 135,
            column: 24
          }
        },
        loc: {
          start: {
            line: 135,
            column: 37
          },
          end: {
            line: 145,
            column: 5
          }
        },
        line: 135
      },
      '9': {
        name: '(anonymous_9)',
        decl: {
          start: {
            line: 155,
            column: 34
          },
          end: {
            line: 155,
            column: 35
          }
        },
        loc: {
          start: {
            line: 155,
            column: 48
          },
          end: {
            line: 160,
            column: 9
          }
        },
        line: 155
      },
      '10': {
        name: '(anonymous_10)',
        decl: {
          start: {
            line: 165,
            column: 2
          },
          end: {
            line: 165,
            column: 3
          }
        },
        loc: {
          start: {
            line: 169,
            column: 23
          },
          end: {
            line: 204,
            column: 3
          }
        },
        line: 169
      },
      '11': {
        name: '(anonymous_11)',
        decl: {
          start: {
            line: 173,
            column: 43
          },
          end: {
            line: 173,
            column: 44
          }
        },
        loc: {
          start: {
            line: 173,
            column: 50
          },
          end: {
            line: 173,
            column: 67
          }
        },
        line: 173
      },
      '12': {
        name: '(anonymous_12)',
        decl: {
          start: {
            line: 206,
            column: 2
          },
          end: {
            line: 206,
            column: 3
          }
        },
        loc: {
          start: {
            line: 206,
            column: 71
          },
          end: {
            line: 210,
            column: 3
          }
        },
        line: 206
      },
      '13': {
        name: '(anonymous_13)',
        decl: {
          start: {
            line: 212,
            column: 2
          },
          end: {
            line: 212,
            column: 3
          }
        },
        loc: {
          start: {
            line: 212,
            column: 72
          },
          end: {
            line: 214,
            column: 3
          }
        },
        line: 212
      },
      '14': {
        name: '(anonymous_14)',
        decl: {
          start: {
            line: 216,
            column: 2
          },
          end: {
            line: 216,
            column: 3
          }
        },
        loc: {
          start: {
            line: 216,
            column: 62
          },
          end: {
            line: 230,
            column: 3
          }
        },
        line: 216
      },
      '15': {
        name: '(anonymous_15)',
        decl: {
          start: {
            line: 220,
            column: 23
          },
          end: {
            line: 220,
            column: 24
          }
        },
        loc: {
          start: {
            line: 224,
            column: 11
          },
          end: {
            line: 224,
            column: 60
          }
        },
        line: 224
      },
      '16': {
        name: '(anonymous_16)',
        decl: {
          start: {
            line: 232,
            column: 2
          },
          end: {
            line: 232,
            column: 3
          }
        },
        loc: {
          start: {
            line: 232,
            column: 46
          },
          end: {
            line: 238,
            column: 3
          }
        },
        line: 232
      },
      '17': {
        name: '(anonymous_17)',
        decl: {
          start: {
            line: 236,
            column: 21
          },
          end: {
            line: 236,
            column: 22
          }
        },
        loc: {
          start: {
            line: 236,
            column: 43
          },
          end: {
            line: 236,
            column: 79
          }
        },
        line: 236
      },
      '18': {
        name: 'getPlatformKeys',
        decl: {
          start: {
            line: 241,
            column: 9
          },
          end: {
            line: 241,
            column: 24
          }
        },
        loc: {
          start: {
            line: 241,
            column: 35
          },
          end: {
            line: 248,
            column: 1
          }
        },
        line: 241
      }
    },
    branchMap: {
      '0': {
        loc: {
          start: {
            line: 68,
            column: 12
          },
          end: {
            line: 68,
            column: 49
          }
        },
        type: 'cond-expr',
        locations: [{
          start: {
            line: 68,
            column: 23
          },
          end: {
            line: 68,
            column: 42
          }
        }, {
          start: {
            line: 68,
            column: 45
          },
          end: {
            line: 68,
            column: 49
          }
        }],
        line: 68
      },
      '1': {
        loc: {
          start: {
            line: 87,
            column: 8
          },
          end: {
            line: 97,
            column: 9
          }
        },
        type: 'if',
        locations: [{
          start: {
            line: 87,
            column: 8
          },
          end: {
            line: 97,
            column: 9
          }
        }, {
          start: {
            line: 87,
            column: 8
          },
          end: {
            line: 97,
            column: 9
          }
        }],
        line: 87
      },
      '2': {
        loc: {
          start: {
            line: 88,
            column: 10
          },
          end: {
            line: 95,
            column: 11
          }
        },
        type: 'if',
        locations: [{
          start: {
            line: 88,
            column: 10
          },
          end: {
            line: 95,
            column: 11
          }
        }, {
          start: {
            line: 88,
            column: 10
          },
          end: {
            line: 95,
            column: 11
          }
        }],
        line: 88
      },
      '3': {
        loc: {
          start: {
            line: 93,
            column: 14
          },
          end: {
            line: 93,
            column: 73
          }
        },
        type: 'cond-expr',
        locations: [{
          start: {
            line: 93,
            column: 30
          },
          end: {
            line: 93,
            column: 41
          }
        }, {
          start: {
            line: 93,
            column: 44
          },
          end: {
            line: 93,
            column: 73
          }
        }],
        line: 93
      },
      '4': {
        loc: {
          start: {
            line: 116,
            column: 4
          },
          end: {
            line: 118,
            column: 5
          }
        },
        type: 'if',
        locations: [{
          start: {
            line: 116,
            column: 4
          },
          end: {
            line: 118,
            column: 5
          }
        }, {
          start: {
            line: 116,
            column: 4
          },
          end: {
            line: 118,
            column: 5
          }
        }],
        line: 116
      },
      '5': {
        loc: {
          start: {
            line: 137,
            column: 8
          },
          end: {
            line: 139,
            column: 72
          }
        },
        type: 'cond-expr',
        locations: [{
          start: {
            line: 138,
            column: 12
          },
          end: {
            line: 138,
            column: 27
          }
        }, {
          start: {
            line: 139,
            column: 12
          },
          end: {
            line: 139,
            column: 72
          }
        }],
        line: 137
      },
      '6': {
        loc: {
          start: {
            line: 140,
            column: 6
          },
          end: {
            line: 143,
            column: 7
          }
        },
        type: 'if',
        locations: [{
          start: {
            line: 140,
            column: 6
          },
          end: {
            line: 143,
            column: 7
          }
        }, {
          start: {
            line: 140,
            column: 6
          },
          end: {
            line: 143,
            column: 7
          }
        }],
        line: 140
      },
      '7': {
        loc: {
          start: {
            line: 147,
            column: 4
          },
          end: {
            line: 162,
            column: 5
          }
        },
        type: 'if',
        locations: [{
          start: {
            line: 147,
            column: 4
          },
          end: {
            line: 162,
            column: 5
          }
        }, {
          start: {
            line: 147,
            column: 4
          },
          end: {
            line: 162,
            column: 5
          }
        }],
        line: 147
      },
      '8': {
        loc: {
          start: {
            line: 170,
            column: 4
          },
          end: {
            line: 176,
            column: 5
          }
        },
        type: 'if',
        locations: [{
          start: {
            line: 170,
            column: 4
          },
          end: {
            line: 176,
            column: 5
          }
        }, {
          start: {
            line: 170,
            column: 4
          },
          end: {
            line: 176,
            column: 5
          }
        }],
        line: 170
      },
      '9': {
        loc: {
          start: {
            line: 171,
            column: 6
          },
          end: {
            line: 173,
            column: 68
          }
        },
        type: 'binary-expr',
        locations: [{
          start: {
            line: 171,
            column: 6
          },
          end: {
            line: 171,
            column: 24
          }
        }, {
          start: {
            line: 173,
            column: 6
          },
          end: {
            line: 173,
            column: 68
          }
        }],
        line: 171
      },
      '10': {
        loc: {
          start: {
            line: 179,
            column: 4
          },
          end: {
            line: 181,
            column: 5
          }
        },
        type: 'if',
        locations: [{
          start: {
            line: 179,
            column: 4
          },
          end: {
            line: 181,
            column: 5
          }
        }, {
          start: {
            line: 179,
            column: 4
          },
          end: {
            line: 181,
            column: 5
          }
        }],
        line: 179
      },
      '11': {
        loc: {
          start: {
            line: 196,
            column: 4
          },
          end: {
            line: 201,
            column: 5
          }
        },
        type: 'if',
        locations: [{
          start: {
            line: 196,
            column: 4
          },
          end: {
            line: 201,
            column: 5
          }
        }, {
          start: {
            line: 196,
            column: 4
          },
          end: {
            line: 201,
            column: 5
          }
        }],
        line: 196
      },
      '12': {
        loc: {
          start: {
            line: 196,
            column: 8
          },
          end: {
            line: 196,
            column: 62
          }
        },
        type: 'binary-expr',
        locations: [{
          start: {
            line: 196,
            column: 8
          },
          end: {
            line: 196,
            column: 30
          }
        }, {
          start: {
            line: 196,
            column: 34
          },
          end: {
            line: 196,
            column: 62
          }
        }],
        line: 196
      },
      '13': {
        loc: {
          start: {
            line: 242,
            column: 2
          },
          end: {
            line: 246,
            column: 3
          }
        },
        type: 'if',
        locations: [{
          start: {
            line: 242,
            column: 2
          },
          end: {
            line: 246,
            column: 3
          }
        }, {
          start: {
            line: 242,
            column: 2
          },
          end: {
            line: 246,
            column: 3
          }
        }],
        line: 242
      },
      '14': {
        loc: {
          start: {
            line: 244,
            column: 9
          },
          end: {
            line: 246,
            column: 3
          }
        },
        type: 'if',
        locations: [{
          start: {
            line: 244,
            column: 9
          },
          end: {
            line: 246,
            column: 3
          }
        }, {
          start: {
            line: 244,
            column: 9
          },
          end: {
            line: 246,
            column: 3
          }
        }],
        line: 244
      }
    },
    s: {
      '0': 0,
      '1': 0,
      '2': 0,
      '3': 0,
      '4': 0,
      '5': 0,
      '6': 0,
      '7': 0,
      '8': 0,
      '9': 0,
      '10': 0,
      '11': 0,
      '12': 0,
      '13': 0,
      '14': 0,
      '15': 0,
      '16': 0,
      '17': 0,
      '18': 0,
      '19': 0,
      '20': 0,
      '21': 0,
      '22': 0,
      '23': 0,
      '24': 0,
      '25': 0,
      '26': 0,
      '27': 0,
      '28': 0,
      '29': 0,
      '30': 0,
      '31': 0,
      '32': 0,
      '33': 0,
      '34': 0,
      '35': 0,
      '36': 0,
      '37': 0,
      '38': 0,
      '39': 0,
      '40': 0,
      '41': 0,
      '42': 0,
      '43': 0,
      '44': 0,
      '45': 0,
      '46': 0,
      '47': 0,
      '48': 0,
      '49': 0,
      '50': 0,
      '51': 0,
      '52': 0,
      '53': 0,
      '54': 0,
      '55': 0,
      '56': 0,
      '57': 0,
      '58': 0,
      '59': 0,
      '60': 0,
      '61': 0,
      '62': 0
    },
    f: {
      '0': 0,
      '1': 0,
      '2': 0,
      '3': 0,
      '4': 0,
      '5': 0,
      '6': 0,
      '7': 0,
      '8': 0,
      '9': 0,
      '10': 0,
      '11': 0,
      '12': 0,
      '13': 0,
      '14': 0,
      '15': 0,
      '16': 0,
      '17': 0,
      '18': 0
    },
    b: {
      '0': [0, 0],
      '1': [0, 0],
      '2': [0, 0],
      '3': [0, 0],
      '4': [0, 0],
      '5': [0, 0],
      '6': [0, 0],
      '7': [0, 0],
      '8': [0, 0],
      '9': [0, 0],
      '10': [0, 0],
      '11': [0, 0],
      '12': [0, 0],
      '13': [0, 0],
      '14': [0, 0]
    },
    _coverageSchema: '332fd63041d2c1bcb487cc26dd0d5f7d97098a6c'
  },
      coverage = global[gcv] || (global[gcv] = {});

  if (coverage[path] && coverage[path].hash === hash) {
    return coverage[path];
  }

  coverageData.hash = hash;
  return coverage[path] = coverageData;
}();

var _asyncToGenerator = _interopRequireDefault(require('async-to-generator'));

var _log4js;

function _load_log4js() {
  return _log4js = require('log4js');
}

var _atom = require('atom');

var _analytics;

function _load_analytics() {
  return _analytics = _interopRequireDefault(require('nuclide-commons-atom/analytics'));
}

var _createPackage;

function _load_createPackage() {
  return _createPackage = _interopRequireDefault(require('nuclide-commons-atom/createPackage'));
}

var _featureConfig;

function _load_featureConfig() {
  return _featureConfig = _interopRequireDefault(require('nuclide-commons-atom/feature-config'));
}

var _range;

function _load_range() {
  return _range = require('nuclide-commons-atom/range');
}

var _nuclideUri;

function _load_nuclideUri() {
  return _nuclideUri = _interopRequireDefault(require('nuclide-commons/nuclideUri'));
}

var _ProviderRegistry;

function _load_ProviderRegistry() {
  return _ProviderRegistry = _interopRequireDefault(require('nuclide-commons-atom/ProviderRegistry'));
}

var _UniversalDisposable;

function _load_UniversalDisposable() {
  return _UniversalDisposable = _interopRequireDefault(require('nuclide-commons/UniversalDisposable'));
}

var _goToLocation;

function _load_goToLocation() {
  return _goToLocation = require('nuclide-commons-atom/go-to-location');
}

var _DefinitionCache;

function _load_DefinitionCache() {
  return _DefinitionCache = _interopRequireDefault(require('./DefinitionCache'));
}

var _getPreviewDatatipFromDefinitionResult;

function _load_getPreviewDatatipFromDefinitionResult() {
  return _getPreviewDatatipFromDefinitionResult = _interopRequireDefault(require('./getPreviewDatatipFromDefinitionResult'));
}

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

/**
 * Copyright (c) 2017-present, Facebook, Inc.
 * All rights reserved.
 *
 * This source code is licensed under the BSD-style license found in the
 * LICENSE file in the root directory of this source tree. An additional grant
 * of patent rights can be found in the PATENTS file in the same directory.
 *
 * 
 * @format
 */

// This package provides Hyperclick results for any language which provides a
// DefinitionProvider.

class Activation {

  constructor() {
    cov_12q2q673xn.f[0]++;
    cov_12q2q673xn.s[0]++;

    this._providers = new (_ProviderRegistry || _load_ProviderRegistry()).default();
    cov_12q2q673xn.s[1]++;
    this._definitionCache = new (_DefinitionCache || _load_DefinitionCache()).default();
    cov_12q2q673xn.s[2]++;
    this._triggerKeys = new Set();

    cov_12q2q673xn.s[3]++;
    this._disposables = new (_UniversalDisposable || _load_UniversalDisposable()).default((_featureConfig || _load_featureConfig()).default.observe(getPlatformKeys(process.platform), newValue => {
      cov_12q2q673xn.f[1]++;
      cov_12q2q673xn.s[4]++;

      this._triggerKeys = new Set(
      // flowlint-next-line sketchy-null-string:off
      newValue ? (cov_12q2q673xn.b[0][0]++, newValue.split(',')) : (cov_12q2q673xn.b[0][1]++, null));
    }));
  }

  dispose() {
    cov_12q2q673xn.f[2]++;
    cov_12q2q673xn.s[5]++;

    this._disposables.dispose();
  }

  _getDefinition(editor, position) {
    var _this = this;

    return (0, _asyncToGenerator.default)(function* () {
      cov_12q2q673xn.f[3]++;
      cov_12q2q673xn.s[6]++;

      for (const provider of _this._providers.getAllProvidersForEditor(editor)) {
        cov_12q2q673xn.s[7]++;

        try {
          // eslint-disable-next-line no-await-in-loop
          const result = (cov_12q2q673xn.s[8]++, yield provider.getDefinition(editor, position));
          cov_12q2q673xn.s[9]++;
          if (result != null) {
            cov_12q2q673xn.b[1][0]++;
            cov_12q2q673xn.s[10]++;

            if (result.queryRange == null) {
              cov_12q2q673xn.b[2][0]++;

              const match = (cov_12q2q673xn.s[11]++, (0, (_range || _load_range()).wordAtPosition)(editor, position, {
                includeNonWordCharacters: false
              }));
              cov_12q2q673xn.s[12]++;
              result.queryRange = [match != null ? (cov_12q2q673xn.b[3][0]++, match.range) : (cov_12q2q673xn.b[3][1]++, new _atom.Range(position, position))];
            } else {
              cov_12q2q673xn.b[2][1]++;
            }
            cov_12q2q673xn.s[13]++;
            return result;
          } else {
            cov_12q2q673xn.b[1][1]++;
          }
        } catch (err) {
          cov_12q2q673xn.s[14]++;

          (0, (_log4js || _load_log4js()).getLogger)('atom-ide-definitions').error(`Error getting definition for ${String(editor.getPath())}`, err);
        }
      }
      cov_12q2q673xn.s[15]++;
      return null;
    })();
  }

  getSuggestion(editor, position) {
    var _this2 = this;

    return (0, _asyncToGenerator.default)(function* () {
      cov_12q2q673xn.f[4]++;

      const result = (cov_12q2q673xn.s[16]++, yield _this2._definitionCache.get(editor, position, function () {
        cov_12q2q673xn.f[5]++;
        cov_12q2q673xn.s[17]++;
        return _this2._getDefinition(editor, position);
      }));

      cov_12q2q673xn.s[18]++;
      if (result == null) {
        cov_12q2q673xn.b[4][0]++;
        cov_12q2q673xn.s[19]++;

        return null;
      } else {
        cov_12q2q673xn.b[4][1]++;
      }

      const { queryRange, definitions } = (cov_12q2q673xn.s[20]++, result);
      cov_12q2q673xn.s[21]++;

      if (!(definitions.length > 0)) {
        throw new Error('Invariant violation: "definitions.length > 0"');
      }
      // queryRange might be null coming out of the provider, but the output
      // of _getDefinition has ensured it's not null.


      cov_12q2q673xn.s[22]++;

      if (!(queryRange != null)) {
        throw new Error('Invariant violation: "queryRange != null"');
      }

      function createCallback(definition) {
        cov_12q2q673xn.f[6]++;
        cov_12q2q673xn.s[23]++;

        return () => {
          cov_12q2q673xn.f[7]++;
          cov_12q2q673xn.s[24]++;

          (0, (_goToLocation || _load_goToLocation()).goToLocation)(definition.path, {
            line: definition.position.row,
            column: definition.position.column
          });
        };
      }

      function createTitle(definition) {
        cov_12q2q673xn.f[8]++;

        const filePath = (cov_12q2q673xn.s[25]++, definition.projectRoot == null ? (cov_12q2q673xn.b[5][0]++, definition.path) : (cov_12q2q673xn.b[5][1]++, (_nuclideUri || _load_nuclideUri()).default.relative(definition.projectRoot, definition.path)));
        cov_12q2q673xn.s[26]++;
        if (definition.name == null) {
          cov_12q2q673xn.b[6][0]++;
          cov_12q2q673xn.s[27]++;

          // Fall back to just displaying the path:line.
          return `${filePath}:${definition.position.row + 1}`;
        } else {
          cov_12q2q673xn.b[6][1]++;
        }
        cov_12q2q673xn.s[28]++;
        return `${definition.name} (${filePath})`;
      }

      cov_12q2q673xn.s[29]++;
      if (definitions.length === 1) {
        cov_12q2q673xn.b[7][0]++;
        cov_12q2q673xn.s[30]++;

        return {
          range: queryRange,
          callback: createCallback(definitions[0])
        };
      } else {
        cov_12q2q673xn.b[7][1]++;
        cov_12q2q673xn.s[31]++;

        return {
          range: queryRange,
          callback: definitions.map(function (definition) {
            cov_12q2q673xn.f[9]++;
            cov_12q2q673xn.s[32]++;

            return {
              title: createTitle(definition),
              callback: createCallback(definition)
            };
          })
        };
      }
    })();
  }

  getPreview(editor, position, heldKeys) {
    var _this3 = this;

    return (0, _asyncToGenerator.default)(function* () {
      cov_12q2q673xn.f[10]++;
      cov_12q2q673xn.s[33]++;

      if ((cov_12q2q673xn.b[9][0]++, !_this3._triggerKeys) || (cov_12q2q673xn.b[9][1]++,
      // are the required keys held down?
      !Array.from(_this3._triggerKeys).every(function (key) {
        cov_12q2q673xn.f[11]++;
        cov_12q2q673xn.s[34]++;
        return heldKeys.has(key);
      }))) {
        cov_12q2q673xn.b[8][0]++;
        cov_12q2q673xn.s[35]++;

        return;
      } else {
        cov_12q2q673xn.b[8][1]++;
      }

      const result = (cov_12q2q673xn.s[36]++, yield _this3._getDefinition(editor, position));
      cov_12q2q673xn.s[37]++;
      if (result == null) {
        cov_12q2q673xn.b[10][0]++;
        cov_12q2q673xn.s[38]++;

        return null;
      } else {
        cov_12q2q673xn.b[10][1]++;
      }
      const queryRange = (cov_12q2q673xn.s[39]++, result.queryRange);
      // queryRange might be null coming out of the provider, but the output
      // of _getDefinition has ensured it's not null.
      cov_12q2q673xn.s[40]++;

      if (!(queryRange != null)) {
        throw new Error('Invariant violation: "queryRange != null"');
      }

      const grammar = (cov_12q2q673xn.s[41]++, editor.getGrammar());
      const previewDatatip = (cov_12q2q673xn.s[42]++, (0, (_getPreviewDatatipFromDefinitionResult || _load_getPreviewDatatipFromDefinitionResult()).default)(queryRange[0], result.definitions, _this3._definitionPreviewProvider, grammar));

      // flowlint-next-line sketchy-null-mixed:off
      cov_12q2q673xn.s[43]++;
      if ((cov_12q2q673xn.b[12][0]++, previewDatatip != null) && (cov_12q2q673xn.b[12][1]++, previewDatatip.markedStrings)) {
        cov_12q2q673xn.b[11][0]++;
        cov_12q2q673xn.s[44]++;

        (_analytics || _load_analytics()).default.track('hyperclick-preview-popup', {
          grammar: grammar.name,
          definitionCount: result.definitions.length
        });
      } else {
        cov_12q2q673xn.b[11][1]++;
      }

      cov_12q2q673xn.s[45]++;
      return previewDatatip;
    })();
  }

  consumeDefinitionProvider(provider) {
    cov_12q2q673xn.f[12]++;

    const disposable = (cov_12q2q673xn.s[46]++, this._providers.addProvider(provider));
    cov_12q2q673xn.s[47]++;
    this._disposables.add(disposable);
    cov_12q2q673xn.s[48]++;
    return disposable;
  }

  consumeDefinitionPreviewProvider(provider) {
    cov_12q2q673xn.f[13]++;
    cov_12q2q673xn.s[49]++;

    this._definitionPreviewProvider = provider;
  }

  consumeDatatipService(service) {
    cov_12q2q673xn.f[14]++;

    const datatipProvider = (cov_12q2q673xn.s[50]++, {
      providerName: 'hyperclick-preview',
      priority: 1,
      modifierDatatip: (editor, bufferPosition, heldKeys) => {
        cov_12q2q673xn.f[15]++;
        cov_12q2q673xn.s[51]++;
        return this.getPreview(editor, bufferPosition, heldKeys);
      }
    });

    const disposable = (cov_12q2q673xn.s[52]++, service.addModifierProvider(datatipProvider));
    cov_12q2q673xn.s[53]++;
    this._disposables.add(disposable);
    cov_12q2q673xn.s[54]++;
    return disposable;
  }

  getHyperclickProvider() {
    cov_12q2q673xn.f[16]++;
    cov_12q2q673xn.s[55]++;

    return {
      priority: 20,
      providerName: 'atom-ide-definitions',
      getSuggestion: (editor, position) => {
        cov_12q2q673xn.f[17]++;
        cov_12q2q673xn.s[56]++;
        return this.getSuggestion(editor, position);
      }
    };
  }
}

function getPlatformKeys(platform) {
  cov_12q2q673xn.f[18]++;
  cov_12q2q673xn.s[57]++;

  if (platform === 'darwin') {
    cov_12q2q673xn.b[13][0]++;
    cov_12q2q673xn.s[58]++;

    return 'hyperclick.darwinTriggerKeys';
  } else {
      cov_12q2q673xn.b[13][1]++;
      cov_12q2q673xn.s[59]++;
      if (platform === 'win32') {
        cov_12q2q673xn.b[14][0]++;
        cov_12q2q673xn.s[60]++;

        return 'hyperclick.win32TriggerKeys';
      } else {
        cov_12q2q673xn.b[14][1]++;
      }
    }cov_12q2q673xn.s[61]++;
  return 'hyperclick.linuxTriggerKeys';
}

cov_12q2q673xn.s[62]++;
(0, (_createPackage || _load_createPackage()).default)(module.exports, Activation);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uanMiXSwibmFtZXMiOlsiQWN0aXZhdGlvbiIsImNvbnN0cnVjdG9yIiwiX3Byb3ZpZGVycyIsIl9kZWZpbml0aW9uQ2FjaGUiLCJfdHJpZ2dlcktleXMiLCJTZXQiLCJfZGlzcG9zYWJsZXMiLCJvYnNlcnZlIiwiZ2V0UGxhdGZvcm1LZXlzIiwicHJvY2VzcyIsInBsYXRmb3JtIiwibmV3VmFsdWUiLCJzcGxpdCIsImRpc3Bvc2UiLCJfZ2V0RGVmaW5pdGlvbiIsImVkaXRvciIsInBvc2l0aW9uIiwicHJvdmlkZXIiLCJnZXRBbGxQcm92aWRlcnNGb3JFZGl0b3IiLCJyZXN1bHQiLCJnZXREZWZpbml0aW9uIiwicXVlcnlSYW5nZSIsIm1hdGNoIiwiaW5jbHVkZU5vbldvcmRDaGFyYWN0ZXJzIiwicmFuZ2UiLCJlcnIiLCJlcnJvciIsIlN0cmluZyIsImdldFBhdGgiLCJnZXRTdWdnZXN0aW9uIiwiZ2V0IiwiZGVmaW5pdGlvbnMiLCJsZW5ndGgiLCJjcmVhdGVDYWxsYmFjayIsImRlZmluaXRpb24iLCJwYXRoIiwibGluZSIsInJvdyIsImNvbHVtbiIsImNyZWF0ZVRpdGxlIiwiZmlsZVBhdGgiLCJwcm9qZWN0Um9vdCIsInJlbGF0aXZlIiwibmFtZSIsImNhbGxiYWNrIiwibWFwIiwidGl0bGUiLCJnZXRQcmV2aWV3IiwiaGVsZEtleXMiLCJBcnJheSIsImZyb20iLCJldmVyeSIsImhhcyIsImtleSIsImdyYW1tYXIiLCJnZXRHcmFtbWFyIiwicHJldmlld0RhdGF0aXAiLCJfZGVmaW5pdGlvblByZXZpZXdQcm92aWRlciIsIm1hcmtlZFN0cmluZ3MiLCJ0cmFjayIsImRlZmluaXRpb25Db3VudCIsImNvbnN1bWVEZWZpbml0aW9uUHJvdmlkZXIiLCJkaXNwb3NhYmxlIiwiYWRkUHJvdmlkZXIiLCJhZGQiLCJjb25zdW1lRGVmaW5pdGlvblByZXZpZXdQcm92aWRlciIsImNvbnN1bWVEYXRhdGlwU2VydmljZSIsInNlcnZpY2UiLCJkYXRhdGlwUHJvdmlkZXIiLCJwcm92aWRlck5hbWUiLCJwcmlvcml0eSIsIm1vZGlmaWVyRGF0YXRpcCIsImJ1ZmZlclBvc2l0aW9uIiwiYWRkTW9kaWZpZXJQcm92aWRlciIsImdldEh5cGVyY2xpY2tQcm92aWRlciIsIm1vZHVsZSIsImV4cG9ydHMiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7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QURMO0FBRUxELG9CQUFjLHNCQUZUO0FBR0x4QyxxQkFBZSxDQUFDZCxNQUFELEVBQVNDLFFBQVQsS0FBc0I7QUFBQTtBQUFBO0FBQUEsb0JBQUthLGFBQUwsQ0FBbUJkLE1BQW5CLEVBQTJCQyxRQUEzQjtBQUFvQztBQUhwRSxLQUFQO0FBS0Q7QUE1TGM7O0FBK0xqQixTQUFTUixlQUFULENBQXlCRSxRQUF6QixFQUFtQztBQUFBO0FBQUE7O0FBQ2pDLE1BQUlBLGFBQWEsUUFBakIsRUFBMkI7QUFBQTtBQUFBOztBQUN6QixXQUFPLDhCQUFQO0FBQ0QsR0FGRCxNQUVPO0FBQUE7QUFBQTtBQUFBLFVBQUlBLGFBQWEsT0FBakIsRUFBMEI7QUFBQTtBQUFBOztBQUMvQixlQUFPLDZCQUFQO0FBQ0QsT0FGTTtBQUFBO0FBQUE7QUFFTixLQUxnQztBQU1qQyxTQUFPLDZCQUFQO0FBQ0Q7OztBQUVELHVEQUFjaUUsT0FBT0MsT0FBckIsRUFBOEI1RSxVQUE5QiIsImZpbGUiOiJtYWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTctcHJlc2VudCwgRmFjZWJvb2ssIEluYy5cbiAqIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4gKlxuICogVGhpcyBzb3VyY2UgY29kZSBpcyBsaWNlbnNlZCB1bmRlciB0aGUgQlNELXN0eWxlIGxpY2Vuc2UgZm91bmQgaW4gdGhlXG4gKiBMSUNFTlNFIGZpbGUgaW4gdGhlIHJvb3QgZGlyZWN0b3J5IG9mIHRoaXMgc291cmNlIHRyZWUuIEFuIGFkZGl0aW9uYWwgZ3JhbnRcbiAqIG9mIHBhdGVudCByaWdodHMgY2FuIGJlIGZvdW5kIGluIHRoZSBQQVRFTlRTIGZpbGUgaW4gdGhlIHNhbWUgZGlyZWN0b3J5LlxuICpcbiAqIEBmbG93XG4gKiBAZm9ybWF0XG4gKi9cblxuLy8gVGhpcyBwYWNrYWdlIHByb3ZpZGVzIEh5cGVyY2xpY2sgcmVzdWx0cyBmb3IgYW55IGxhbmd1YWdlIHdoaWNoIHByb3ZpZGVzIGFcbi8vIERlZmluaXRpb25Qcm92aWRlci5cblxuaW1wb3J0IHR5cGUge1xuICBIeXBlcmNsaWNrUHJvdmlkZXIsXG4gIEh5cGVyY2xpY2tTdWdnZXN0aW9uLFxufSBmcm9tICcuLi8uLi9oeXBlcmNsaWNrL2xpYi90eXBlcyc7XG5cbmltcG9ydCB0eXBlIHtcbiAgRGF0YXRpcCxcbiAgRGF0YXRpcFNlcnZpY2UsXG4gIE1vZGlmaWVyRGF0YXRpcFByb3ZpZGVyLFxuICBNb2RpZmllcktleSxcbn0gZnJvbSAnLi4vLi4vYXRvbS1pZGUtZGF0YXRpcC9saWIvdHlwZXMnO1xuXG5pbXBvcnQgdHlwZSB7XG4gIERlZmluaXRpb25RdWVyeVJlc3VsdCxcbiAgRGVmaW5pdGlvblByb3ZpZGVyLFxuICBEZWZpbml0aW9uUHJldmlld1Byb3ZpZGVyLFxufSBmcm9tICcuL3R5cGVzJztcblxuaW1wb3J0IGludmFyaWFudCBmcm9tICdhc3NlcnQnO1xuaW1wb3J0IHtnZXRMb2dnZXJ9IGZyb20gJ2xvZzRqcyc7XG5pbXBvcnQge1JhbmdlfSBmcm9tICdhdG9tJztcblxuaW1wb3J0IGFuYWx5dGljcyBmcm9tICdudWNsaWRlLWNvbW1vbnMtYXRvbS9hbmFseXRpY3MnO1xuaW1wb3J0IGNyZWF0ZVBhY2thZ2UgZnJvbSAnbnVjbGlkZS1jb21tb25zLWF0b20vY3JlYXRlUGFja2FnZSc7XG5pbXBvcnQgRmVhdHVyZUNvbmZpZyBmcm9tICdudWNsaWRlLWNvbW1vbnMtYXRvbS9mZWF0dXJlLWNvbmZpZyc7XG5pbXBvcnQge3dvcmRBdFBvc2l0aW9ufSBmcm9tICdudWNsaWRlLWNvbW1vbnMtYXRvbS9yYW5nZSc7XG5pbXBvcnQgbnVjbGlkZVVyaSBmcm9tICdudWNsaWRlLWNvbW1vbnMvbnVjbGlkZVVyaSc7XG5pbXBvcnQgUHJvdmlkZXJSZWdpc3RyeSBmcm9tICdudWNsaWRlLWNvbW1vbnMtYXRvbS9Qcm92aWRlclJlZ2lzdHJ5JztcbmltcG9ydCBVbml2ZXJzYWxEaXNwb3NhYmxlIGZyb20gJ251Y2xpZGUtY29tbW9ucy9Vbml2ZXJzYWxEaXNwb3NhYmxlJztcbmltcG9ydCB7Z29Ub0xvY2F0aW9ufSBmcm9tICdudWNsaWRlLWNvbW1vbnMtYXRvbS9nby10by1sb2NhdGlvbic7XG5cbmltcG9ydCBEZWZpbml0aW9uQ2FjaGUgZnJvbSAnLi9EZWZpbml0aW9uQ2FjaGUnO1xuaW1wb3J0IGdldFByZXZpZXdEYXRhdGlwRnJvbURlZmluaXRpb25SZXN1bHQgZnJvbSAnLi9nZXRQcmV2aWV3RGF0YXRpcEZyb21EZWZpbml0aW9uUmVzdWx0JztcblxuY2xhc3MgQWN0aXZhdGlvbiB7XG4gIF9wcm92aWRlcnM6IFByb3ZpZGVyUmVnaXN0cnk8RGVmaW5pdGlvblByb3ZpZGVyPjtcbiAgX2RlZmluaXRpb25QcmV2aWV3UHJvdmlkZXI6ID9EZWZpbml0aW9uUHJldmlld1Byb3ZpZGVyO1xuICBfZGVmaW5pdGlvbkNhY2hlOiBEZWZpbml0aW9uQ2FjaGU7XG4gIF9kaXNwb3NhYmxlczogVW5pdmVyc2FsRGlzcG9zYWJsZTtcbiAgX3RyaWdnZXJLZXlzOiBTZXQ8TW9kaWZpZXJLZXk+O1xuXG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHRoaXMuX3Byb3ZpZGVycyA9IG5ldyBQcm92aWRlclJlZ2lzdHJ5KCk7XG4gICAgdGhpcy5fZGVmaW5pdGlvbkNhY2hlID0gbmV3IERlZmluaXRpb25DYWNoZSgpO1xuICAgIHRoaXMuX3RyaWdnZXJLZXlzID0gbmV3IFNldCgpO1xuXG4gICAgdGhpcy5fZGlzcG9zYWJsZXMgPSBuZXcgVW5pdmVyc2FsRGlzcG9zYWJsZShcbiAgICAgIEZlYXR1cmVDb25maWcub2JzZXJ2ZShcbiAgICAgICAgZ2V0UGxhdGZvcm1LZXlzKHByb2Nlc3MucGxhdGZvcm0pLFxuICAgICAgICAobmV3VmFsdWU6ID9zdHJpbmcpID0+IHtcbiAgICAgICAgICB0aGlzLl90cmlnZ2VyS2V5cyA9IChuZXcgU2V0KFxuICAgICAgICAgICAgLy8gZmxvd2xpbnQtbmV4dC1saW5lIHNrZXRjaHktbnVsbC1zdHJpbmc6b2ZmXG4gICAgICAgICAgICBuZXdWYWx1ZSA/IG5ld1ZhbHVlLnNwbGl0KCcsJykgOiBudWxsLFxuICAgICAgICAgICk6IFNldDxhbnk+KTtcbiAgICAgICAgfSxcbiAgICAgICksXG4gICAgKTtcbiAgfVxuXG4gIGRpc3Bvc2UoKSB7XG4gICAgdGhpcy5fZGlzcG9zYWJsZXMuZGlzcG9zZSgpO1xuICB9XG5cbiAgYXN5bmMgX2dldERlZmluaXRpb24oXG4gICAgZWRpdG9yOiBhdG9tJFRleHRFZGl0b3IsXG4gICAgcG9zaXRpb246IGF0b20kUG9pbnQsXG4gICk6IFByb21pc2U8P0RlZmluaXRpb25RdWVyeVJlc3VsdD4ge1xuICAgIGZvciAoY29uc3QgcHJvdmlkZXIgb2YgdGhpcy5fcHJvdmlkZXJzLmdldEFsbFByb3ZpZGVyc0ZvckVkaXRvcihlZGl0b3IpKSB7XG4gICAgICB0cnkge1xuICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tYXdhaXQtaW4tbG9vcFxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBwcm92aWRlci5nZXREZWZpbml0aW9uKGVkaXRvciwgcG9zaXRpb24pO1xuICAgICAgICBpZiAocmVzdWx0ICE9IG51bGwpIHtcbiAgICAgICAgICBpZiAocmVzdWx0LnF1ZXJ5UmFuZ2UgPT0gbnVsbCkge1xuICAgICAgICAgICAgY29uc3QgbWF0Y2ggPSB3b3JkQXRQb3NpdGlvbihlZGl0b3IsIHBvc2l0aW9uLCB7XG4gICAgICAgICAgICAgIGluY2x1ZGVOb25Xb3JkQ2hhcmFjdGVyczogZmFsc2UsXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJlc3VsdC5xdWVyeVJhbmdlID0gW1xuICAgICAgICAgICAgICBtYXRjaCAhPSBudWxsID8gbWF0Y2gucmFuZ2UgOiBuZXcgUmFuZ2UocG9zaXRpb24sIHBvc2l0aW9uKSxcbiAgICAgICAgICAgIF07XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgIH1cbiAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICBnZXRMb2dnZXIoJ2F0b20taWRlLWRlZmluaXRpb25zJykuZXJyb3IoXG4gICAgICAgICAgYEVycm9yIGdldHRpbmcgZGVmaW5pdGlvbiBmb3IgJHtTdHJpbmcoZWRpdG9yLmdldFBhdGgoKSl9YCxcbiAgICAgICAgICBlcnIsXG4gICAgICAgICk7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBudWxsO1xuICB9XG5cbiAgYXN5bmMgZ2V0U3VnZ2VzdGlvbihcbiAgICBlZGl0b3I6IGF0b20kVGV4dEVkaXRvcixcbiAgICBwb3NpdGlvbjogYXRvbSRQb2ludCxcbiAgKTogUHJvbWlzZTw/SHlwZXJjbGlja1N1Z2dlc3Rpb24+IHtcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLl9kZWZpbml0aW9uQ2FjaGUuZ2V0KGVkaXRvciwgcG9zaXRpb24sICgpID0+XG4gICAgICB0aGlzLl9nZXREZWZpbml0aW9uKGVkaXRvciwgcG9zaXRpb24pLFxuICAgICk7XG5cbiAgICBpZiAocmVzdWx0ID09IG51bGwpIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cblxuICAgIGNvbnN0IHtxdWVyeVJhbmdlLCBkZWZpbml0aW9uc30gPSByZXN1bHQ7XG4gICAgaW52YXJpYW50KGRlZmluaXRpb25zLmxlbmd0aCA+IDApO1xuICAgIC8vIHF1ZXJ5UmFuZ2UgbWlnaHQgYmUgbnVsbCBjb21pbmcgb3V0IG9mIHRoZSBwcm92aWRlciwgYnV0IHRoZSBvdXRwdXRcbiAgICAvLyBvZiBfZ2V0RGVmaW5pdGlvbiBoYXMgZW5zdXJlZCBpdCdzIG5vdCBudWxsLlxuICAgIGludmFyaWFudChxdWVyeVJhbmdlICE9IG51bGwpO1xuXG4gICAgZnVuY3Rpb24gY3JlYXRlQ2FsbGJhY2soZGVmaW5pdGlvbikge1xuICAgICAgcmV0dXJuICgpID0+IHtcbiAgICAgICAgZ29Ub0xvY2F0aW9uKGRlZmluaXRpb24ucGF0aCwge1xuICAgICAgICAgIGxpbmU6IGRlZmluaXRpb24ucG9zaXRpb24ucm93LFxuICAgICAgICAgIGNvbHVtbjogZGVmaW5pdGlvbi5wb3NpdGlvbi5jb2x1bW4sXG4gICAgICAgIH0pO1xuICAgICAgfTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBjcmVhdGVUaXRsZShkZWZpbml0aW9uKSB7XG4gICAgICBjb25zdCBmaWxlUGF0aCA9XG4gICAgICAgIGRlZmluaXRpb24ucHJvamVjdFJvb3QgPT0gbnVsbFxuICAgICAgICAgID8gZGVmaW5pdGlvbi5wYXRoXG4gICAgICAgICAgOiBudWNsaWRlVXJpLnJlbGF0aXZlKGRlZmluaXRpb24ucHJvamVjdFJvb3QsIGRlZmluaXRpb24ucGF0aCk7XG4gICAgICBpZiAoZGVmaW5pdGlvbi5uYW1lID09IG51bGwpIHtcbiAgICAgICAgLy8gRmFsbCBiYWNrIHRvIGp1c3QgZGlzcGxheWluZyB0aGUgcGF0aDpsaW5lLlxuICAgICAgICByZXR1cm4gYCR7ZmlsZVBhdGh9OiR7ZGVmaW5pdGlvbi5wb3NpdGlvbi5yb3cgKyAxfWA7XG4gICAgICB9XG4gICAgICByZXR1cm4gYCR7ZGVmaW5pdGlvbi5uYW1lfSAoJHtmaWxlUGF0aH0pYDtcbiAgICB9XG5cbiAgICBpZiAoZGVmaW5pdGlvbnMubGVuZ3RoID09PSAxKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICByYW5nZTogcXVlcnlSYW5nZSxcbiAgICAgICAgY2FsbGJhY2s6IGNyZWF0ZUNhbGxiYWNrKGRlZmluaXRpb25zWzBdKSxcbiAgICAgIH07XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHJhbmdlOiBxdWVyeVJhbmdlLFxuICAgICAgICBjYWxsYmFjazogZGVmaW5pdGlvbnMubWFwKGRlZmluaXRpb24gPT4ge1xuICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICB0aXRsZTogY3JlYXRlVGl0bGUoZGVmaW5pdGlvbiksXG4gICAgICAgICAgICBjYWxsYmFjazogY3JlYXRlQ2FsbGJhY2soZGVmaW5pdGlvbiksXG4gICAgICAgICAgfTtcbiAgICAgICAgfSksXG4gICAgICB9O1xuICAgIH1cbiAgfVxuXG4gIGFzeW5jIGdldFByZXZpZXcoXG4gICAgZWRpdG9yOiBhdG9tJFRleHRFZGl0b3IsXG4gICAgcG9zaXRpb246IGF0b20kUG9pbnQsXG4gICAgaGVsZEtleXM6IFNldDxNb2RpZmllcktleT4sXG4gICk6IFByb21pc2U8P0RhdGF0aXA+IHtcbiAgICBpZiAoXG4gICAgICAhdGhpcy5fdHJpZ2dlcktleXMgfHxcbiAgICAgIC8vIGFyZSB0aGUgcmVxdWlyZWQga2V5cyBoZWxkIGRvd24/XG4gICAgICAhQXJyYXkuZnJvbSh0aGlzLl90cmlnZ2VyS2V5cykuZXZlcnkoa2V5ID0+IGhlbGRLZXlzLmhhcyhrZXkpKVxuICAgICkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMuX2dldERlZmluaXRpb24oZWRpdG9yLCBwb3NpdGlvbik7XG4gICAgaWYgKHJlc3VsdCA9PSBudWxsKSB7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gICAgY29uc3QgcXVlcnlSYW5nZSA9IHJlc3VsdC5xdWVyeVJhbmdlO1xuICAgIC8vIHF1ZXJ5UmFuZ2UgbWlnaHQgYmUgbnVsbCBjb21pbmcgb3V0IG9mIHRoZSBwcm92aWRlciwgYnV0IHRoZSBvdXRwdXRcbiAgICAvLyBvZiBfZ2V0RGVmaW5pdGlvbiBoYXMgZW5zdXJlZCBpdCdzIG5vdCBudWxsLlxuICAgIGludmFyaWFudChxdWVyeVJhbmdlICE9IG51bGwpO1xuXG4gICAgY29uc3QgZ3JhbW1hciA9IGVkaXRvci5nZXRHcmFtbWFyKCk7XG4gICAgY29uc3QgcHJldmlld0RhdGF0aXAgPSBnZXRQcmV2aWV3RGF0YXRpcEZyb21EZWZpbml0aW9uUmVzdWx0KFxuICAgICAgcXVlcnlSYW5nZVswXSxcbiAgICAgIHJlc3VsdC5kZWZpbml0aW9ucyxcbiAgICAgIHRoaXMuX2RlZmluaXRpb25QcmV2aWV3UHJvdmlkZXIsXG4gICAgICBncmFtbWFyLFxuICAgICk7XG5cbiAgICAvLyBmbG93bGludC1uZXh0LWxpbmUgc2tldGNoeS1udWxsLW1peGVkOm9mZlxuICAgIGlmIChwcmV2aWV3RGF0YXRpcCAhPSBudWxsICYmIHByZXZpZXdEYXRhdGlwLm1hcmtlZFN0cmluZ3MpIHtcbiAgICAgIGFuYWx5dGljcy50cmFjaygnaHlwZXJjbGljay1wcmV2aWV3LXBvcHVwJywge1xuICAgICAgICBncmFtbWFyOiBncmFtbWFyLm5hbWUsXG4gICAgICAgIGRlZmluaXRpb25Db3VudDogcmVzdWx0LmRlZmluaXRpb25zLmxlbmd0aCxcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIHJldHVybiBwcmV2aWV3RGF0YXRpcDtcbiAgfVxuXG4gIGNvbnN1bWVEZWZpbml0aW9uUHJvdmlkZXIocHJvdmlkZXI6IERlZmluaXRpb25Qcm92aWRlcik6IElEaXNwb3NhYmxlIHtcbiAgICBjb25zdCBkaXNwb3NhYmxlID0gdGhpcy5fcHJvdmlkZXJzLmFkZFByb3ZpZGVyKHByb3ZpZGVyKTtcbiAgICB0aGlzLl9kaXNwb3NhYmxlcy5hZGQoZGlzcG9zYWJsZSk7XG4gICAgcmV0dXJuIGRpc3Bvc2FibGU7XG4gIH1cblxuICBjb25zdW1lRGVmaW5pdGlvblByZXZpZXdQcm92aWRlcihwcm92aWRlcjogRGVmaW5pdGlvblByZXZpZXdQcm92aWRlcikge1xuICAgIHRoaXMuX2RlZmluaXRpb25QcmV2aWV3UHJvdmlkZXIgPSBwcm92aWRlcjtcbiAgfVxuXG4gIGNvbnN1bWVEYXRhdGlwU2VydmljZShzZXJ2aWNlOiBEYXRhdGlwU2VydmljZSk6IElEaXNwb3NhYmxlIHtcbiAgICBjb25zdCBkYXRhdGlwUHJvdmlkZXI6IE1vZGlmaWVyRGF0YXRpcFByb3ZpZGVyID0ge1xuICAgICAgcHJvdmlkZXJOYW1lOiAnaHlwZXJjbGljay1wcmV2aWV3JyxcbiAgICAgIHByaW9yaXR5OiAxLFxuICAgICAgbW9kaWZpZXJEYXRhdGlwOiAoXG4gICAgICAgIGVkaXRvcjogYXRvbSRUZXh0RWRpdG9yLFxuICAgICAgICBidWZmZXJQb3NpdGlvbjogYXRvbSRQb2ludCxcbiAgICAgICAgaGVsZEtleXM6IFNldDxNb2RpZmllcktleT4sXG4gICAgICApID0+IHRoaXMuZ2V0UHJldmlldyhlZGl0b3IsIGJ1ZmZlclBvc2l0aW9uLCBoZWxkS2V5cyksXG4gICAgfTtcblxuICAgIGNvbnN0IGRpc3Bvc2FibGUgPSBzZXJ2aWNlLmFkZE1vZGlmaWVyUHJvdmlkZXIoZGF0YXRpcFByb3ZpZGVyKTtcbiAgICB0aGlzLl9kaXNwb3NhYmxlcy5hZGQoZGlzcG9zYWJsZSk7XG4gICAgcmV0dXJuIGRpc3Bvc2FibGU7XG4gIH1cblxuICBnZXRIeXBlcmNsaWNrUHJvdmlkZXIoKTogSHlwZXJjbGlja1Byb3ZpZGVyIHtcbiAgICByZXR1cm4ge1xuICAgICAgcHJpb3JpdHk6IDIwLFxuICAgICAgcHJvdmlkZXJOYW1lOiAnYXRvbS1pZGUtZGVmaW5pdGlvbnMnLFxuICAgICAgZ2V0U3VnZ2VzdGlvbjogKGVkaXRvciwgcG9zaXRpb24pID0+IHRoaXMuZ2V0U3VnZ2VzdGlvbihlZGl0b3IsIHBvc2l0aW9uKSxcbiAgICB9O1xuICB9XG59XG5cbmZ1bmN0aW9uIGdldFBsYXRmb3JtS2V5cyhwbGF0Zm9ybSkge1xuICBpZiAocGxhdGZvcm0gPT09ICdkYXJ3aW4nKSB7XG4gICAgcmV0dXJuICdoeXBlcmNsaWNrLmRhcndpblRyaWdnZXJLZXlzJztcbiAgfSBlbHNlIGlmIChwbGF0Zm9ybSA9PT0gJ3dpbjMyJykge1xuICAgIHJldHVybiAnaHlwZXJjbGljay53aW4zMlRyaWdnZXJLZXlzJztcbiAgfVxuICByZXR1cm4gJ2h5cGVyY2xpY2subGludXhUcmlnZ2VyS2V5cyc7XG59XG5cbmNyZWF0ZVBhY2thZ2UobW9kdWxlLmV4cG9ydHMsIEFjdGl2YXRpb24pO1xuIl19