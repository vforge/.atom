'use strict';

var cov_2bako6afgn = function () {
  var path = '/Users/hansonw/atom-ide-ui/modules/nuclide-commons-ui/observable-dom.js',
      hash = 'ba774a387692476809efe5a1250ff1f6b47fa84b',
      global = new Function('return this')(),
      gcv = '__coverage__',
      coverageData = {
    path: '/Users/hansonw/atom-ide-ui/modules/nuclide-commons-ui/observable-dom.js',
    statementMap: {
      '0': {
        start: {
          line: 100,
          column: 4
        },
        end: {
          line: 100,
          column: 12
        }
      },
      '1': {
        start: {
          line: 101,
          column: 4
        },
        end: {
          line: 101,
          column: 44
        }
      },
      '2': {
        start: {
          line: 102,
          column: 4
        },
        end: {
          line: 104,
          column: 5
        }
      },
      '3': {
        start: {
          line: 103,
          column: 6
        },
        end: {
          line: 103,
          column: 35
        }
      },
      '4': {
        start: {
          line: 110,
          column: 16
        },
        end: {
          line: 113,
          column: 5
        }
      },
      '5': {
        start: {
          line: 114,
          column: 4
        },
        end: {
          line: 114,
          column: 51
        }
      },
      '6': {
        start: {
          line: 115,
          column: 4
        },
        end: {
          line: 115,
          column: 22
        }
      },
      '7': {
        start: {
          line: 116,
          column: 4
        },
        end: {
          line: 116,
          column: 28
        }
      },
      '8': {
        start: {
          line: 117,
          column: 4
        },
        end: {
          line: 117,
          column: 15
        }
      },
      '9': {
        start: {
          line: 121,
          column: 4
        },
        end: {
          line: 121,
          column: 41
        }
      },
      '10': {
        start: {
          line: 123,
          column: 4
        },
        end: {
          line: 125,
          column: 5
        }
      },
      '11': {
        start: {
          line: 124,
          column: 6
        },
        end: {
          line: 124,
          column: 48
        }
      },
      '12': {
        start: {
          line: 129,
          column: 4
        },
        end: {
          line: 134,
          column: 5
        }
      },
      '13': {
        start: {
          line: 130,
          column: 6
        },
        end: {
          line: 133,
          column: 8
        }
      },
      '14': {
        start: {
          line: 136,
          column: 4
        },
        end: {
          line: 141,
          column: 5
        }
      },
      '15': {
        start: {
          line: 137,
          column: 6
        },
        end: {
          line: 140,
          column: 7
        }
      },
      '16': {
        start: {
          line: 138,
          column: 8
        },
        end: {
          line: 138,
          column: 40
        }
      },
      '17': {
        start: {
          line: 139,
          column: 8
        },
        end: {
          line: 139,
          column: 14
        }
      },
      '18': {
        start: {
          line: 143,
          column: 4
        },
        end: {
          line: 145,
          column: 5
        }
      },
      '19': {
        start: {
          line: 144,
          column: 6
        },
        end: {
          line: 144,
          column: 52
        }
      },
      '20': {
        start: {
          line: 149,
          column: 4
        },
        end: {
          line: 163,
          column: 7
        }
      },
      '21': {
        start: {
          line: 150,
          column: 6
        },
        end: {
          line: 156,
          column: 7
        }
      },
      '22': {
        start: {
          line: 152,
          column: 8
        },
        end: {
          line: 152,
          column: 40
        }
      },
      '23': {
        start: {
          line: 154,
          column: 13
        },
        end: {
          line: 156,
          column: 7
        }
      },
      '24': {
        start: {
          line: 155,
          column: 8
        },
        end: {
          line: 155,
          column: 53
        }
      },
      '25': {
        start: {
          line: 158,
          column: 6
        },
        end: {
          line: 162,
          column: 8
        }
      },
      '26': {
        start: {
          line: 167,
          column: 4
        },
        end: {
          line: 176,
          column: 5
        }
      },
      '27': {
        start: {
          line: 168,
          column: 6
        },
        end: {
          line: 168,
          column: 43
        }
      },
      '28': {
        start: {
          line: 169,
          column: 6
        },
        end: {
          line: 171,
          column: 9
        }
      },
      '29': {
        start: {
          line: 170,
          column: 8
        },
        end: {
          line: 170,
          column: 33
        }
      },
      '30': {
        start: {
          line: 173,
          column: 6
        },
        end: {
          line: 175,
          column: 7
        }
      },
      '31': {
        start: {
          line: 174,
          column: 8
        },
        end: {
          line: 174,
          column: 50
        }
      },
      '32': {
        start: {
          line: 178,
          column: 25
        },
        end: {
          line: 178,
          column: 43
        }
      },
      '33': {
        start: {
          line: 179,
          column: 4
        },
        end: {
          line: 179,
          column: 17
        }
      },
      '34': {
        start: {
          line: 180,
          column: 4
        },
        end: {
          line: 190,
          column: 7
        }
      },
      '35': {
        start: {
          line: 181,
          column: 6
        },
        end: {
          line: 181,
          column: 19
        }
      },
      '36': {
        start: {
          line: 185,
          column: 6
        },
        end: {
          line: 189,
          column: 7
        }
      },
      '37': {
        start: {
          line: 186,
          column: 8
        },
        end: {
          line: 186,
          column: 45
        }
      },
      '38': {
        start: {
          line: 187,
          column: 8
        },
        end: {
          line: 187,
          column: 39
        }
      },
      '39': {
        start: {
          line: 188,
          column: 8
        },
        end: {
          line: 188,
          column: 33
        }
      },
      '40': {
        start: {
          line: 192,
          column: 4
        },
        end: {
          line: 192,
          column: 24
        }
      },
      '41': {
        start: {
          line: 196,
          column: 38
        },
        end: {
          line: 196,
          column: 59
        }
      },
      '42': {
        start: {
          line: 207,
          column: 4
        },
        end: {
          line: 211,
          column: 6
        }
      },
      '43': {
        start: {
          line: 213,
          column: 4
        },
        end: {
          line: 213,
          column: 40
        }
      },
      '44': {
        start: {
          line: 227,
          column: 4
        },
        end: {
          line: 231,
          column: 6
        }
      },
      '45': {
        start: {
          line: 233,
          column: 4
        },
        end: {
          line: 233,
          column: 36
        }
      },
      '46': {
        start: {
          line: 246,
          column: 4
        },
        end: {
          line: 250,
          column: 6
        }
      },
      '47': {
        start: {
          line: 252,
          column: 4
        },
        end: {
          line: 252,
          column: 40
        }
      },
      '48': {
        start: {
          line: 265,
          column: 4
        },
        end: {
          line: 269,
          column: 6
        }
      },
      '49': {
        start: {
          line: 271,
          column: 4
        },
        end: {
          line: 271,
          column: 34
        }
      }
    },
    fnMap: {
      '0': {
        name: '(anonymous_0)',
        decl: {
          start: {
            line: 96,
            column: 2
          },
          end: {
            line: 96,
            column: 3
          }
        },
        loc: {
          start: {
            line: 99,
            column: 10
          },
          end: {
            line: 105,
            column: 3
          }
        },
        line: 99
      },
      '1': {
        name: '(anonymous_1)',
        decl: {
          start: {
            line: 107,
            column: 2
          },
          end: {
            line: 107,
            column: 3
          }
        },
        loc: {
          start: {
            line: 109,
            column: 47
          },
          end: {
            line: 118,
            column: 3
          }
        },
        line: 109
      },
      '2': {
        name: '(anonymous_2)',
        decl: {
          start: {
            line: 120,
            column: 2
          },
          end: {
            line: 120,
            column: 3
          }
        },
        loc: {
          start: {
            line: 120,
            column: 46
          },
          end: {
            line: 126,
            column: 3
          }
        },
        line: 120
      },
      '3': {
        name: '(anonymous_3)',
        decl: {
          start: {
            line: 128,
            column: 2
          },
          end: {
            line: 128,
            column: 3
          }
        },
        loc: {
          start: {
            line: 128,
            column: 50
          },
          end: {
            line: 146,
            column: 3
          }
        },
        line: 128
      },
      '4': {
        name: '(anonymous_4)',
        decl: {
          start: {
            line: 148,
            column: 2
          },
          end: {
            line: 148,
            column: 3
          }
        },
        loc: {
          start: {
            line: 148,
            column: 39
          },
          end: {
            line: 164,
            column: 3
          }
        },
        line: 148
      },
      '5': {
        name: '(anonymous_5)',
        decl: {
          start: {
            line: 149,
            column: 25
          },
          end: {
            line: 149,
            column: 26
          }
        },
        loc: {
          start: {
            line: 149,
            column: 36
          },
          end: {
            line: 163,
            column: 5
          }
        },
        line: 149
      },
      '6': {
        name: '(anonymous_6)',
        decl: {
          start: {
            line: 166,
            column: 2
          },
          end: {
            line: 166,
            column: 3
          }
        },
        loc: {
          start: {
            line: 166,
            column: 63
          },
          end: {
            line: 193,
            column: 3
          }
        },
        line: 166
      },
      '7': {
        name: '(anonymous_7)',
        decl: {
          start: {
            line: 169,
            column: 52
          },
          end: {
            line: 169,
            column: 53
          }
        },
        loc: {
          start: {
            line: 169,
            column: 63
          },
          end: {
            line: 171,
            column: 7
          }
        },
        line: 169
      },
      '8': {
        name: '(anonymous_8)',
        decl: {
          start: {
            line: 180,
            column: 21
          },
          end: {
            line: 180,
            column: 22
          }
        },
        loc: {
          start: {
            line: 180,
            column: 27
          },
          end: {
            line: 190,
            column: 5
          }
        },
        line: 180
      },
      '9': {
        name: '(anonymous_9)',
        decl: {
          start: {
            line: 206,
            column: 2
          },
          end: {
            line: 206,
            column: 3
          }
        },
        loc: {
          start: {
            line: 206,
            column: 35
          },
          end: {
            line: 214,
            column: 3
          }
        },
        line: 206
      },
      '10': {
        name: '(anonymous_10)',
        decl: {
          start: {
            line: 226,
            column: 2
          },
          end: {
            line: 226,
            column: 3
          }
        },
        loc: {
          start: {
            line: 226,
            column: 60
          },
          end: {
            line: 234,
            column: 3
          }
        },
        line: 226
      },
      '11': {
        name: '(anonymous_11)',
        decl: {
          start: {
            line: 245,
            column: 2
          },
          end: {
            line: 245,
            column: 3
          }
        },
        loc: {
          start: {
            line: 245,
            column: 48
          },
          end: {
            line: 253,
            column: 3
          }
        },
        line: 245
      },
      '12': {
        name: '(anonymous_12)',
        decl: {
          start: {
            line: 264,
            column: 2
          },
          end: {
            line: 264,
            column: 3
          }
        },
        loc: {
          start: {
            line: 264,
            column: 35
          },
          end: {
            line: 272,
            column: 3
          }
        },
        line: 264
      }
    },
    branchMap: {
      '0': {
        loc: {
          start: {
            line: 102,
            column: 4
          },
          end: {
            line: 104,
            column: 5
          }
        },
        type: 'if',
        locations: [{
          start: {
            line: 102,
            column: 4
          },
          end: {
            line: 104,
            column: 5
          }
        }, {
          start: {
            line: 102,
            column: 4
          },
          end: {
            line: 104,
            column: 5
          }
        }],
        line: 102
      },
      '1': {
        loc: {
          start: {
            line: 123,
            column: 4
          },
          end: {
            line: 125,
            column: 5
          }
        },
        type: 'if',
        locations: [{
          start: {
            line: 123,
            column: 4
          },
          end: {
            line: 125,
            column: 5
          }
        }, {
          start: {
            line: 123,
            column: 4
          },
          end: {
            line: 125,
            column: 5
          }
        }],
        line: 123
      },
      '2': {
        loc: {
          start: {
            line: 129,
            column: 4
          },
          end: {
            line: 134,
            column: 5
          }
        },
        type: 'if',
        locations: [{
          start: {
            line: 129,
            column: 4
          },
          end: {
            line: 134,
            column: 5
          }
        }, {
          start: {
            line: 129,
            column: 4
          },
          end: {
            line: 134,
            column: 5
          }
        }],
        line: 129
      },
      '3': {
        loc: {
          start: {
            line: 129,
            column: 8
          },
          end: {
            line: 129,
            column: 72
          }
        },
        type: 'binary-expr',
        locations: [{
          start: {
            line: 129,
            column: 8
          },
          end: {
            line: 129,
            column: 33
          }
        }, {
          start: {
            line: 129,
            column: 37
          },
          end: {
            line: 129,
            column: 72
          }
        }],
        line: 129
      },
      '4': {
        loc: {
          start: {
            line: 137,
            column: 6
          },
          end: {
            line: 140,
            column: 7
          }
        },
        type: 'if',
        locations: [{
          start: {
            line: 137,
            column: 6
          },
          end: {
            line: 140,
            column: 7
          }
        }, {
          start: {
            line: 137,
            column: 6
          },
          end: {
            line: 140,
            column: 7
          }
        }],
        line: 137
      },
      '5': {
        loc: {
          start: {
            line: 143,
            column: 4
          },
          end: {
            line: 145,
            column: 5
          }
        },
        type: 'if',
        locations: [{
          start: {
            line: 143,
            column: 4
          },
          end: {
            line: 145,
            column: 5
          }
        }, {
          start: {
            line: 143,
            column: 4
          },
          end: {
            line: 145,
            column: 5
          }
        }],
        line: 143
      },
      '6': {
        loc: {
          start: {
            line: 143,
            column: 8
          },
          end: {
            line: 143,
            column: 72
          }
        },
        type: 'binary-expr',
        locations: [{
          start: {
            line: 143,
            column: 8
          },
          end: {
            line: 143,
            column: 33
          }
        }, {
          start: {
            line: 143,
            column: 37
          },
          end: {
            line: 143,
            column: 72
          }
        }],
        line: 143
      },
      '7': {
        loc: {
          start: {
            line: 150,
            column: 6
          },
          end: {
            line: 156,
            column: 7
          }
        },
        type: 'if',
        locations: [{
          start: {
            line: 150,
            column: 6
          },
          end: {
            line: 156,
            column: 7
          }
        }, {
          start: {
            line: 150,
            column: 6
          },
          end: {
            line: 156,
            column: 7
          }
        }],
        line: 150
      },
      '8': {
        loc: {
          start: {
            line: 154,
            column: 13
          },
          end: {
            line: 156,
            column: 7
          }
        },
        type: 'if',
        locations: [{
          start: {
            line: 154,
            column: 13
          },
          end: {
            line: 156,
            column: 7
          }
        }, {
          start: {
            line: 154,
            column: 13
          },
          end: {
            line: 156,
            column: 7
          }
        }],
        line: 154
      },
      '9': {
        loc: {
          start: {
            line: 167,
            column: 4
          },
          end: {
            line: 176,
            column: 5
          }
        },
        type: 'if',
        locations: [{
          start: {
            line: 167,
            column: 4
          },
          end: {
            line: 176,
            column: 5
          }
        }, {
          start: {
            line: 167,
            column: 4
          },
          end: {
            line: 176,
            column: 5
          }
        }],
        line: 167
      },
      '10': {
        loc: {
          start: {
            line: 185,
            column: 6
          },
          end: {
            line: 189,
            column: 7
          }
        },
        type: 'if',
        locations: [{
          start: {
            line: 185,
            column: 6
          },
          end: {
            line: 189,
            column: 7
          }
        }, {
          start: {
            line: 185,
            column: 6
          },
          end: {
            line: 189,
            column: 7
          }
        }],
        line: 185
      }
    },
    s: {
      '0': 0,
      '1': 0,
      '2': 0,
      '3': 0,
      '4': 0,
      '5': 0,
      '6': 0,
      '7': 0,
      '8': 0,
      '9': 0,
      '10': 0,
      '11': 0,
      '12': 0,
      '13': 0,
      '14': 0,
      '15': 0,
      '16': 0,
      '17': 0,
      '18': 0,
      '19': 0,
      '20': 0,
      '21': 0,
      '22': 0,
      '23': 0,
      '24': 0,
      '25': 0,
      '26': 0,
      '27': 0,
      '28': 0,
      '29': 0,
      '30': 0,
      '31': 0,
      '32': 0,
      '33': 0,
      '34': 0,
      '35': 0,
      '36': 0,
      '37': 0,
      '38': 0,
      '39': 0,
      '40': 0,
      '41': 0,
      '42': 0,
      '43': 0,
      '44': 0,
      '45': 0,
      '46': 0,
      '47': 0,
      '48': 0,
      '49': 0
    },
    f: {
      '0': 0,
      '1': 0,
      '2': 0,
      '3': 0,
      '4': 0,
      '5': 0,
      '6': 0,
      '7': 0,
      '8': 0,
      '9': 0,
      '10': 0,
      '11': 0,
      '12': 0
    },
    b: {
      '0': [0, 0],
      '1': [0, 0],
      '2': [0, 0],
      '3': [0, 0],
      '4': [0, 0],
      '5': [0, 0],
      '6': [0, 0],
      '7': [0, 0],
      '8': [0, 0],
      '9': [0, 0],
      '10': [0, 0]
    },
    _coverageSchema: '332fd63041d2c1bcb487cc26dd0d5f7d97098a6c'
  },
      coverage = global[gcv] || (global[gcv] = {});

  if (coverage[path] && coverage[path].hash === hash) {
    return coverage[path];
  }

  coverageData.hash = hash;
  return coverage[path] = coverageData;
}();

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.ResizeObservable = exports.PerformanceObservable = exports.MutationObservable = exports.IntersectionObservable = exports._DOMObserverObservable = undefined;

var _rxjsBundlesRxMinJs = require('rxjs/bundles/Rx.min.js');

var _shallowequal;

function _load_shallowequal() {
  return _shallowequal = _interopRequireDefault(require('shallowequal'));
}

var _collection;

function _load_collection() {
  return _collection = require('nuclide-commons/collection');
}

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

/**
 * Creates an observable sequence from a DOM-style Observer.
 *
 * **Use this sparingly: prefer to use the extended, specialized classes below
 *   or add a new one below when a new DOM-style Observer comes along*
 *
 * Emits the same array or EntryList (as with PerformanceObservers) as the
 * original DOM Observable.
 *
 * Known to work with DOM `MutationObserver`, `IntersectionObserver`,
 * `ResizeObserver`, and `PerformanceObserver`
 *
 * A DOM-style Observer is defined as implementing the `DOMObserver` interface
 * below. Here's an example with `MutationObserver`:
 *
 *   const mutations = DOMObserverObservable.create(
 *    MutationObserver,
 *    document.getElementById('bar'),
 *    { attributes: true, childList: true, characterData: true }
 *   );
 *
 *   mutations.subscribe(record => console.log(record));
 *
 * This emits and logs each batch of MutationRecords unmodified as an array. To
 * emit and log each record individually on the observable, call
 * `.flattenEntries()` before subscribing:
 *
 *   const mutations = DOMObserverObservable.create(
 *    MutationObserver,
 *    document.getElementById('bar'),
 *    { attributes: true, childList: true, characterData: true }
 *   ).flattenEntries();
 *
 *   mutations.subscribe(record => console.log(record));
 *
 * This results in MutationRecord objects emitted *individually* and
 * synchonrously every time a mutation occurs.
 *
 * To add additional observations to the observable, use `observe`:
 *
 *   const mutations = DOMObserverObservable.create(MutationObserver)
 *      .observe(
 *        document.getElementById('bar'),
 *        {attributes: true, childList: true, characterData: true}
 *      )
 *      .observe(
 *        document.getElementById('bar'),
 *        {attributes: true}
 *      )
 *      .flattenEntries();
 *
 *   mutations.subscribe(record => console.log(record));
 */

// $FlowFixMe(>=0.55.0) Flow suppress
class DOMObserverObservable extends _rxjsBundlesRxMinJs.Observable {

  constructor(DOMObserverCtor, ...observeArgs) {
    cov_2bako6afgn.f[0]++;
    cov_2bako6afgn.s[0]++;

    super();
    this._observations = [];
    this._refs = 0;
    cov_2bako6afgn.s[1]++;
    this._DOMObserverCtor = DOMObserverCtor;
    cov_2bako6afgn.s[2]++;
    if (observeArgs.length > 0) {
      cov_2bako6afgn.b[0][0]++;
      cov_2bako6afgn.s[3]++;

      this.observe(...observeArgs);
    } else {
      cov_2bako6afgn.b[0][1]++;
    }
  }

  lift(operator) {
    cov_2bako6afgn.f[1]++;

    const obs = (cov_2bako6afgn.s[4]++, new DOMObserverObservable(this._DOMObserverCtor, ...this._observations[0]));
    cov_2bako6afgn.s[5]++;
    obs._observations = this._observations.slice();
    cov_2bako6afgn.s[6]++;
    obs.source = this;
    cov_2bako6afgn.s[7]++;
    obs.operator = operator;
    cov_2bako6afgn.s[8]++;
    return obs;
  }

  observe(...observeArgs) {
    cov_2bako6afgn.f[2]++;
    cov_2bako6afgn.s[9]++;

    this._observations.push(observeArgs);

    cov_2bako6afgn.s[10]++;
    if (this._domObserver != null) {
      cov_2bako6afgn.b[1][0]++;
      cov_2bako6afgn.s[11]++;

      this._domObserver.observe(...observeArgs);
    } else {
      cov_2bako6afgn.b[1][1]++;
    }
  }

  unobserve(...unobserveArgs) {
    cov_2bako6afgn.f[3]++;
    cov_2bako6afgn.s[12]++;

    if ((cov_2bako6afgn.b[3][0]++, this._domObserver != null) && (cov_2bako6afgn.b[3][1]++, this._domObserver.unobserve == null)) {
      cov_2bako6afgn.b[2][0]++;
      cov_2bako6afgn.s[13]++;

      throw new Error(`Cannot unobserve: This observable has an active ${this._DOMObserverCtor.name} and it does not support unobserve`);
    } else {
      cov_2bako6afgn.b[2][1]++;
    }

    cov_2bako6afgn.s[14]++;
    for (let i = 0; i < this._observations.length; i++) {
      cov_2bako6afgn.s[15]++;

      if ((0, (_shallowequal || _load_shallowequal()).default)(this._observations[i], unobserveArgs)) {
        cov_2bako6afgn.b[4][0]++;
        cov_2bako6afgn.s[16]++;

        this._observations.splice(i, 1);
        cov_2bako6afgn.s[17]++;
        break;
      } else {
        cov_2bako6afgn.b[4][1]++;
      }
    }

    cov_2bako6afgn.s[18]++;
    if ((cov_2bako6afgn.b[6][0]++, this._domObserver != null) && (cov_2bako6afgn.b[6][1]++, this._domObserver.unobserve != null)) {
      cov_2bako6afgn.b[5][0]++;
      cov_2bako6afgn.s[19]++;

      this._domObserver.unobserve(...unobserveArgs);
    } else {
      cov_2bako6afgn.b[5][1]++;
    }
  }

  flattenEntries() {
    cov_2bako6afgn.f[4]++;
    cov_2bako6afgn.s[20]++;

    return this.mergeMap(records => {
      cov_2bako6afgn.f[5]++;
      cov_2bako6afgn.s[21]++;

      if ((0, (_collection || _load_collection()).isIterable)(records)) {
        cov_2bako6afgn.b[7][0]++;
        cov_2bako6afgn.s[22]++;

        // $FlowFixMe
        return _rxjsBundlesRxMinJs.Observable.from(records);
        // $FlowFixMe
      } else {
          cov_2bako6afgn.b[7][1]++;
          cov_2bako6afgn.s[23]++;
          if (typeof records.getEntries === 'function') {
            cov_2bako6afgn.b[8][0]++;
            cov_2bako6afgn.s[24]++;

            return _rxjsBundlesRxMinJs.Observable.from(records.getEntries());
          } else {
            cov_2bako6afgn.b[8][1]++;
          }
        }cov_2bako6afgn.s[25]++;
      return _rxjsBundlesRxMinJs.Observable.throw(new Error('Tried to merge DOM Observer entries, but they were not iterable nor were they an EntryList.'));
    });
  }

  _subscribe(subscriber) {
    cov_2bako6afgn.f[6]++;
    cov_2bako6afgn.s[26]++;

    if (this._refs === 0) {
      cov_2bako6afgn.b[9][0]++;
      cov_2bako6afgn.s[27]++;

      if (!(this._domObserver == null)) {
        throw new Error('Invariant violation: "this._domObserver == null"');
      }

      cov_2bako6afgn.s[28]++;

      this._domObserver = new this._DOMObserverCtor(records => {
        cov_2bako6afgn.f[7]++;
        cov_2bako6afgn.s[29]++;

        subscriber.next(records);
      });

      cov_2bako6afgn.s[30]++;
      for (const observation of this._observations) {
        cov_2bako6afgn.s[31]++;

        this._domObserver.observe(...observation);
      }
    } else {
      cov_2bako6afgn.b[9][1]++;
    }

    const subscription = (cov_2bako6afgn.s[32]++, new _rxjsBundlesRxMinJs.Subscription());
    cov_2bako6afgn.s[33]++;
    this._refs++;
    cov_2bako6afgn.s[34]++;
    subscription.add(() => {
      cov_2bako6afgn.f[8]++;
      cov_2bako6afgn.s[35]++;

      this._refs--;

      // the underlying observer should only disconnect when all subscribers have
      // unsubscribed
      cov_2bako6afgn.s[36]++;
      if (this._refs === 0) {
        cov_2bako6afgn.b[10][0]++;
        cov_2bako6afgn.s[37]++;

        if (!(this._domObserver != null)) {
          throw new Error('Invariant violation: "this._domObserver != null"');
        }

        cov_2bako6afgn.s[38]++;

        this._domObserver.disconnect();
        cov_2bako6afgn.s[39]++;
        this._domObserver = null;
      } else {
        cov_2bako6afgn.b[10][1]++;
      }
    });

    cov_2bako6afgn.s[40]++;
    return subscription;
  }
} /**
   * Copyright (c) 2017-present, Facebook, Inc.
   * All rights reserved.
   *
   * This source code is licensed under the BSD-style license found in the
   * LICENSE file in the root directory of this source tree. An additional grant
   * of patent rights can be found in the PATENTS file in the same directory.
   *
   * 
   * @format
   */

/* eslint-env browser */
/* global IntersectionObserver, PerformanceObserver, ResizeObserver */

const _DOMObserverObservable = exports._DOMObserverObservable = (cov_2bako6afgn.s[41]++, DOMObserverObservable);

/**
 * Returns an RxJS Observable that wraps an IntersectionObserver
 */
class IntersectionObservable extends DOMObserverObservable {
  constructor(target) {
    cov_2bako6afgn.f[9]++;
    cov_2bako6afgn.s[42]++;

    if (!(
    // eslint-disable-next-line eqeqeq
    global.IntersectionObserver !== null)) {
      throw new Error('environment must contain IntersectionObserver');
    }
    // $FlowFixMe(>=0.55.0) Flow suppress


    cov_2bako6afgn.s[43]++;
    super(IntersectionObserver, target);
  }
}

exports.IntersectionObservable = IntersectionObservable; /**
                                                          * Returns an RxJS Observable that wraps a MutationObserver
                                                          */

class MutationObservable extends DOMObserverObservable {
  constructor(target, options) {
    cov_2bako6afgn.f[10]++;
    cov_2bako6afgn.s[44]++;

    if (!(
    // eslint-disable-next-line eqeqeq
    global.MutationObserver !== null)) {
      throw new Error('environment must contain MutationObserver');
    }
    // $FlowFixMe(>=0.55.0) Flow suppress


    cov_2bako6afgn.s[45]++;
    super(MutationObserver, target);
  }
}

exports.MutationObservable = MutationObservable; /**
                                                  * Returns an RxJS Observable that wraps a PerformanceObserver
                                                  */

class PerformanceObservable extends DOMObserverObservable {
  constructor(options) {
    cov_2bako6afgn.f[11]++;
    cov_2bako6afgn.s[46]++;

    if (!(
    // eslint-disable-next-line eqeqeq
    global.PerformanceObserver !== null)) {
      throw new Error('environment must contain PerformanceObserver');
    }
    // $FlowFixMe(>=0.55.0) Flow suppress


    cov_2bako6afgn.s[47]++;
    super(PerformanceObserver, options);
  }
}

exports.PerformanceObservable = PerformanceObservable; /**
                                                        * Returns an RxJS Observable that wraps a ResizeObserver
                                                        */

class ResizeObservable extends DOMObserverObservable {
  constructor(target) {
    cov_2bako6afgn.f[12]++;
    cov_2bako6afgn.s[48]++;

    if (!(
    // eslint-disable-next-line eqeqeq
    global.ResizeObserver !== null)) {
      throw new Error('environment must contain ResizeObserver');
    }
    // $FlowFixMe(>=0.55.0) Flow suppress


    cov_2bako6afgn.s[49]++;
    super(ResizeObserver, target);
  }
}
exports.ResizeObservable = ResizeObservable;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm9ic2VydmFibGUtZG9tLmpzIl0sIm5hbWVzIjpbIkRPTU9ic2VydmVyT2JzZXJ2YWJsZSIsImNvbnN0cnVjdG9yIiwiRE9NT2JzZXJ2ZXJDdG9yIiwib2JzZXJ2ZUFyZ3MiLCJfb2JzZXJ2YXRpb25zIiwiX3JlZnMiLCJfRE9NT2JzZXJ2ZXJDdG9yIiwibGVuZ3RoIiwib2JzZXJ2ZSIsImxpZnQiLCJvcGVyYXRvciIsIm9icyIsInNsaWNlIiwic291cmNlIiwicHVzaCIsIl9kb21PYnNlcnZlciIsInVub2JzZXJ2ZSIsInVub2JzZXJ2ZUFyZ3MiLCJFcnJvciIsIm5hbWUiLCJpIiwic3BsaWNlIiwiZmxhdHRlbkVudHJpZXMiLCJtZXJnZU1hcCIsInJlY29yZHMiLCJmcm9tIiwiZ2V0RW50cmllcyIsInRocm93IiwiX3N1YnNjcmliZSIsInN1YnNjcmliZXIiLCJuZXh0Iiwib2JzZXJ2YXRpb24iLCJzdWJzY3JpcHRpb24iLCJhZGQiLCJkaXNjb25uZWN0IiwiX0RPTU9ic2VydmVyT2JzZXJ2YWJsZSIsIkludGVyc2VjdGlvbk9ic2VydmFibGUiLCJ0YXJnZXQiLCJnbG9iYWwiLCJJbnRlcnNlY3Rpb25PYnNlcnZlciIsIk11dGF0aW9uT2JzZXJ2YWJsZSIsIm9wdGlvbnMiLCJNdXRhdGlvbk9ic2VydmVyIiwiUGVyZm9ybWFuY2VPYnNlcnZhYmxlIiwiUGVyZm9ybWFuY2VPYnNlcnZlciIsIlJlc2l6ZU9ic2VydmFibGUiLCJSZXNpemVPYnNlcnZlciJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7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RUFBMkJILE9BQTNCO0FBQ0Q7QUFURDs7UUFKV0UscUIsR0FBQUEscUIsRUFnQmI7Ozs7QUFHTyxNQUFNRSxnQkFBTixTQUErQjdDLHFCQUEvQixDQUlMO0FBQ0FDLGNBQVlvQyxNQUFaLEVBQWlDO0FBQUE7QUFBQTs7QUFBQTtBQUU3QjtBQUNBQyxXQUFPUSxjQUFQLEtBQTBCLElBSEc7QUFBQSxzQkFJN0IseUNBSjZCO0FBQUE7QUFNL0I7OztBQU4rQjtBQU8vQixVQUFNQSxjQUFOLEVBQXNCVCxNQUF0QjtBQUNEO0FBVEQ7UUFKV1EsZ0IsR0FBQUEsZ0IiLCJmaWxlIjoib2JzZXJ2YWJsZS1kb20uanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIENvcHlyaWdodCAoYykgMjAxNy1wcmVzZW50LCBGYWNlYm9vaywgSW5jLlxuICogQWxsIHJpZ2h0cyByZXNlcnZlZC5cbiAqXG4gKiBUaGlzIHNvdXJjZSBjb2RlIGlzIGxpY2Vuc2VkIHVuZGVyIHRoZSBCU0Qtc3R5bGUgbGljZW5zZSBmb3VuZCBpbiB0aGVcbiAqIExJQ0VOU0UgZmlsZSBpbiB0aGUgcm9vdCBkaXJlY3Rvcnkgb2YgdGhpcyBzb3VyY2UgdHJlZS4gQW4gYWRkaXRpb25hbCBncmFudFxuICogb2YgcGF0ZW50IHJpZ2h0cyBjYW4gYmUgZm91bmQgaW4gdGhlIFBBVEVOVFMgZmlsZSBpbiB0aGUgc2FtZSBkaXJlY3RvcnkuXG4gKlxuICogQGZsb3dcbiAqIEBmb3JtYXRcbiAqL1xuXG4vKiBlc2xpbnQtZW52IGJyb3dzZXIgKi9cbi8qIGdsb2JhbCBJbnRlcnNlY3Rpb25PYnNlcnZlciwgUGVyZm9ybWFuY2VPYnNlcnZlciwgUmVzaXplT2JzZXJ2ZXIgKi9cblxuaW1wb3J0IHR5cGUge1N1YnNjcmliZXJ9IGZyb20gJ3J4anMvU3Vic2NyaWJlcic7XG5cbmltcG9ydCBpbnZhcmlhbnQgZnJvbSAnYXNzZXJ0JztcbmltcG9ydCB7T2JzZXJ2YWJsZSwgU3Vic2NyaXB0aW9ufSBmcm9tICdyeGpzJztcbmltcG9ydCBzaGFsbG93RXF1YWwgZnJvbSAnc2hhbGxvd2VxdWFsJztcbmltcG9ydCB7aXNJdGVyYWJsZX0gZnJvbSAnbnVjbGlkZS1jb21tb25zL2NvbGxlY3Rpb24nO1xuXG4vKipcbiAqIENyZWF0ZXMgYW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSBmcm9tIGEgRE9NLXN0eWxlIE9ic2VydmVyLlxuICpcbiAqICoqVXNlIHRoaXMgc3BhcmluZ2x5OiBwcmVmZXIgdG8gdXNlIHRoZSBleHRlbmRlZCwgc3BlY2lhbGl6ZWQgY2xhc3NlcyBiZWxvd1xuICogICBvciBhZGQgYSBuZXcgb25lIGJlbG93IHdoZW4gYSBuZXcgRE9NLXN0eWxlIE9ic2VydmVyIGNvbWVzIGFsb25nKlxuICpcbiAqIEVtaXRzIHRoZSBzYW1lIGFycmF5IG9yIEVudHJ5TGlzdCAoYXMgd2l0aCBQZXJmb3JtYW5jZU9ic2VydmVycykgYXMgdGhlXG4gKiBvcmlnaW5hbCBET00gT2JzZXJ2YWJsZS5cbiAqXG4gKiBLbm93biB0byB3b3JrIHdpdGggRE9NIGBNdXRhdGlvbk9ic2VydmVyYCwgYEludGVyc2VjdGlvbk9ic2VydmVyYCxcbiAqIGBSZXNpemVPYnNlcnZlcmAsIGFuZCBgUGVyZm9ybWFuY2VPYnNlcnZlcmBcbiAqXG4gKiBBIERPTS1zdHlsZSBPYnNlcnZlciBpcyBkZWZpbmVkIGFzIGltcGxlbWVudGluZyB0aGUgYERPTU9ic2VydmVyYCBpbnRlcmZhY2VcbiAqIGJlbG93LiBIZXJlJ3MgYW4gZXhhbXBsZSB3aXRoIGBNdXRhdGlvbk9ic2VydmVyYDpcbiAqXG4gKiAgIGNvbnN0IG11dGF0aW9ucyA9IERPTU9ic2VydmVyT2JzZXJ2YWJsZS5jcmVhdGUoXG4gKiAgICBNdXRhdGlvbk9ic2VydmVyLFxuICogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2JhcicpLFxuICogICAgeyBhdHRyaWJ1dGVzOiB0cnVlLCBjaGlsZExpc3Q6IHRydWUsIGNoYXJhY3RlckRhdGE6IHRydWUgfVxuICogICApO1xuICpcbiAqICAgbXV0YXRpb25zLnN1YnNjcmliZShyZWNvcmQgPT4gY29uc29sZS5sb2cocmVjb3JkKSk7XG4gKlxuICogVGhpcyBlbWl0cyBhbmQgbG9ncyBlYWNoIGJhdGNoIG9mIE11dGF0aW9uUmVjb3JkcyB1bm1vZGlmaWVkIGFzIGFuIGFycmF5LiBUb1xuICogZW1pdCBhbmQgbG9nIGVhY2ggcmVjb3JkIGluZGl2aWR1YWxseSBvbiB0aGUgb2JzZXJ2YWJsZSwgY2FsbFxuICogYC5mbGF0dGVuRW50cmllcygpYCBiZWZvcmUgc3Vic2NyaWJpbmc6XG4gKlxuICogICBjb25zdCBtdXRhdGlvbnMgPSBET01PYnNlcnZlck9ic2VydmFibGUuY3JlYXRlKFxuICogICAgTXV0YXRpb25PYnNlcnZlcixcbiAqICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdiYXInKSxcbiAqICAgIHsgYXR0cmlidXRlczogdHJ1ZSwgY2hpbGRMaXN0OiB0cnVlLCBjaGFyYWN0ZXJEYXRhOiB0cnVlIH1cbiAqICAgKS5mbGF0dGVuRW50cmllcygpO1xuICpcbiAqICAgbXV0YXRpb25zLnN1YnNjcmliZShyZWNvcmQgPT4gY29uc29sZS5sb2cocmVjb3JkKSk7XG4gKlxuICogVGhpcyByZXN1bHRzIGluIE11dGF0aW9uUmVjb3JkIG9iamVjdHMgZW1pdHRlZCAqaW5kaXZpZHVhbGx5KiBhbmRcbiAqIHN5bmNob25yb3VzbHkgZXZlcnkgdGltZSBhIG11dGF0aW9uIG9jY3Vycy5cbiAqXG4gKiBUbyBhZGQgYWRkaXRpb25hbCBvYnNlcnZhdGlvbnMgdG8gdGhlIG9ic2VydmFibGUsIHVzZSBgb2JzZXJ2ZWA6XG4gKlxuICogICBjb25zdCBtdXRhdGlvbnMgPSBET01PYnNlcnZlck9ic2VydmFibGUuY3JlYXRlKE11dGF0aW9uT2JzZXJ2ZXIpXG4gKiAgICAgIC5vYnNlcnZlKFxuICogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdiYXInKSxcbiAqICAgICAgICB7YXR0cmlidXRlczogdHJ1ZSwgY2hpbGRMaXN0OiB0cnVlLCBjaGFyYWN0ZXJEYXRhOiB0cnVlfVxuICogICAgICApXG4gKiAgICAgIC5vYnNlcnZlKFxuICogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdiYXInKSxcbiAqICAgICAgICB7YXR0cmlidXRlczogdHJ1ZX1cbiAqICAgICAgKVxuICogICAgICAuZmxhdHRlbkVudHJpZXMoKTtcbiAqXG4gKiAgIG11dGF0aW9ucy5zdWJzY3JpYmUocmVjb3JkID0+IGNvbnNvbGUubG9nKHJlY29yZCkpO1xuICovXG5cbi8vICRGbG93Rml4TWUoPj0wLjU1LjApIEZsb3cgc3VwcHJlc3NcbnR5cGUgUmVjb3JkQ2FsbGJhY2sgPSAocmVjb3JkczogYW55LCAuLi5yZXN0OiBBcnJheTxhbnk+KSA9PiBtaXhlZDtcbmludGVyZmFjZSBET01PYnNlcnZlciB7XG4gIGNvbnN0cnVjdG9yKGNhbGxiYWNrOiBSZWNvcmRDYWxsYmFjaywgLi4ucmVzdDogQXJyYXk8YW55Pik6IERPTU9ic2VydmVyLFxuICBvYnNlcnZlKC4uLm9ic2VydmVBcmdzOiBBcnJheTxhbnk+KTogdm9pZCxcbiAgZGlzY29ubmVjdCgpOiB2b2lkLFxuICArdW5vYnNlcnZlPzogKC4uLnVub2JzZXJ2ZUFyZ3M6IEFycmF5PGFueT4pID0+IHZvaWQsXG59XG5cbmNsYXNzIERPTU9ic2VydmVyT2JzZXJ2YWJsZTxcbiAgVE5leHQsIC8vIHdoYXQgZG9lcyB0aGlzIG9ic2VydmFibGUgYG5leHQoKWA/XG4gIFRFbnRyeSwgLy8gd2hhdCBpcyBhbiBpbmRpdmlkdWFsIGVudHJ5P1xuICBUT2JzZXJ2ZUFyZ3M6ICRSZWFkT25seUFycmF5PGFueT4sIC8vIHdoYXQgYXJlIHRoZSBhcmd1bWVudHMgdG8gYG9ic2VydmUoKWAgYW5kIGB1bm9ic2VydmVgKCk/XG4+IGV4dGVuZHMgT2JzZXJ2YWJsZTxUTmV4dD4ge1xuICBfRE9NT2JzZXJ2ZXJDdG9yOiBDbGFzczxET01PYnNlcnZlcj47XG4gIF9vYnNlcnZhdGlvbnM6IEFycmF5PFRPYnNlcnZlQXJncz4gPSBbXTtcbiAgX2RvbU9ic2VydmVyOiA/RE9NT2JzZXJ2ZXI7XG4gIF9yZWZzOiBudW1iZXIgPSAwO1xuXG4gIGNvbnN0cnVjdG9yKFxuICAgIERPTU9ic2VydmVyQ3RvcjogQ2xhc3M8RE9NT2JzZXJ2ZXI+LFxuICAgIC4uLm9ic2VydmVBcmdzOiBUT2JzZXJ2ZUFyZ3NcbiAgKTogdm9pZCB7XG4gICAgc3VwZXIoKTtcbiAgICB0aGlzLl9ET01PYnNlcnZlckN0b3IgPSBET01PYnNlcnZlckN0b3I7XG4gICAgaWYgKG9ic2VydmVBcmdzLmxlbmd0aCA+IDApIHtcbiAgICAgIHRoaXMub2JzZXJ2ZSguLi5vYnNlcnZlQXJncyk7XG4gICAgfVxuICB9XG5cbiAgbGlmdDxSLCBTPihcbiAgICBvcGVyYXRvcjogcnhqcyRPcGVyYXRvcjxUTmV4dCwgUj4sXG4gICk6IERPTU9ic2VydmVyT2JzZXJ2YWJsZTxSLCBTLCBUT2JzZXJ2ZUFyZ3M+IHtcbiAgICBjb25zdCBvYnMgPSBuZXcgRE9NT2JzZXJ2ZXJPYnNlcnZhYmxlKFxuICAgICAgdGhpcy5fRE9NT2JzZXJ2ZXJDdG9yLFxuICAgICAgLi4udGhpcy5fb2JzZXJ2YXRpb25zWzBdLFxuICAgICk7XG4gICAgb2JzLl9vYnNlcnZhdGlvbnMgPSB0aGlzLl9vYnNlcnZhdGlvbnMuc2xpY2UoKTtcbiAgICBvYnMuc291cmNlID0gdGhpcztcbiAgICBvYnMub3BlcmF0b3IgPSBvcGVyYXRvcjtcbiAgICByZXR1cm4gb2JzO1xuICB9XG5cbiAgb2JzZXJ2ZSguLi5vYnNlcnZlQXJnczogVE9ic2VydmVBcmdzKTogdm9pZCB7XG4gICAgdGhpcy5fb2JzZXJ2YXRpb25zLnB1c2gob2JzZXJ2ZUFyZ3MpO1xuXG4gICAgaWYgKHRoaXMuX2RvbU9ic2VydmVyICE9IG51bGwpIHtcbiAgICAgIHRoaXMuX2RvbU9ic2VydmVyLm9ic2VydmUoLi4ub2JzZXJ2ZUFyZ3MpO1xuICAgIH1cbiAgfVxuXG4gIHVub2JzZXJ2ZSguLi51bm9ic2VydmVBcmdzOiBUT2JzZXJ2ZUFyZ3MpOiB2b2lkIHtcbiAgICBpZiAodGhpcy5fZG9tT2JzZXJ2ZXIgIT0gbnVsbCAmJiB0aGlzLl9kb21PYnNlcnZlci51bm9ic2VydmUgPT0gbnVsbCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKFxuICAgICAgICBgQ2Fubm90IHVub2JzZXJ2ZTogVGhpcyBvYnNlcnZhYmxlIGhhcyBhbiBhY3RpdmUgJHt0aGlzLl9ET01PYnNlcnZlckN0b3JcbiAgICAgICAgICAubmFtZX0gYW5kIGl0IGRvZXMgbm90IHN1cHBvcnQgdW5vYnNlcnZlYCxcbiAgICAgICk7XG4gICAgfVxuXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLl9vYnNlcnZhdGlvbnMubGVuZ3RoOyBpKyspIHtcbiAgICAgIGlmIChzaGFsbG93RXF1YWwodGhpcy5fb2JzZXJ2YXRpb25zW2ldLCB1bm9ic2VydmVBcmdzKSkge1xuICAgICAgICB0aGlzLl9vYnNlcnZhdGlvbnMuc3BsaWNlKGksIDEpO1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAodGhpcy5fZG9tT2JzZXJ2ZXIgIT0gbnVsbCAmJiB0aGlzLl9kb21PYnNlcnZlci51bm9ic2VydmUgIT0gbnVsbCkge1xuICAgICAgdGhpcy5fZG9tT2JzZXJ2ZXIudW5vYnNlcnZlKC4uLnVub2JzZXJ2ZUFyZ3MpO1xuICAgIH1cbiAgfVxuXG4gIGZsYXR0ZW5FbnRyaWVzKCk6IE9ic2VydmFibGU8VEVudHJ5PiB7XG4gICAgcmV0dXJuIHRoaXMubWVyZ2VNYXAocmVjb3JkcyA9PiB7XG4gICAgICBpZiAoaXNJdGVyYWJsZShyZWNvcmRzKSkge1xuICAgICAgICAvLyAkRmxvd0ZpeE1lXG4gICAgICAgIHJldHVybiBPYnNlcnZhYmxlLmZyb20ocmVjb3Jkcyk7XG4gICAgICAgIC8vICRGbG93Rml4TWVcbiAgICAgIH0gZWxzZSBpZiAodHlwZW9mIHJlY29yZHMuZ2V0RW50cmllcyA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICByZXR1cm4gT2JzZXJ2YWJsZS5mcm9tKHJlY29yZHMuZ2V0RW50cmllcygpKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIE9ic2VydmFibGUudGhyb3coXG4gICAgICAgIG5ldyBFcnJvcihcbiAgICAgICAgICAnVHJpZWQgdG8gbWVyZ2UgRE9NIE9ic2VydmVyIGVudHJpZXMsIGJ1dCB0aGV5IHdlcmUgbm90IGl0ZXJhYmxlIG5vciB3ZXJlIHRoZXkgYW4gRW50cnlMaXN0LicsXG4gICAgICAgICksXG4gICAgICApO1xuICAgIH0pO1xuICB9XG5cbiAgX3N1YnNjcmliZShzdWJzY3JpYmVyOiBTdWJzY3JpYmVyPFROZXh0Pik6IHJ4anMkU3Vic2NyaXB0aW9uIHtcbiAgICBpZiAodGhpcy5fcmVmcyA9PT0gMCkge1xuICAgICAgaW52YXJpYW50KHRoaXMuX2RvbU9ic2VydmVyID09IG51bGwpO1xuICAgICAgdGhpcy5fZG9tT2JzZXJ2ZXIgPSBuZXcgdGhpcy5fRE9NT2JzZXJ2ZXJDdG9yKHJlY29yZHMgPT4ge1xuICAgICAgICBzdWJzY3JpYmVyLm5leHQocmVjb3Jkcyk7XG4gICAgICB9KTtcblxuICAgICAgZm9yIChjb25zdCBvYnNlcnZhdGlvbiBvZiB0aGlzLl9vYnNlcnZhdGlvbnMpIHtcbiAgICAgICAgdGhpcy5fZG9tT2JzZXJ2ZXIub2JzZXJ2ZSguLi5vYnNlcnZhdGlvbik7XG4gICAgICB9XG4gICAgfVxuXG4gICAgY29uc3Qgc3Vic2NyaXB0aW9uID0gbmV3IFN1YnNjcmlwdGlvbigpO1xuICAgIHRoaXMuX3JlZnMrKztcbiAgICBzdWJzY3JpcHRpb24uYWRkKCgpID0+IHtcbiAgICAgIHRoaXMuX3JlZnMtLTtcblxuICAgICAgLy8gdGhlIHVuZGVybHlpbmcgb2JzZXJ2ZXIgc2hvdWxkIG9ubHkgZGlzY29ubmVjdCB3aGVuIGFsbCBzdWJzY3JpYmVycyBoYXZlXG4gICAgICAvLyB1bnN1YnNjcmliZWRcbiAgICAgIGlmICh0aGlzLl9yZWZzID09PSAwKSB7XG4gICAgICAgIGludmFyaWFudCh0aGlzLl9kb21PYnNlcnZlciAhPSBudWxsKTtcbiAgICAgICAgdGhpcy5fZG9tT2JzZXJ2ZXIuZGlzY29ubmVjdCgpO1xuICAgICAgICB0aGlzLl9kb21PYnNlcnZlciA9IG51bGw7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICByZXR1cm4gc3Vic2NyaXB0aW9uO1xuICB9XG59XG5cbmV4cG9ydCBjb25zdCBfRE9NT2JzZXJ2ZXJPYnNlcnZhYmxlID0gRE9NT2JzZXJ2ZXJPYnNlcnZhYmxlO1xuXG4vKipcbiAqIFJldHVybnMgYW4gUnhKUyBPYnNlcnZhYmxlIHRoYXQgd3JhcHMgYW4gSW50ZXJzZWN0aW9uT2JzZXJ2ZXJcbiAqL1xuZXhwb3J0IGNsYXNzIEludGVyc2VjdGlvbk9ic2VydmFibGUgZXh0ZW5kcyBET01PYnNlcnZlck9ic2VydmFibGU8XG4gIEFycmF5PEludGVyc2VjdGlvbk9ic2VydmVyRW50cnk+LFxuICBJbnRlcnNlY3Rpb25PYnNlcnZlckVudHJ5LFxuICBbSFRNTEVsZW1lbnRdLFxuPiB7XG4gIGNvbnN0cnVjdG9yKHRhcmdldDogSFRNTEVsZW1lbnQpIHtcbiAgICBpbnZhcmlhbnQoXG4gICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgZXFlcWVxXG4gICAgICBnbG9iYWwuSW50ZXJzZWN0aW9uT2JzZXJ2ZXIgIT09IG51bGwsXG4gICAgICAnZW52aXJvbm1lbnQgbXVzdCBjb250YWluIEludGVyc2VjdGlvbk9ic2VydmVyJyxcbiAgICApO1xuICAgIC8vICRGbG93Rml4TWUoPj0wLjU1LjApIEZsb3cgc3VwcHJlc3NcbiAgICBzdXBlcihJbnRlcnNlY3Rpb25PYnNlcnZlciwgdGFyZ2V0KTtcbiAgfVxufVxuXG4vKipcbiAqIFJldHVybnMgYW4gUnhKUyBPYnNlcnZhYmxlIHRoYXQgd3JhcHMgYSBNdXRhdGlvbk9ic2VydmVyXG4gKi9cbmV4cG9ydCBjbGFzcyBNdXRhdGlvbk9ic2VydmFibGUgZXh0ZW5kcyBET01PYnNlcnZlck9ic2VydmFibGU8XG4gIEFycmF5PE11dGF0aW9uUmVjb3JkPixcbiAgTXV0YXRpb25SZWNvcmQsXG4gIC8vICRGbG93Rml4TWVcbiAgW05vZGUsIE11dGF0aW9uT2JzZXJ2ZXJJbml0XSxcbj4ge1xuICBjb25zdHJ1Y3Rvcih0YXJnZXQ6IE5vZGUsIG9wdGlvbnM/OiBNdXRhdGlvbk9ic2VydmVySW5pdCkge1xuICAgIGludmFyaWFudChcbiAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBlcWVxZXFcbiAgICAgIGdsb2JhbC5NdXRhdGlvbk9ic2VydmVyICE9PSBudWxsLFxuICAgICAgJ2Vudmlyb25tZW50IG11c3QgY29udGFpbiBNdXRhdGlvbk9ic2VydmVyJyxcbiAgICApO1xuICAgIC8vICRGbG93Rml4TWUoPj0wLjU1LjApIEZsb3cgc3VwcHJlc3NcbiAgICBzdXBlcihNdXRhdGlvbk9ic2VydmVyLCB0YXJnZXQpO1xuICB9XG59XG5cbi8qKlxuICogUmV0dXJucyBhbiBSeEpTIE9ic2VydmFibGUgdGhhdCB3cmFwcyBhIFBlcmZvcm1hbmNlT2JzZXJ2ZXJcbiAqL1xuZXhwb3J0IGNsYXNzIFBlcmZvcm1hbmNlT2JzZXJ2YWJsZSBleHRlbmRzIERPTU9ic2VydmVyT2JzZXJ2YWJsZTxcbiAgUGVyZm9ybWFuY2VPYnNlcnZlckVudHJ5TGlzdCxcbiAgUGVyZm9ybWFuY2VFbnRyeSxcbiAgW1BlcmZvcm1hbmNlT2JzZXJ2ZXJJbml0XSxcbj4ge1xuICBjb25zdHJ1Y3RvcihvcHRpb25zOiBQZXJmb3JtYW5jZU9ic2VydmVySW5pdCkge1xuICAgIGludmFyaWFudChcbiAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBlcWVxZXFcbiAgICAgIGdsb2JhbC5QZXJmb3JtYW5jZU9ic2VydmVyICE9PSBudWxsLFxuICAgICAgJ2Vudmlyb25tZW50IG11c3QgY29udGFpbiBQZXJmb3JtYW5jZU9ic2VydmVyJyxcbiAgICApO1xuICAgIC8vICRGbG93Rml4TWUoPj0wLjU1LjApIEZsb3cgc3VwcHJlc3NcbiAgICBzdXBlcihQZXJmb3JtYW5jZU9ic2VydmVyLCBvcHRpb25zKTtcbiAgfVxufVxuXG4vKipcbiAqIFJldHVybnMgYW4gUnhKUyBPYnNlcnZhYmxlIHRoYXQgd3JhcHMgYSBSZXNpemVPYnNlcnZlclxuICovXG5leHBvcnQgY2xhc3MgUmVzaXplT2JzZXJ2YWJsZSBleHRlbmRzIERPTU9ic2VydmVyT2JzZXJ2YWJsZTxcbiAgQXJyYXk8UmVzaXplT2JzZXJ2ZXJFbnRyeT4sXG4gIFJlc2l6ZU9ic2VydmVyRW50cnksXG4gIFtIVE1MRWxlbWVudF0sXG4+IHtcbiAgY29uc3RydWN0b3IodGFyZ2V0OiBIVE1MRWxlbWVudCkge1xuICAgIGludmFyaWFudChcbiAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBlcWVxZXFcbiAgICAgIGdsb2JhbC5SZXNpemVPYnNlcnZlciAhPT0gbnVsbCxcbiAgICAgICdlbnZpcm9ubWVudCBtdXN0IGNvbnRhaW4gUmVzaXplT2JzZXJ2ZXInLFxuICAgICk7XG4gICAgLy8gJEZsb3dGaXhNZSg+PTAuNTUuMCkgRmxvdyBzdXBwcmVzc1xuICAgIHN1cGVyKFJlc2l6ZU9ic2VydmVyLCB0YXJnZXQpO1xuICB9XG59XG4iXX0=