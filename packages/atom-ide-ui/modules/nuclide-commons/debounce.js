'use strict';

var cov_5l216mf5e = function () {
  var path = '/Users/hansonw/atom-ide-ui/modules/nuclide-commons/debounce.js',
      hash = '7d16867adca010aa268f6cec15967fc82434612b',
      global = new Function('return this')(),
      gcv = '__coverage__',
      coverageData = {
    path: '/Users/hansonw/atom-ide-ui/modules/nuclide-commons/debounce.js',
    statementMap: {
      '0': {
        start: {
          line: 32,
          column: 18
        },
        end: {
          line: 32,
          column: 19
        }
      },
      '1': {
        start: {
          line: 35,
          column: 16
        },
        end: {
          line: 50,
          column: 3
        }
      },
      '2': {
        start: {
          line: 36,
          column: 17
        },
        end: {
          line: 36,
          column: 39
        }
      },
      '3': {
        start: {
          line: 38,
          column: 4
        },
        end: {
          line: 49,
          column: 5
        }
      },
      '4': {
        start: {
          line: 39,
          column: 6
        },
        end: {
          line: 39,
          column: 47
        }
      },
      '5': {
        start: {
          line: 41,
          column: 6
        },
        end: {
          line: 41,
          column: 21
        }
      },
      '6': {
        start: {
          line: 42,
          column: 6
        },
        end: {
          line: 48,
          column: 7
        }
      },
      '7': {
        start: {
          line: 43,
          column: 8
        },
        end: {
          line: 43,
          column: 32
        }
      },
      '8': {
        start: {
          line: 44,
          column: 8
        },
        end: {
          line: 44,
          column: 43
        }
      },
      '9': {
        start: {
          line: 45,
          column: 8
        },
        end: {
          line: 47,
          column: 9
        }
      },
      '10': {
        start: {
          line: 46,
          column: 10
        },
        end: {
          line: 46,
          column: 32
        }
      },
      '11': {
        start: {
          line: 52,
          column: 20
        },
        end: {
          line: 67,
          column: 3
        }
      },
      '12': {
        start: {
          line: 53,
          column: 4
        },
        end: {
          line: 53,
          column: 19
        }
      },
      '13': {
        start: {
          line: 54,
          column: 4
        },
        end: {
          line: 54,
          column: 17
        }
      },
      '14': {
        start: {
          line: 55,
          column: 4
        },
        end: {
          line: 55,
          column: 27
        }
      },
      '15': {
        start: {
          line: 56,
          column: 20
        },
        end: {
          line: 56,
          column: 41
        }
      },
      '16': {
        start: {
          line: 58,
          column: 4
        },
        end: {
          line: 60,
          column: 5
        }
      },
      '17': {
        start: {
          line: 59,
          column: 6
        },
        end: {
          line: 59,
          column: 40
        }
      },
      '18': {
        start: {
          line: 61,
          column: 4
        },
        end: {
          line: 64,
          column: 5
        }
      },
      '19': {
        start: {
          line: 62,
          column: 6
        },
        end: {
          line: 62,
          column: 41
        }
      },
      '20': {
        start: {
          line: 63,
          column: 6
        },
        end: {
          line: 63,
          column: 28
        }
      },
      '21': {
        start: {
          line: 66,
          column: 4
        },
        end: {
          line: 66,
          column: 18
        }
      },
      '22': {
        start: {
          line: 69,
          column: 2
        },
        end: {
          line: 75,
          column: 4
        }
      },
      '23': {
        start: {
          line: 71,
          column: 4
        },
        end: {
          line: 74,
          column: 5
        }
      },
      '24': {
        start: {
          line: 72,
          column: 6
        },
        end: {
          line: 72,
          column: 28
        }
      },
      '25': {
        start: {
          line: 73,
          column: 6
        },
        end: {
          line: 73,
          column: 38
        }
      },
      '26': {
        start: {
          line: 77,
          column: 2
        },
        end: {
          line: 77,
          column: 19
        }
      }
    },
    fnMap: {
      '0': {
        name: 'debounce',
        decl: {
          start: {
            line: 15,
            column: 24
          },
          end: {
            line: 15,
            column: 32
          }
        },
        loc: {
          start: {
            line: 27,
            column: 2
          },
          end: {
            line: 78,
            column: 1
          }
        },
        line: 27
      },
      '1': {
        name: '(anonymous_1)',
        decl: {
          start: {
            line: 35,
            column: 16
          },
          end: {
            line: 35,
            column: 17
          }
        },
        loc: {
          start: {
            line: 35,
            column: 27
          },
          end: {
            line: 50,
            column: 3
          }
        },
        line: 35
      },
      '2': {
        name: '(anonymous_2)',
        decl: {
          start: {
            line: 52,
            column: 20
          },
          end: {
            line: 52,
            column: 21
          }
        },
        loc: {
          start: {
            line: 52,
            column: 62
          },
          end: {
            line: 67,
            column: 3
          }
        },
        line: 52
      },
      '3': {
        name: '(anonymous_3)',
        decl: {
          start: {
            line: 69,
            column: 22
          },
          end: {
            line: 69,
            column: 23
          }
        },
        loc: {
          start: {
            line: 69,
            column: 28
          },
          end: {
            line: 75,
            column: 3
          }
        },
        line: 69
      }
    },
    branchMap: {
      '0': {
        loc: {
          start: {
            line: 23,
            column: 2
          },
          end: {
            line: 23,
            column: 29
          }
        },
        type: 'default-arg',
        locations: [{
          start: {
            line: 23,
            column: 24
          },
          end: {
            line: 23,
            column: 29
          }
        }],
        line: 23
      },
      '1': {
        loc: {
          start: {
            line: 38,
            column: 4
          },
          end: {
            line: 49,
            column: 5
          }
        },
        type: 'if',
        locations: [{
          start: {
            line: 38,
            column: 4
          },
          end: {
            line: 49,
            column: 5
          }
        }, {
          start: {
            line: 38,
            column: 4
          },
          end: {
            line: 49,
            column: 5
          }
        }],
        line: 38
      },
      '2': {
        loc: {
          start: {
            line: 38,
            column: 8
          },
          end: {
            line: 38,
            column: 32
          }
        },
        type: 'binary-expr',
        locations: [{
          start: {
            line: 38,
            column: 8
          },
          end: {
            line: 38,
            column: 19
          }
        }, {
          start: {
            line: 38,
            column: 23
          },
          end: {
            line: 38,
            column: 32
          }
        }],
        line: 38
      },
      '3': {
        loc: {
          start: {
            line: 42,
            column: 6
          },
          end: {
            line: 48,
            column: 7
          }
        },
        type: 'if',
        locations: [{
          start: {
            line: 42,
            column: 6
          },
          end: {
            line: 48,
            column: 7
          }
        }, {
          start: {
            line: 42,
            column: 6
          },
          end: {
            line: 48,
            column: 7
          }
        }],
        line: 42
      },
      '4': {
        loc: {
          start: {
            line: 45,
            column: 8
          },
          end: {
            line: 47,
            column: 9
          }
        },
        type: 'if',
        locations: [{
          start: {
            line: 45,
            column: 8
          },
          end: {
            line: 47,
            column: 9
          }
        }, {
          start: {
            line: 45,
            column: 8
          },
          end: {
            line: 47,
            column: 9
          }
        }],
        line: 45
      },
      '5': {
        loc: {
          start: {
            line: 56,
            column: 20
          },
          end: {
            line: 56,
            column: 41
          }
        },
        type: 'binary-expr',
        locations: [{
          start: {
            line: 56,
            column: 20
          },
          end: {
            line: 56,
            column: 29
          }
        }, {
          start: {
            line: 56,
            column: 33
          },
          end: {
            line: 56,
            column: 41
          }
        }],
        line: 56
      },
      '6': {
        loc: {
          start: {
            line: 58,
            column: 4
          },
          end: {
            line: 60,
            column: 5
          }
        },
        type: 'if',
        locations: [{
          start: {
            line: 58,
            column: 4
          },
          end: {
            line: 60,
            column: 5
          }
        }, {
          start: {
            line: 58,
            column: 4
          },
          end: {
            line: 60,
            column: 5
          }
        }],
        line: 58
      },
      '7': {
        loc: {
          start: {
            line: 61,
            column: 4
          },
          end: {
            line: 64,
            column: 5
          }
        },
        type: 'if',
        locations: [{
          start: {
            line: 61,
            column: 4
          },
          end: {
            line: 64,
            column: 5
          }
        }, {
          start: {
            line: 61,
            column: 4
          },
          end: {
            line: 64,
            column: 5
          }
        }],
        line: 61
      },
      '8': {
        loc: {
          start: {
            line: 71,
            column: 4
          },
          end: {
            line: 74,
            column: 5
          }
        },
        type: 'if',
        locations: [{
          start: {
            line: 71,
            column: 4
          },
          end: {
            line: 74,
            column: 5
          }
        }, {
          start: {
            line: 71,
            column: 4
          },
          end: {
            line: 74,
            column: 5
          }
        }],
        line: 71
      }
    },
    s: {
      '0': 0,
      '1': 0,
      '2': 0,
      '3': 0,
      '4': 0,
      '5': 0,
      '6': 0,
      '7': 0,
      '8': 0,
      '9': 0,
      '10': 0,
      '11': 0,
      '12': 0,
      '13': 0,
      '14': 0,
      '15': 0,
      '16': 0,
      '17': 0,
      '18': 0,
      '19': 0,
      '20': 0,
      '21': 0,
      '22': 0,
      '23': 0,
      '24': 0,
      '25': 0,
      '26': 0
    },
    f: {
      '0': 0,
      '1': 0,
      '2': 0,
      '3': 0
    },
    b: {
      '0': [0],
      '1': [0, 0],
      '2': [0, 0],
      '3': [0, 0],
      '4': [0, 0],
      '5': [0, 0],
      '6': [0, 0],
      '7': [0, 0],
      '8': [0, 0]
    },
    _coverageSchema: '332fd63041d2c1bcb487cc26dd0d5f7d97098a6c'
  },
      coverage = global[gcv] || (global[gcv] = {});

  if (coverage[path] && coverage[path].hash === hash) {
    return coverage[path];
  }

  coverageData.hash = hash;
  return coverage[path] = coverageData;
}();

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = debounce;
function debounce(func, wait, immediate = (cov_5l216mf5e.b[0][0]++, false)) {
  cov_5l216mf5e.f[0]++;

  // Taken from: https://github.com/jashkenas/underscore/blob/b10b2e6d72/underscore.js#L815.
  let timeout;
  let args;
  let context;
  let timestamp = (cov_5l216mf5e.s[0]++, 0);
  let result;

  cov_5l216mf5e.s[1]++;
  const later = function () {
    cov_5l216mf5e.f[1]++;

    const last = (cov_5l216mf5e.s[2]++, Date.now() - timestamp);

    cov_5l216mf5e.s[3]++;
    if ((cov_5l216mf5e.b[2][0]++, last < wait) && (cov_5l216mf5e.b[2][1]++, last >= 0)) {
      cov_5l216mf5e.b[1][0]++;
      cov_5l216mf5e.s[4]++;

      timeout = setTimeout(later, wait - last);
    } else {
      cov_5l216mf5e.b[1][1]++;
      cov_5l216mf5e.s[5]++;

      timeout = null;
      cov_5l216mf5e.s[6]++;
      if (!immediate) {
        cov_5l216mf5e.b[3][0]++;
        cov_5l216mf5e.s[7]++;

        if (!(args != null)) {
          throw new Error('Invariant violation: "args != null"');
        }

        cov_5l216mf5e.s[8]++;

        result = func.apply(context, args);
        cov_5l216mf5e.s[9]++;
        if (!timeout) {
          cov_5l216mf5e.b[4][0]++;
          cov_5l216mf5e.s[10]++;

          context = args = null;
        } else {
          cov_5l216mf5e.b[4][1]++;
        }
      } else {
        cov_5l216mf5e.b[3][1]++;
      }
    }
  };

  cov_5l216mf5e.s[11]++;
  const debounced = function (...args_) {
    cov_5l216mf5e.f[2]++;
    cov_5l216mf5e.s[12]++;

    context = this;
    cov_5l216mf5e.s[13]++;
    args = args_;
    cov_5l216mf5e.s[14]++;
    timestamp = Date.now();
    const callNow = (cov_5l216mf5e.s[15]++, (cov_5l216mf5e.b[5][0]++, immediate) && (cov_5l216mf5e.b[5][1]++, !timeout));
    // flowlint-next-line sketchy-null-number:off
    cov_5l216mf5e.s[16]++;
    if (!timeout) {
      cov_5l216mf5e.b[6][0]++;
      cov_5l216mf5e.s[17]++;

      timeout = setTimeout(later, wait);
    } else {
      cov_5l216mf5e.b[6][1]++;
    }
    cov_5l216mf5e.s[18]++;
    if (callNow) {
      cov_5l216mf5e.b[7][0]++;
      cov_5l216mf5e.s[19]++;

      result = func.apply(context, args);
      cov_5l216mf5e.s[20]++;
      context = args = null;
    } else {
      cov_5l216mf5e.b[7][1]++;
    }

    cov_5l216mf5e.s[21]++;
    return result;
  };

  cov_5l216mf5e.s[22]++;
  debounced.dispose = () => {
    cov_5l216mf5e.f[3]++;
    cov_5l216mf5e.s[23]++;

    // flowlint-next-line sketchy-null-number:off
    if (timeout) {
      cov_5l216mf5e.b[8][0]++;
      cov_5l216mf5e.s[24]++;

      clearTimeout(timeout);
      cov_5l216mf5e.s[25]++;
      timeout = context = args = null;
    } else {
      cov_5l216mf5e.b[8][1]++;
    }
  };

  cov_5l216mf5e.s[26]++;
  return debounced;
} /**
   * Copyright (c) 2017-present, Facebook, Inc.
   * All rights reserved.
   *
   * This source code is licensed under the BSD-style license found in the
   * LICENSE file in the root directory of this source tree. An additional grant
   * of patent rights can be found in the PATENTS file in the same directory.
   *
   * 
   * @format
   */
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImRlYm91bmNlLmpzIl0sIm5hbWVzIjpbImRlYm91bmNlIiwiZnVuYyIsIndhaXQiLCJpbW1lZGlhdGUiLCJ0aW1lb3V0IiwiYXJncyIsImNvbnRleHQiLCJ0aW1lc3RhbXAiLCJyZXN1bHQiLCJsYXRlciIsImxhc3QiLCJEYXRlIiwibm93Iiwic2V0VGltZW91dCIsImFwcGx5IiwiZGVib3VuY2VkIiwiYXJnc18iLCJjYWxsTm93IiwiZGlzcG9zZSIsImNsZWFyVGltZW91dCJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztrQkFjd0JBLFE7QUFBVCxTQUFTQSxRQUFULENBTWJDLElBTmEsRUFPYkMsSUFQYSxFQVFiQyxzQ0FBc0IsS0FBdEIsQ0FSYSxFQVliO0FBQUE7O0FBQ0E7QUFDQSxNQUFJQyxPQUFKO0FBQ0EsTUFBSUMsSUFBSjtBQUNBLE1BQUlDLE9BQUo7QUFDQSxNQUFJQyxtQ0FBWSxDQUFaLENBQUo7QUFDQSxNQUFJQyxNQUFKOztBQU5BO0FBUUEsUUFBTUMsUUFBUSxZQUFXO0FBQUE7O0FBQ3ZCLFVBQU1DLDhCQUFPQyxLQUFLQyxHQUFMLEtBQWFMLFNBQXBCLENBQU47O0FBRHVCO0FBR3ZCLFFBQUksaUNBQU9MLElBQVAsK0JBQWVRLFFBQVEsQ0FBdkIsQ0FBSixFQUE4QjtBQUFBO0FBQUE7O0FBQzVCTixnQkFBVVMsV0FBV0osS0FBWCxFQUFrQlAsT0FBT1EsSUFBekIsQ0FBVjtBQUNELEtBRkQsTUFFTztBQUFBO0FBQUE7O0FBQ0xOLGdCQUFVLElBQVY7QUFESztBQUVMLFVBQUksQ0FBQ0QsU0FBTCxFQUFnQjtBQUFBO0FBQUE7O0FBQUEsY0FDSkUsUUFBUSxJQURKO0FBQUE7QUFBQTs7QUFBQTs7QUFFZEcsaUJBQVNQLEtBQUthLEtBQUwsQ0FBV1IsT0FBWCxFQUFvQkQsSUFBcEIsQ0FBVDtBQUZjO0FBR2QsWUFBSSxDQUFDRCxPQUFMLEVBQWM7QUFBQTtBQUFBOztBQUNaRSxvQkFBVUQsT0FBTyxJQUFqQjtBQUNELFNBRkQ7QUFBQTtBQUFBO0FBR0QsT0FORDtBQUFBO0FBQUE7QUFPRDtBQUNGLEdBZkQ7O0FBUkE7QUF5QkEsUUFBTVUsWUFBWSxVQUFTLEdBQUdDLEtBQVosRUFBMEM7QUFBQTtBQUFBOztBQUMxRFYsY0FBVSxJQUFWO0FBRDBEO0FBRTFERCxXQUFPVyxLQUFQO0FBRjBEO0FBRzFEVCxnQkFBWUksS0FBS0MsR0FBTCxFQUFaO0FBQ0EsVUFBTUssa0NBQVUsa0VBQWEsQ0FBQ2IsT0FBZCxDQUFWLENBQU47QUFDQTtBQUwwRDtBQU0xRCxRQUFJLENBQUNBLE9BQUwsRUFBYztBQUFBO0FBQUE7O0FBQ1pBLGdCQUFVUyxXQUFXSixLQUFYLEVBQWtCUCxJQUFsQixDQUFWO0FBQ0QsS0FGRDtBQUFBO0FBQUE7QUFOMEQ7QUFTMUQsUUFBSWUsT0FBSixFQUFhO0FBQUE7QUFBQTs7QUFDWFQsZUFBU1AsS0FBS2EsS0FBTCxDQUFXUixPQUFYLEVBQW9CRCxJQUFwQixDQUFUO0FBRFc7QUFFWEMsZ0JBQVVELE9BQU8sSUFBakI7QUFDRCxLQUhEO0FBQUE7QUFBQTs7QUFUMEQ7QUFjMUQsV0FBT0csTUFBUDtBQUNELEdBZkQ7O0FBekJBO0FBMENBTyxZQUFVRyxPQUFWLEdBQW9CLE1BQU07QUFBQTtBQUFBOztBQUN4QjtBQUNBLFFBQUlkLE9BQUosRUFBYTtBQUFBO0FBQUE7O0FBQ1hlLG1CQUFhZixPQUFiO0FBRFc7QUFFWEEsZ0JBQVVFLFVBQVVELE9BQU8sSUFBM0I7QUFDRCxLQUhEO0FBQUE7QUFBQTtBQUlELEdBTkQ7O0FBMUNBO0FBa0RBLFNBQU9VLFNBQVA7QUFDRCxDLENBN0VEIiwiZmlsZSI6ImRlYm91bmNlLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTctcHJlc2VudCwgRmFjZWJvb2ssIEluYy5cbiAqIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4gKlxuICogVGhpcyBzb3VyY2UgY29kZSBpcyBsaWNlbnNlZCB1bmRlciB0aGUgQlNELXN0eWxlIGxpY2Vuc2UgZm91bmQgaW4gdGhlXG4gKiBMSUNFTlNFIGZpbGUgaW4gdGhlIHJvb3QgZGlyZWN0b3J5IG9mIHRoaXMgc291cmNlIHRyZWUuIEFuIGFkZGl0aW9uYWwgZ3JhbnRcbiAqIG9mIHBhdGVudCByaWdodHMgY2FuIGJlIGZvdW5kIGluIHRoZSBQQVRFTlRTIGZpbGUgaW4gdGhlIHNhbWUgZGlyZWN0b3J5LlxuICpcbiAqIEBmbG93XG4gKiBAZm9ybWF0XG4gKi9cblxuaW1wb3J0IGludmFyaWFudCBmcm9tICdhc3NlcnQnO1xuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBkZWJvdW5jZTxcbiAgVCxcbiAgVEFyZ3M6IEFycmF5PFQ+LFxuICBUUmV0dXJuLFxuICBURnVuYzogKC4uLlRBcmdzKSA9PiBUUmV0dXJuLCAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIHNwYWNlLWJlZm9yZS1mdW5jdGlvbi1wYXJlblxuPihcbiAgZnVuYzogVEZ1bmMsXG4gIHdhaXQ6IG51bWJlcixcbiAgaW1tZWRpYXRlPzogYm9vbGVhbiA9IGZhbHNlLFxuKToge1xuICAoLi4uVEFyZ3MpOiBUUmV0dXJuIHwgdm9pZCxcbiAgZGlzcG9zZSgpOiB2b2lkLFxufSB7XG4gIC8vIFRha2VuIGZyb206IGh0dHBzOi8vZ2l0aHViLmNvbS9qYXNoa2VuYXMvdW5kZXJzY29yZS9ibG9iL2IxMGIyZTZkNzIvdW5kZXJzY29yZS5qcyNMODE1LlxuICBsZXQgdGltZW91dDogP251bWJlcjtcbiAgbGV0IGFyZ3M6ID9UQXJncztcbiAgbGV0IGNvbnRleHQ6IGFueTtcbiAgbGV0IHRpbWVzdGFtcCA9IDA7XG4gIGxldCByZXN1bHQ6IFRSZXR1cm4gfCB2b2lkO1xuXG4gIGNvbnN0IGxhdGVyID0gZnVuY3Rpb24oKSB7XG4gICAgY29uc3QgbGFzdCA9IERhdGUubm93KCkgLSB0aW1lc3RhbXA7XG5cbiAgICBpZiAobGFzdCA8IHdhaXQgJiYgbGFzdCA+PSAwKSB7XG4gICAgICB0aW1lb3V0ID0gc2V0VGltZW91dChsYXRlciwgd2FpdCAtIGxhc3QpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aW1lb3V0ID0gbnVsbDtcbiAgICAgIGlmICghaW1tZWRpYXRlKSB7XG4gICAgICAgIGludmFyaWFudChhcmdzICE9IG51bGwpO1xuICAgICAgICByZXN1bHQgPSBmdW5jLmFwcGx5KGNvbnRleHQsIGFyZ3MpO1xuICAgICAgICBpZiAoIXRpbWVvdXQpIHtcbiAgICAgICAgICBjb250ZXh0ID0gYXJncyA9IG51bGw7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH07XG5cbiAgY29uc3QgZGVib3VuY2VkID0gZnVuY3Rpb24oLi4uYXJnc186IFRBcmdzKTogVFJldHVybiB8IHZvaWQge1xuICAgIGNvbnRleHQgPSB0aGlzO1xuICAgIGFyZ3MgPSBhcmdzXztcbiAgICB0aW1lc3RhbXAgPSBEYXRlLm5vdygpO1xuICAgIGNvbnN0IGNhbGxOb3cgPSBpbW1lZGlhdGUgJiYgIXRpbWVvdXQ7XG4gICAgLy8gZmxvd2xpbnQtbmV4dC1saW5lIHNrZXRjaHktbnVsbC1udW1iZXI6b2ZmXG4gICAgaWYgKCF0aW1lb3V0KSB7XG4gICAgICB0aW1lb3V0ID0gc2V0VGltZW91dChsYXRlciwgd2FpdCk7XG4gICAgfVxuICAgIGlmIChjYWxsTm93KSB7XG4gICAgICByZXN1bHQgPSBmdW5jLmFwcGx5KGNvbnRleHQsIGFyZ3MpO1xuICAgICAgY29udGV4dCA9IGFyZ3MgPSBudWxsO1xuICAgIH1cblxuICAgIHJldHVybiByZXN1bHQ7XG4gIH07XG5cbiAgZGVib3VuY2VkLmRpc3Bvc2UgPSAoKSA9PiB7XG4gICAgLy8gZmxvd2xpbnQtbmV4dC1saW5lIHNrZXRjaHktbnVsbC1udW1iZXI6b2ZmXG4gICAgaWYgKHRpbWVvdXQpIHtcbiAgICAgIGNsZWFyVGltZW91dCh0aW1lb3V0KTtcbiAgICAgIHRpbWVvdXQgPSBjb250ZXh0ID0gYXJncyA9IG51bGw7XG4gICAgfVxuICB9O1xuXG4gIHJldHVybiBkZWJvdW5jZWQ7XG59XG4iXX0=