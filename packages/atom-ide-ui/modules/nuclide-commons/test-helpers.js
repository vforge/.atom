'use strict';

var cov_1avtcq9yoi = function () {
  var path = '/Users/hansonw/atom-ide-ui/modules/nuclide-commons/test-helpers.js',
      hash = '3566a6d97b71ee0a4efc78231dd936e965790d84',
      global = new Function('return this')(),
      gcv = '__coverage__',
      coverageData = {
    path: '/Users/hansonw/atom-ide-ui/modules/nuclide-commons/test-helpers.js',
    statementMap: {
      '0': {
        start: {
          line: 23,
          column: 0
        },
        end: {
          line: 27,
          column: 2
        }
      },
      '1': {
        start: {
          line: 46,
          column: 2
        },
        end: {
          line: 53,
          column: 3
        }
      },
      '2': {
        start: {
          line: 47,
          column: 4
        },
        end: {
          line: 47,
          column: 18
        }
      },
      '3': {
        start: {
          line: 48,
          column: 4
        },
        end: {
          line: 50,
          column: 6
        }
      },
      '4': {
        start: {
          line: 52,
          column: 4
        },
        end: {
          line: 52,
          column: 14
        }
      },
      '5': {
        start: {
          line: 66,
          column: 2
        },
        end: {
          line: 66,
          column: 48
        }
      },
      '6': {
        start: {
          line: 70,
          column: 2
        },
        end: {
          line: 70,
          column: 37
        }
      },
      '7': {
        start: {
          line: 72,
          column: 2
        },
        end: {
          line: 72,
          column: 25
        }
      },
      '8': {
        start: {
          line: 87,
          column: 16
        },
        end: {
          line: 87,
          column: 25
        }
      },
      '9': {
        start: {
          line: 88,
          column: 2
        },
        end: {
          line: 88,
          column: 19
        }
      },
      '10': {
        start: {
          line: 89,
          column: 2
        },
        end: {
          line: 89,
          column: 20
        }
      },
      '11': {
        start: {
          line: 90,
          column: 2
        },
        end: {
          line: 90,
          column: 26
        }
      },
      '12': {
        start: {
          line: 98,
          column: 19
        },
        end: {
          line: 98,
          column: 28
        }
      },
      '13': {
        start: {
          line: 100,
          column: 4
        },
        end: {
          line: 102,
          column: 5
        }
      },
      '14': {
        start: {
          line: 101,
          column: 6
        },
        end: {
          line: 101,
          column: 25
        }
      },
      '15': {
        start: {
          line: 104,
          column: 2
        },
        end: {
          line: 104,
          column: 36
        }
      },
      '16': {
        start: {
          line: 105,
          column: 2
        },
        end: {
          line: 109,
          column: 3
        }
      },
      '17': {
        start: {
          line: 106,
          column: 4
        },
        end: {
          line: 108,
          column: 5
        }
      },
      '18': {
        start: {
          line: 107,
          column: 6
        },
        end: {
          line: 107,
          column: 19
        }
      },
      '19': {
        start: {
          line: 110,
          column: 2
        },
        end: {
          line: 110,
          column: 14
        }
      },
      '20': {
        start: {
          line: 121,
          column: 27
        },
        end: {
          line: 124,
          column: 16
        }
      },
      '21': {
        start: {
          line: 125,
          column: 2
        },
        end: {
          line: 125,
          column: 35
        }
      },
      '22': {
        start: {
          line: 146,
          column: 2
        },
        end: {
          line: 146,
          column: 15
        }
      },
      '23': {
        start: {
          line: 148,
          column: 34
        },
        end: {
          line: 148,
          column: 37
        }
      },
      '24': {
        start: {
          line: 149,
          column: 18
        },
        end: {
          line: 149,
          column: 54
        }
      },
      '25': {
        start: {
          line: 151,
          column: 2
        },
        end: {
          line: 153,
          column: 3
        }
      },
      '26': {
        start: {
          line: 152,
          column: 4
        },
        end: {
          line: 152,
          column: 19
        }
      },
      '27': {
        start: {
          line: 156,
          column: 21
        },
        end: {
          line: 160,
          column: 4
        }
      },
      '28': {
        start: {
          line: 158,
          column: 4
        },
        end: {
          line: 158,
          column: 50
        }
      },
      '29': {
        start: {
          line: 159,
          column: 4
        },
        end: {
          line: 159,
          column: 17
        }
      },
      '30': {
        start: {
          line: 163,
          column: 21
        },
        end: {
          line: 165,
          column: 60
        }
      },
      '31': {
        start: {
          line: 164,
          column: 25
        },
        end: {
          line: 164,
          column: 53
        }
      },
      '32': {
        start: {
          line: 165,
          column: 33
        },
        end: {
          line: 165,
          column: 59
        }
      },
      '33': {
        start: {
          line: 167,
          column: 2
        },
        end: {
          line: 169,
          column: 4
        }
      },
      '34': {
        start: {
          line: 168,
          column: 4
        },
        end: {
          line: 168,
          column: 29
        }
      },
      '35': {
        start: {
          line: 171,
          column: 2
        },
        end: {
          line: 189,
          column: 4
        }
      },
      '36': {
        start: {
          line: 179,
          column: 6
        },
        end: {
          line: 187,
          column: 9
        }
      },
      '37': {
        start: {
          line: 180,
          column: 8
        },
        end: {
          line: 186,
          column: 11
        }
      },
      '38': {
        start: {
          line: 181,
          column: 10
        },
        end: {
          line: 185,
          column: 11
        }
      },
      '39': {
        start: {
          line: 182,
          column: 12
        },
        end: {
          line: 182,
          column: 24
        }
      },
      '40': {
        start: {
          line: 184,
          column: 12
        },
        end: {
          line: 184,
          column: 22
        }
      },
      '41': {
        start: {
          line: 191,
          column: 2
        },
        end: {
          line: 191,
          column: 17
        }
      },
      '42': {
        start: {
          line: 195,
          column: 25
        },
        end: {
          line: 195,
          column: 36
        }
      },
      '43': {
        start: {
          line: 196,
          column: 2
        },
        end: {
          line: 204,
          column: 3
        }
      },
      '44': {
        start: {
          line: 197,
          column: 21
        },
        end: {
          line: 197,
          column: 40
        }
      },
      '45': {
        start: {
          line: 198,
          column: 4
        },
        end: {
          line: 203,
          column: 5
        }
      },
      '46': {
        start: {
          line: 199,
          column: 6
        },
        end: {
          line: 202,
          column: 8
        }
      }
    },
    fnMap: {
      '0': {
        name: 'expectAsyncFailure',
        decl: {
          start: {
            line: 42,
            column: 22
          },
          end: {
            line: 42,
            column: 40
          }
        },
        loc: {
          start: {
            line: 45,
            column: 16
          },
          end: {
            line: 54,
            column: 1
          }
        },
        line: 45
      },
      '1': {
        name: 'clearRequireCache',
        decl: {
          start: {
            line: 65,
            column: 16
          },
          end: {
            line: 65,
            column: 33
          }
        },
        loc: {
          start: {
            line: 65,
            column: 73
          },
          end: {
            line: 67,
            column: 1
          }
        },
        line: 65
      },
      '2': {
        name: 'uncachedRequire',
        decl: {
          start: {
            line: 69,
            column: 16
          },
          end: {
            line: 69,
            column: 31
          }
        },
        loc: {
          start: {
            line: 69,
            column: 72
          },
          end: {
            line: 73,
            column: 1
          }
        },
        line: 69
      },
      '3': {
        name: 'spyOnGetterValue',
        decl: {
          start: {
            line: 86,
            column: 16
          },
          end: {
            line: 86,
            column: 32
          }
        },
        loc: {
          start: {
            line: 86,
            column: 72
          },
          end: {
            line: 91,
            column: 1
          }
        },
        line: 86
      },
      '4': {
        name: 'arePropertiesEqual',
        decl: {
          start: {
            line: 97,
            column: 16
          },
          end: {
            line: 97,
            column: 34
          }
        },
        loc: {
          start: {
            line: 97,
            column: 72
          },
          end: {
            line: 111,
            column: 1
          }
        },
        line: 97
      },
      '5': {
        name: 'addAllProps',
        decl: {
          start: {
            line: 99,
            column: 11
          },
          end: {
            line: 99,
            column: 22
          }
        },
        loc: {
          start: {
            line: 99,
            column: 28
          },
          end: {
            line: 103,
            column: 3
          }
        },
        line: 99
      },
      '6': {
        name: 'expectObservableToStartWith',
        decl: {
          start: {
            line: 117,
            column: 22
          },
          end: {
            line: 117,
            column: 49
          }
        },
        loc: {
          start: {
            line: 120,
            column: 17
          },
          end: {
            line: 126,
            column: 1
          }
        },
        line: 120
      },
      '7': {
        name: 'generateFixture',
        decl: {
          start: {
            line: 142,
            column: 22
          },
          end: {
            line: 142,
            column: 37
          }
        },
        loc: {
          start: {
            line: 145,
            column: 19
          },
          end: {
            line: 192,
            column: 1
          }
        },
        line: 145
      },
      '8': {
        name: '(anonymous_8)',
        decl: {
          start: {
            line: 156,
            column: 39
          },
          end: {
            line: 156,
            column: 40
          }
        },
        loc: {
          start: {
            line: 156,
            column: 48
          },
          end: {
            line: 160,
            column: 3
          }
        },
        line: 156
      },
      '9': {
        name: '(anonymous_9)',
        decl: {
          start: {
            line: 164,
            column: 9
          },
          end: {
            line: 164,
            column: 10
          }
        },
        loc: {
          start: {
            line: 164,
            column: 25
          },
          end: {
            line: 164,
            column: 53
          }
        },
        line: 164
      },
      '10': {
        name: '(anonymous_10)',
        decl: {
          start: {
            line: 165,
            column: 12
          },
          end: {
            line: 165,
            column: 13
          }
        },
        loc: {
          start: {
            line: 165,
            column: 33
          },
          end: {
            line: 165,
            column: 59
          }
        },
        line: 165
      },
      '11': {
        name: '(anonymous_11)',
        decl: {
          start: {
            line: 167,
            column: 56
          },
          end: {
            line: 167,
            column: 57
          }
        },
        loc: {
          start: {
            line: 168,
            column: 4
          },
          end: {
            line: 168,
            column: 29
          }
        },
        line: 168
      },
      '12': {
        name: '(anonymous_12)',
        decl: {
          start: {
            line: 174,
            column: 4
          },
          end: {
            line: 174,
            column: 5
          }
        },
        loc: {
          start: {
            line: 174,
            column: 30
          },
          end: {
            line: 188,
            column: 5
          }
        },
        line: 174
      },
      '13': {
        name: '(anonymous_13)',
        decl: {
          start: {
            line: 179,
            column: 25
          },
          end: {
            line: 179,
            column: 26
          }
        },
        loc: {
          start: {
            line: 179,
            column: 46
          },
          end: {
            line: 187,
            column: 7
          }
        },
        line: 179
      },
      '14': {
        name: '(anonymous_14)',
        decl: {
          start: {
            line: 180,
            column: 47
          },
          end: {
            line: 180,
            column: 48
          }
        },
        loc: {
          start: {
            line: 180,
            column: 54
          },
          end: {
            line: 186,
            column: 9
          }
        },
        line: 180
      },
      '15': {
        name: 'writeCoverage',
        decl: {
          start: {
            line: 194,
            column: 16
          },
          end: {
            line: 194,
            column: 29
          }
        },
        loc: {
          start: {
            line: 194,
            column: 38
          },
          end: {
            line: 205,
            column: 1
          }
        },
        line: 194
      }
    },
    branchMap: {
      '0': {
        loc: {
          start: {
            line: 24,
            column: 2
          },
          end: {
            line: 25,
            column: 35
          }
        },
        type: 'binary-expr',
        locations: [{
          start: {
            line: 24,
            column: 3
          },
          end: {
            line: 24,
            column: 30
          }
        }, {
          start: {
            line: 24,
            column: 34
          },
          end: {
            line: 24,
            column: 51
          }
        }, {
          start: {
            line: 25,
            column: 4
          },
          end: {
            line: 25,
            column: 35
          }
        }],
        line: 24
      },
      '1': {
        loc: {
          start: {
            line: 106,
            column: 4
          },
          end: {
            line: 108,
            column: 5
          }
        },
        type: 'if',
        locations: [{
          start: {
            line: 106,
            column: 4
          },
          end: {
            line: 108,
            column: 5
          }
        }, {
          start: {
            line: 106,
            column: 4
          },
          end: {
            line: 108,
            column: 5
          }
        }],
        line: 106
      },
      '2': {
        loc: {
          start: {
            line: 151,
            column: 2
          },
          end: {
            line: 153,
            column: 3
          }
        },
        type: 'if',
        locations: [{
          start: {
            line: 151,
            column: 2
          },
          end: {
            line: 153,
            column: 3
          }
        }, {
          start: {
            line: 151,
            column: 2
          },
          end: {
            line: 153,
            column: 3
          }
        }],
        line: 151
      },
      '3': {
        loc: {
          start: {
            line: 180,
            column: 31
          },
          end: {
            line: 180,
            column: 45
          }
        },
        type: 'binary-expr',
        locations: [{
          start: {
            line: 180,
            column: 31
          },
          end: {
            line: 180,
            column: 39
          }
        }, {
          start: {
            line: 180,
            column: 43
          },
          end: {
            line: 180,
            column: 45
          }
        }],
        line: 180
      },
      '4': {
        loc: {
          start: {
            line: 181,
            column: 10
          },
          end: {
            line: 185,
            column: 11
          }
        },
        type: 'if',
        locations: [{
          start: {
            line: 181,
            column: 10
          },
          end: {
            line: 185,
            column: 11
          }
        }, {
          start: {
            line: 181,
            column: 10
          },
          end: {
            line: 185,
            column: 11
          }
        }],
        line: 181
      },
      '5': {
        loc: {
          start: {
            line: 196,
            column: 2
          },
          end: {
            line: 204,
            column: 3
          }
        },
        type: 'if',
        locations: [{
          start: {
            line: 196,
            column: 2
          },
          end: {
            line: 204,
            column: 3
          }
        }, {
          start: {
            line: 196,
            column: 2
          },
          end: {
            line: 204,
            column: 3
          }
        }],
        line: 196
      },
      '6': {
        loc: {
          start: {
            line: 198,
            column: 4
          },
          end: {
            line: 203,
            column: 5
          }
        },
        type: 'if',
        locations: [{
          start: {
            line: 198,
            column: 4
          },
          end: {
            line: 203,
            column: 5
          }
        }, {
          start: {
            line: 198,
            column: 4
          },
          end: {
            line: 203,
            column: 5
          }
        }],
        line: 198
      }
    },
    s: {
      '0': 0,
      '1': 0,
      '2': 0,
      '3': 0,
      '4': 0,
      '5': 0,
      '6': 0,
      '7': 0,
      '8': 0,
      '9': 0,
      '10': 0,
      '11': 0,
      '12': 0,
      '13': 0,
      '14': 0,
      '15': 0,
      '16': 0,
      '17': 0,
      '18': 0,
      '19': 0,
      '20': 0,
      '21': 0,
      '22': 0,
      '23': 0,
      '24': 0,
      '25': 0,
      '26': 0,
      '27': 0,
      '28': 0,
      '29': 0,
      '30': 0,
      '31': 0,
      '32': 0,
      '33': 0,
      '34': 0,
      '35': 0,
      '36': 0,
      '37': 0,
      '38': 0,
      '39': 0,
      '40': 0,
      '41': 0,
      '42': 0,
      '43': 0,
      '44': 0,
      '45': 0,
      '46': 0
    },
    f: {
      '0': 0,
      '1': 0,
      '2': 0,
      '3': 0,
      '4': 0,
      '5': 0,
      '6': 0,
      '7': 0,
      '8': 0,
      '9': 0,
      '10': 0,
      '11': 0,
      '12': 0,
      '13': 0,
      '14': 0,
      '15': 0
    },
    b: {
      '0': [0, 0, 0],
      '1': [0, 0],
      '2': [0, 0],
      '3': [0, 0],
      '4': [0, 0],
      '5': [0, 0],
      '6': [0, 0]
    },
    _coverageSchema: '332fd63041d2c1bcb487cc26dd0d5f7d97098a6c'
  },
      coverage = global[gcv] || (global[gcv] = {});

  if (coverage[path] && coverage[path].hash === hash) {
    return coverage[path];
  }

  coverageData.hash = hash;
  return coverage[path] = coverageData;
}();

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.generateFixture = exports.expectObservableToStartWith = exports.expectAsyncFailure = undefined;

var _asyncToGenerator = _interopRequireDefault(require('async-to-generator'));

/**
 * Verifies that a Promise fails with an Error with specific expectations. When
 * running a test where a Promise is expected to fail, it is important to verify
 * that it failed in the expected way to avoid false positives in test results.
 *
 * This function should be used with `await` inside `waitsForPromise()`.
 *
 * @param promise will be awaited. It is expected to reject. If it does not
 *     reject, then this function will return a rejected Promise.
 * @param verify should confirm expectations about the Error produced by the
 *     rejection of `promise`. If these expectations are not met, then
 *     `verify()` must throw an exception.
 */
let expectAsyncFailure = exports.expectAsyncFailure = (() => {
  var _ref = (0, _asyncToGenerator.default)(function* (promise, verify) {
    cov_1avtcq9yoi.f[0]++;
    cov_1avtcq9yoi.s[1]++;

    try {
      cov_1avtcq9yoi.s[2]++;

      yield promise;
      cov_1avtcq9yoi.s[3]++;
      return Promise.reject(new Error('Promise should have failed, but did not.'));
    } catch (e) {
      cov_1avtcq9yoi.s[4]++;

      verify(e);
    }
  });

  return function expectAsyncFailure(_x, _x2) {
    return _ref.apply(this, arguments);
  };
})();

/**
  * This is useful for mocking a module that the module under test requires.
  * After setting up the mocks, you must invalidate the require cache and then
  * re-require the module under test so that it picks up the mocked
  * dependencies.
  *
  * The require parameter is needed because require is bound differently in each
  * file, and we need to execute this in the caller's context.
  */


/**
 * Warning: Callsites *must* await the resulting promise, or test failures may go unreported or
 * misattributed.
 */
let expectObservableToStartWith = exports.expectObservableToStartWith = (() => {
  var _ref2 = (0, _asyncToGenerator.default)(function* (source, expected) {
    cov_1avtcq9yoi.f[6]++;

    const actual = (cov_1avtcq9yoi.s[20]++, yield source.take(expected.length).toArray().toPromise());
    cov_1avtcq9yoi.s[21]++;
    expect(actual).toEqual(expected);
  });

  return function expectObservableToStartWith(_x3, _x4) {
    return _ref2.apply(this, arguments);
  };
})();

/**
 * Takes of Map of file/file-content pairs, and creates a temp dir that matches
 * the file structure of the Map. Example:
 *
 * generateFixture('myfixture', new Map([
 *   ['foo.js'],
 *   ['bar/baz.txt', 'some text'],
 * ]));
 *
 * Creates:
 *
 * /tmp/myfixture_1/foo.js (empty file)
 * /tmp/myfixture_1/bar/baz.txt (with 'some text')
 */


let generateFixture = exports.generateFixture = (() => {
  var _ref3 = (0, _asyncToGenerator.default)(function* (fixtureName, files) {
    cov_1avtcq9yoi.f[7]++;
    cov_1avtcq9yoi.s[22]++;

    (_temp || _load_temp()).default.track();

    const MAX_CONCURRENT_FILE_OPS = (cov_1avtcq9yoi.s[23]++, 100);
    const tempDir = (cov_1avtcq9yoi.s[24]++, yield (_fsPromise || _load_fsPromise()).default.tempdir(fixtureName));

    cov_1avtcq9yoi.s[25]++;
    if (files == null) {
      cov_1avtcq9yoi.b[2][0]++;
      cov_1avtcq9yoi.s[26]++;

      return tempDir;
    } else {
      cov_1avtcq9yoi.b[2][1]++;
    }

    // Map -> Array with full paths
    const fileTuples = (cov_1avtcq9yoi.s[27]++, Array.from(files, function (tuple) {
      cov_1avtcq9yoi.f[8]++;
      cov_1avtcq9yoi.s[28]++;

      // It's our own array - it's ok to mutate it
      tuple[0] = (_nuclideUri || _load_nuclideUri()).default.join(tempDir, tuple[0]);
      cov_1avtcq9yoi.s[29]++;
      return tuple;
    }));

    // Dedupe the dirs that we have to make.
    const dirsToMake = (cov_1avtcq9yoi.s[30]++, fileTuples.map(function ([filename]) {
      cov_1avtcq9yoi.f[9]++;
      cov_1avtcq9yoi.s[31]++;
      return (_nuclideUri || _load_nuclideUri()).default.dirname(filename);
    }).filter(function (dirname, i, arr) {
      cov_1avtcq9yoi.f[10]++;
      cov_1avtcq9yoi.s[32]++;
      return arr.indexOf(dirname) === i;
    }));

    cov_1avtcq9yoi.s[33]++;
    yield (0, (_promise || _load_promise()).asyncLimit)(dirsToMake, MAX_CONCURRENT_FILE_OPS, function (dirname) {
      cov_1avtcq9yoi.f[11]++;
      cov_1avtcq9yoi.s[34]++;
      return (_fsPromise || _load_fsPromise()).default.mkdirp(dirname);
    });

    cov_1avtcq9yoi.s[35]++;
    yield (0, (_promise || _load_promise()).asyncLimit)(fileTuples, MAX_CONCURRENT_FILE_OPS, function ([filename, contents]) {
      cov_1avtcq9yoi.f[12]++;
      cov_1avtcq9yoi.s[36]++;

      // We can't use fsPromise/fs-plus because it does too much extra work.
      // They call `mkdirp` before `writeFile`. We know that the target dir
      // exists, so we can optimize by going straight to `fs`. When you're
      // making 10k files, this adds ~500ms.
      return new Promise(function (resolve, reject) {
        cov_1avtcq9yoi.f[13]++;
        cov_1avtcq9yoi.s[37]++;

        _fs.default.writeFile(filename, (cov_1avtcq9yoi.b[3][0]++, contents) || (cov_1avtcq9yoi.b[3][1]++, ''), function (err) {
          cov_1avtcq9yoi.f[14]++;
          cov_1avtcq9yoi.s[38]++;

          if (err) {
            cov_1avtcq9yoi.b[4][0]++;
            cov_1avtcq9yoi.s[39]++;

            reject(err);
          } else {
            cov_1avtcq9yoi.b[4][1]++;
            cov_1avtcq9yoi.s[40]++;

            resolve();
          }
        });
      });
    });

    cov_1avtcq9yoi.s[41]++;
    return tempDir;
  });

  return function generateFixture(_x5, _x6) {
    return _ref3.apply(this, arguments);
  };
})();

exports.clearRequireCache = clearRequireCache;
exports.uncachedRequire = uncachedRequire;
exports.spyOnGetterValue = spyOnGetterValue;
exports.arePropertiesEqual = arePropertiesEqual;
exports.writeCoverage = writeCoverage;

var _fs = _interopRequireDefault(require('fs'));

var _temp;

function _load_temp() {
  return _temp = _interopRequireDefault(require('temp'));
}

var _uuid;

function _load_uuid() {
  return _uuid = _interopRequireDefault(require('uuid'));
}

var _fsPromise;

function _load_fsPromise() {
  return _fsPromise = _interopRequireDefault(require('./fsPromise'));
}

var _nuclideUri;

function _load_nuclideUri() {
  return _nuclideUri = _interopRequireDefault(require('./nuclideUri'));
}

var _promise;

function _load_promise() {
  return _promise = require('./promise');
}

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

/**
 * Copyright (c) 2017-present, Facebook, Inc.
 * All rights reserved.
 *
 * This source code is licensed under the BSD-style license found in the
 * LICENSE file in the root directory of this source tree. An additional grant
 * of patent rights can be found in the PATENTS file in the same directory.
 *
 * 
 * @format
 */

cov_1avtcq9yoi.s[0]++;

if (!((cov_1avtcq9yoi.b[0][0]++, typeof atom !== 'undefined') && (cov_1avtcq9yoi.b[0][1]++, atom.inSpecMode()) || (cov_1avtcq9yoi.b[0][2]++, process.env.NODE_ENV === 'test'))) {
  throw new Error('Test helpers should only be used in spec mode');
}

function clearRequireCache(require, module) {
  cov_1avtcq9yoi.f[1]++;
  cov_1avtcq9yoi.s[5]++;

  delete require.cache[require.resolve(module)];
}

function uncachedRequire(require, module) {
  cov_1avtcq9yoi.f[2]++;
  cov_1avtcq9yoi.s[6]++;

  clearRequireCache(require, module);
  // $FlowIgnore
  cov_1avtcq9yoi.s[7]++;
  return require(module);
}

/**
 * Jasmine has trouble spying on properties supplied by getters, so to make it
 * work we have to get the value, delete the getter, and set the value as a
 * property.
 *
 * This makes two assumptions:
 * - The getter is idempotent (otherwise, callers in other tests might be
 *   surprised when the value here is returned)
 * - The getter returns a function (otherwise, it doesn't make sense to spy on
 *   it)
 */
function spyOnGetterValue(object, f) {
  cov_1avtcq9yoi.f[3]++;

  const value = (cov_1avtcq9yoi.s[8]++, object[f]);
  cov_1avtcq9yoi.s[9]++;
  delete object[f];
  cov_1avtcq9yoi.s[10]++;
  object[f] = value;
  cov_1avtcq9yoi.s[11]++;
  return spyOn(object, f);
}

/**
 * Checks if the two objects have equal properties. This considers a property
 * set to undefined to be equivalent to a property that was not set at all.
 */
function arePropertiesEqual(obj1, obj2) {
  cov_1avtcq9yoi.f[4]++;

  const allProps = (cov_1avtcq9yoi.s[12]++, new Set());
  function addAllProps(obj) {
    cov_1avtcq9yoi.f[5]++;
    cov_1avtcq9yoi.s[13]++;

    for (const prop of Object.keys(obj)) {
      cov_1avtcq9yoi.s[14]++;

      allProps.add(prop);
    }
  }
  cov_1avtcq9yoi.s[15]++;
  [obj1, obj2].forEach(addAllProps);
  cov_1avtcq9yoi.s[16]++;
  for (const prop of allProps) {
    cov_1avtcq9yoi.s[17]++;

    if (obj1[prop] !== obj2[prop]) {
      cov_1avtcq9yoi.b[1][0]++;
      cov_1avtcq9yoi.s[18]++;

      return false;
    } else {
      cov_1avtcq9yoi.b[1][1]++;
    }
  }
  cov_1avtcq9yoi.s[19]++;
  return true;
}function writeCoverage() {
  cov_1avtcq9yoi.f[15]++;

  const { COVERAGE_DIR } = (cov_1avtcq9yoi.s[42]++, process.env);
  cov_1avtcq9yoi.s[43]++;
  if (COVERAGE_DIR != null) {
    cov_1avtcq9yoi.b[5][0]++;

    const coverage = (cov_1avtcq9yoi.s[44]++, global.__coverage__);
    cov_1avtcq9yoi.s[45]++;
    if (coverage != null) {
      cov_1avtcq9yoi.b[6][0]++;
      cov_1avtcq9yoi.s[46]++;

      _fs.default.writeFileSync((_nuclideUri || _load_nuclideUri()).default.join(COVERAGE_DIR, (_uuid || _load_uuid()).default.v4() + '.json'), JSON.stringify(coverage));
    } else {
      cov_1avtcq9yoi.b[6][1]++;
    }
  } else {
    cov_1avtcq9yoi.b[5][1]++;
  }
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInRlc3QtaGVscGVycy5qcyJdLCJuYW1lcyI6WyJwcm9taXNlIiwidmVyaWZ5IiwiUHJvbWlzZSIsInJlamVjdCIsIkVycm9yIiwiZSIsImV4cGVjdEFzeW5jRmFpbHVyZSIsInNvdXJjZSIsImV4cGVjdGVkIiwiYWN0dWFsIiwidGFrZSIsImxlbmd0aCIsInRvQXJyYXkiLCJ0b1Byb21pc2UiLCJleHBlY3QiLCJ0b0VxdWFsIiwiZXhwZWN0T2JzZXJ2YWJsZVRvU3RhcnRXaXRoIiwiZml4dHVyZU5hbWUiLCJmaWxlcyIsInRyYWNrIiwiTUFYX0NPTkNVUlJFTlRfRklMRV9PUFMiLCJ0ZW1wRGlyIiwidGVtcGRpciIsImZpbGVUdXBsZXMiLCJBcnJheSIsImZyb20iLCJ0dXBsZSIsImpvaW4iLCJkaXJzVG9NYWtlIiwibWFwIiwiZmlsZW5hbWUiLCJkaXJuYW1lIiwiZmlsdGVyIiwiaSIsImFyciIsImluZGV4T2YiLCJta2RpcnAiLCJjb250ZW50cyIsInJlc29sdmUiLCJ3cml0ZUZpbGUiLCJlcnIiLCJnZW5lcmF0ZUZpeHR1cmUiLCJjbGVhclJlcXVpcmVDYWNoZSIsInVuY2FjaGVkUmVxdWlyZSIsInNweU9uR2V0dGVyVmFsdWUiLCJhcmVQcm9wZXJ0aWVzRXF1YWwiLCJ3cml0ZUNvdmVyYWdlIiwiYXRvbSIsImluU3BlY01vZGUiLCJwcm9jZXNzIiwiZW52IiwiTk9ERV9FTlYiLCJyZXF1aXJlIiwibW9kdWxlIiwiY2FjaGUiLCJvYmplY3QiLCJmIiwidmFsdWUiLCJzcHlPbiIsIm9iajEiLCJvYmoyIiwiYWxsUHJvcHMiLCJTZXQiLCJhZGRBbGxQcm9wcyIsIm9iaiIsInByb3AiLCJPYmplY3QiLCJrZXlzIiwiYWRkIiwiZm9yRWFjaCIsIkNPVkVSQUdFX0RJUiIsImNvdmVyYWdlIiwiZ2xvYmFsIiwiX19jb3ZlcmFnZV9fIiwid3JpdGVGaWxlU3luYyIsInY0IiwiSlNPTiIsInN0cmluZ2lmeSJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7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LEVBQUwsS0FBWSxPQUExQyxDQURGLEVBRUVDLEtBQUtDLFNBQUwsQ0FBZU4sUUFBZixDQUZGO0FBSUQsS0FMRDtBQUFBO0FBQUE7QUFNRCxHQVJEO0FBQUE7QUFBQTtBQVNEIiwiZmlsZSI6InRlc3QtaGVscGVycy5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogQ29weXJpZ2h0IChjKSAyMDE3LXByZXNlbnQsIEZhY2Vib29rLCBJbmMuXG4gKiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuICpcbiAqIFRoaXMgc291cmNlIGNvZGUgaXMgbGljZW5zZWQgdW5kZXIgdGhlIEJTRC1zdHlsZSBsaWNlbnNlIGZvdW5kIGluIHRoZVxuICogTElDRU5TRSBmaWxlIGluIHRoZSByb290IGRpcmVjdG9yeSBvZiB0aGlzIHNvdXJjZSB0cmVlLiBBbiBhZGRpdGlvbmFsIGdyYW50XG4gKiBvZiBwYXRlbnQgcmlnaHRzIGNhbiBiZSBmb3VuZCBpbiB0aGUgUEFURU5UUyBmaWxlIGluIHRoZSBzYW1lIGRpcmVjdG9yeS5cbiAqXG4gKiBAZmxvd1xuICogQGZvcm1hdFxuICovXG5cbmltcG9ydCB0eXBlIHtPYnNlcnZhYmxlfSBmcm9tICdyeGpzJztcblxuaW1wb3J0IGludmFyaWFudCBmcm9tICdhc3NlcnQnO1xuaW1wb3J0IGZzIGZyb20gJ2ZzJztcbmltcG9ydCB0ZW1wIGZyb20gJ3RlbXAnO1xuaW1wb3J0IHV1aWQgZnJvbSAndXVpZCc7XG5pbXBvcnQgZnNQcm9taXNlIGZyb20gJy4vZnNQcm9taXNlJztcbmltcG9ydCBudWNsaWRlVXJpIGZyb20gJy4vbnVjbGlkZVVyaSc7XG5pbXBvcnQge2FzeW5jTGltaXR9IGZyb20gJy4vcHJvbWlzZSc7XG5cbmludmFyaWFudChcbiAgKHR5cGVvZiBhdG9tICE9PSAndW5kZWZpbmVkJyAmJiBhdG9tLmluU3BlY01vZGUoKSkgfHxcbiAgICBwcm9jZXNzLmVudi5OT0RFX0VOViA9PT0gJ3Rlc3QnLFxuICAnVGVzdCBoZWxwZXJzIHNob3VsZCBvbmx5IGJlIHVzZWQgaW4gc3BlYyBtb2RlJyxcbik7XG5cbi8qKlxuICogVmVyaWZpZXMgdGhhdCBhIFByb21pc2UgZmFpbHMgd2l0aCBhbiBFcnJvciB3aXRoIHNwZWNpZmljIGV4cGVjdGF0aW9ucy4gV2hlblxuICogcnVubmluZyBhIHRlc3Qgd2hlcmUgYSBQcm9taXNlIGlzIGV4cGVjdGVkIHRvIGZhaWwsIGl0IGlzIGltcG9ydGFudCB0byB2ZXJpZnlcbiAqIHRoYXQgaXQgZmFpbGVkIGluIHRoZSBleHBlY3RlZCB3YXkgdG8gYXZvaWQgZmFsc2UgcG9zaXRpdmVzIGluIHRlc3QgcmVzdWx0cy5cbiAqXG4gKiBUaGlzIGZ1bmN0aW9uIHNob3VsZCBiZSB1c2VkIHdpdGggYGF3YWl0YCBpbnNpZGUgYHdhaXRzRm9yUHJvbWlzZSgpYC5cbiAqXG4gKiBAcGFyYW0gcHJvbWlzZSB3aWxsIGJlIGF3YWl0ZWQuIEl0IGlzIGV4cGVjdGVkIHRvIHJlamVjdC4gSWYgaXQgZG9lcyBub3RcbiAqICAgICByZWplY3QsIHRoZW4gdGhpcyBmdW5jdGlvbiB3aWxsIHJldHVybiBhIHJlamVjdGVkIFByb21pc2UuXG4gKiBAcGFyYW0gdmVyaWZ5IHNob3VsZCBjb25maXJtIGV4cGVjdGF0aW9ucyBhYm91dCB0aGUgRXJyb3IgcHJvZHVjZWQgYnkgdGhlXG4gKiAgICAgcmVqZWN0aW9uIG9mIGBwcm9taXNlYC4gSWYgdGhlc2UgZXhwZWN0YXRpb25zIGFyZSBub3QgbWV0LCB0aGVuXG4gKiAgICAgYHZlcmlmeSgpYCBtdXN0IHRocm93IGFuIGV4Y2VwdGlvbi5cbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGV4cGVjdEFzeW5jRmFpbHVyZShcbiAgcHJvbWlzZTogUHJvbWlzZTxhbnk+LFxuICB2ZXJpZnk6IChlcnJvcjogRXJyb3IpID0+IHZvaWQsXG4pOiBQcm9taXNlPGFueT4ge1xuICB0cnkge1xuICAgIGF3YWl0IHByb21pc2U7XG4gICAgcmV0dXJuIFByb21pc2UucmVqZWN0KFxuICAgICAgbmV3IEVycm9yKCdQcm9taXNlIHNob3VsZCBoYXZlIGZhaWxlZCwgYnV0IGRpZCBub3QuJyksXG4gICAgKTtcbiAgfSBjYXRjaCAoZSkge1xuICAgIHZlcmlmeShlKTtcbiAgfVxufVxuXG4vKipcbiAgKiBUaGlzIGlzIHVzZWZ1bCBmb3IgbW9ja2luZyBhIG1vZHVsZSB0aGF0IHRoZSBtb2R1bGUgdW5kZXIgdGVzdCByZXF1aXJlcy5cbiAgKiBBZnRlciBzZXR0aW5nIHVwIHRoZSBtb2NrcywgeW91IG11c3QgaW52YWxpZGF0ZSB0aGUgcmVxdWlyZSBjYWNoZSBhbmQgdGhlblxuICAqIHJlLXJlcXVpcmUgdGhlIG1vZHVsZSB1bmRlciB0ZXN0IHNvIHRoYXQgaXQgcGlja3MgdXAgdGhlIG1vY2tlZFxuICAqIGRlcGVuZGVuY2llcy5cbiAgKlxuICAqIFRoZSByZXF1aXJlIHBhcmFtZXRlciBpcyBuZWVkZWQgYmVjYXVzZSByZXF1aXJlIGlzIGJvdW5kIGRpZmZlcmVudGx5IGluIGVhY2hcbiAgKiBmaWxlLCBhbmQgd2UgbmVlZCB0byBleGVjdXRlIHRoaXMgaW4gdGhlIGNhbGxlcidzIGNvbnRleHQuXG4gICovXG5leHBvcnQgZnVuY3Rpb24gY2xlYXJSZXF1aXJlQ2FjaGUocmVxdWlyZTogT2JqZWN0LCBtb2R1bGU6IHN0cmluZyk6IHZvaWQge1xuICBkZWxldGUgcmVxdWlyZS5jYWNoZVtyZXF1aXJlLnJlc29sdmUobW9kdWxlKV07XG59XG5cbmV4cG9ydCBmdW5jdGlvbiB1bmNhY2hlZFJlcXVpcmUocmVxdWlyZTogT2JqZWN0LCBtb2R1bGU6IHN0cmluZyk6IG1peGVkIHtcbiAgY2xlYXJSZXF1aXJlQ2FjaGUocmVxdWlyZSwgbW9kdWxlKTtcbiAgLy8gJEZsb3dJZ25vcmVcbiAgcmV0dXJuIHJlcXVpcmUobW9kdWxlKTtcbn1cblxuLyoqXG4gKiBKYXNtaW5lIGhhcyB0cm91YmxlIHNweWluZyBvbiBwcm9wZXJ0aWVzIHN1cHBsaWVkIGJ5IGdldHRlcnMsIHNvIHRvIG1ha2UgaXRcbiAqIHdvcmsgd2UgaGF2ZSB0byBnZXQgdGhlIHZhbHVlLCBkZWxldGUgdGhlIGdldHRlciwgYW5kIHNldCB0aGUgdmFsdWUgYXMgYVxuICogcHJvcGVydHkuXG4gKlxuICogVGhpcyBtYWtlcyB0d28gYXNzdW1wdGlvbnM6XG4gKiAtIFRoZSBnZXR0ZXIgaXMgaWRlbXBvdGVudCAob3RoZXJ3aXNlLCBjYWxsZXJzIGluIG90aGVyIHRlc3RzIG1pZ2h0IGJlXG4gKiAgIHN1cnByaXNlZCB3aGVuIHRoZSB2YWx1ZSBoZXJlIGlzIHJldHVybmVkKVxuICogLSBUaGUgZ2V0dGVyIHJldHVybnMgYSBmdW5jdGlvbiAob3RoZXJ3aXNlLCBpdCBkb2Vzbid0IG1ha2Ugc2Vuc2UgdG8gc3B5IG9uXG4gKiAgIGl0KVxuICovXG5leHBvcnQgZnVuY3Rpb24gc3B5T25HZXR0ZXJWYWx1ZShvYmplY3Q6IE9iamVjdCwgZjogc3RyaW5nKTogSmFzbWluZVNweSB7XG4gIGNvbnN0IHZhbHVlID0gb2JqZWN0W2ZdO1xuICBkZWxldGUgb2JqZWN0W2ZdO1xuICBvYmplY3RbZl0gPSB2YWx1ZTtcbiAgcmV0dXJuIHNweU9uKG9iamVjdCwgZik7XG59XG5cbi8qKlxuICogQ2hlY2tzIGlmIHRoZSB0d28gb2JqZWN0cyBoYXZlIGVxdWFsIHByb3BlcnRpZXMuIFRoaXMgY29uc2lkZXJzIGEgcHJvcGVydHlcbiAqIHNldCB0byB1bmRlZmluZWQgdG8gYmUgZXF1aXZhbGVudCB0byBhIHByb3BlcnR5IHRoYXQgd2FzIG5vdCBzZXQgYXQgYWxsLlxuICovXG5leHBvcnQgZnVuY3Rpb24gYXJlUHJvcGVydGllc0VxdWFsKG9iajE6IE9iamVjdCwgb2JqMjogT2JqZWN0KTogYm9vbGVhbiB7XG4gIGNvbnN0IGFsbFByb3BzID0gbmV3IFNldCgpO1xuICBmdW5jdGlvbiBhZGRBbGxQcm9wcyhvYmopIHtcbiAgICBmb3IgKGNvbnN0IHByb3Agb2YgT2JqZWN0LmtleXMob2JqKSkge1xuICAgICAgYWxsUHJvcHMuYWRkKHByb3ApO1xuICAgIH1cbiAgfVxuICBbb2JqMSwgb2JqMl0uZm9yRWFjaChhZGRBbGxQcm9wcyk7XG4gIGZvciAoY29uc3QgcHJvcCBvZiBhbGxQcm9wcykge1xuICAgIGlmIChvYmoxW3Byb3BdICE9PSBvYmoyW3Byb3BdKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICB9XG4gIHJldHVybiB0cnVlO1xufVxuXG4vKipcbiAqIFdhcm5pbmc6IENhbGxzaXRlcyAqbXVzdCogYXdhaXQgdGhlIHJlc3VsdGluZyBwcm9taXNlLCBvciB0ZXN0IGZhaWx1cmVzIG1heSBnbyB1bnJlcG9ydGVkIG9yXG4gKiBtaXNhdHRyaWJ1dGVkLlxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZXhwZWN0T2JzZXJ2YWJsZVRvU3RhcnRXaXRoPFQ+KFxuICBzb3VyY2U6IE9ic2VydmFibGU8VD4sXG4gIGV4cGVjdGVkOiBBcnJheTxUPixcbik6IFByb21pc2U8dm9pZD4ge1xuICBjb25zdCBhY3R1YWw6IEFycmF5PFQ+ID0gYXdhaXQgc291cmNlXG4gICAgLnRha2UoZXhwZWN0ZWQubGVuZ3RoKVxuICAgIC50b0FycmF5KClcbiAgICAudG9Qcm9taXNlKCk7XG4gIGV4cGVjdChhY3R1YWwpLnRvRXF1YWwoZXhwZWN0ZWQpO1xufVxuXG4vKipcbiAqIFRha2VzIG9mIE1hcCBvZiBmaWxlL2ZpbGUtY29udGVudCBwYWlycywgYW5kIGNyZWF0ZXMgYSB0ZW1wIGRpciB0aGF0IG1hdGNoZXNcbiAqIHRoZSBmaWxlIHN0cnVjdHVyZSBvZiB0aGUgTWFwLiBFeGFtcGxlOlxuICpcbiAqIGdlbmVyYXRlRml4dHVyZSgnbXlmaXh0dXJlJywgbmV3IE1hcChbXG4gKiAgIFsnZm9vLmpzJ10sXG4gKiAgIFsnYmFyL2Jhei50eHQnLCAnc29tZSB0ZXh0J10sXG4gKiBdKSk7XG4gKlxuICogQ3JlYXRlczpcbiAqXG4gKiAvdG1wL215Zml4dHVyZV8xL2Zvby5qcyAoZW1wdHkgZmlsZSlcbiAqIC90bXAvbXlmaXh0dXJlXzEvYmFyL2Jhei50eHQgKHdpdGggJ3NvbWUgdGV4dCcpXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZW5lcmF0ZUZpeHR1cmUoXG4gIGZpeHR1cmVOYW1lOiBzdHJpbmcsXG4gIGZpbGVzOiA/TWFwPHN0cmluZywgP3N0cmluZz4sXG4pOiBQcm9taXNlPHN0cmluZz4ge1xuICB0ZW1wLnRyYWNrKCk7XG5cbiAgY29uc3QgTUFYX0NPTkNVUlJFTlRfRklMRV9PUFMgPSAxMDA7XG4gIGNvbnN0IHRlbXBEaXIgPSBhd2FpdCBmc1Byb21pc2UudGVtcGRpcihmaXh0dXJlTmFtZSk7XG5cbiAgaWYgKGZpbGVzID09IG51bGwpIHtcbiAgICByZXR1cm4gdGVtcERpcjtcbiAgfVxuXG4gIC8vIE1hcCAtPiBBcnJheSB3aXRoIGZ1bGwgcGF0aHNcbiAgY29uc3QgZmlsZVR1cGxlcyA9IEFycmF5LmZyb20oZmlsZXMsIHR1cGxlID0+IHtcbiAgICAvLyBJdCdzIG91ciBvd24gYXJyYXkgLSBpdCdzIG9rIHRvIG11dGF0ZSBpdFxuICAgIHR1cGxlWzBdID0gbnVjbGlkZVVyaS5qb2luKHRlbXBEaXIsIHR1cGxlWzBdKTtcbiAgICByZXR1cm4gdHVwbGU7XG4gIH0pO1xuXG4gIC8vIERlZHVwZSB0aGUgZGlycyB0aGF0IHdlIGhhdmUgdG8gbWFrZS5cbiAgY29uc3QgZGlyc1RvTWFrZSA9IGZpbGVUdXBsZXNcbiAgICAubWFwKChbZmlsZW5hbWVdKSA9PiBudWNsaWRlVXJpLmRpcm5hbWUoZmlsZW5hbWUpKVxuICAgIC5maWx0ZXIoKGRpcm5hbWUsIGksIGFycikgPT4gYXJyLmluZGV4T2YoZGlybmFtZSkgPT09IGkpO1xuXG4gIGF3YWl0IGFzeW5jTGltaXQoZGlyc1RvTWFrZSwgTUFYX0NPTkNVUlJFTlRfRklMRV9PUFMsIGRpcm5hbWUgPT5cbiAgICBmc1Byb21pc2UubWtkaXJwKGRpcm5hbWUpLFxuICApO1xuXG4gIGF3YWl0IGFzeW5jTGltaXQoXG4gICAgZmlsZVR1cGxlcyxcbiAgICBNQVhfQ09OQ1VSUkVOVF9GSUxFX09QUyxcbiAgICAoW2ZpbGVuYW1lLCBjb250ZW50c10pID0+IHtcbiAgICAgIC8vIFdlIGNhbid0IHVzZSBmc1Byb21pc2UvZnMtcGx1cyBiZWNhdXNlIGl0IGRvZXMgdG9vIG11Y2ggZXh0cmEgd29yay5cbiAgICAgIC8vIFRoZXkgY2FsbCBgbWtkaXJwYCBiZWZvcmUgYHdyaXRlRmlsZWAuIFdlIGtub3cgdGhhdCB0aGUgdGFyZ2V0IGRpclxuICAgICAgLy8gZXhpc3RzLCBzbyB3ZSBjYW4gb3B0aW1pemUgYnkgZ29pbmcgc3RyYWlnaHQgdG8gYGZzYC4gV2hlbiB5b3UncmVcbiAgICAgIC8vIG1ha2luZyAxMGsgZmlsZXMsIHRoaXMgYWRkcyB+NTAwbXMuXG4gICAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgICBmcy53cml0ZUZpbGUoZmlsZW5hbWUsIGNvbnRlbnRzIHx8ICcnLCBlcnIgPT4ge1xuICAgICAgICAgIGlmIChlcnIpIHtcbiAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXNvbHZlKCk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgIH0sXG4gICk7XG5cbiAgcmV0dXJuIHRlbXBEaXI7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiB3cml0ZUNvdmVyYWdlKCk6IHZvaWQge1xuICBjb25zdCB7Q09WRVJBR0VfRElSfSA9IHByb2Nlc3MuZW52O1xuICBpZiAoQ09WRVJBR0VfRElSICE9IG51bGwpIHtcbiAgICBjb25zdCBjb3ZlcmFnZSA9IGdsb2JhbC5fX2NvdmVyYWdlX187XG4gICAgaWYgKGNvdmVyYWdlICE9IG51bGwpIHtcbiAgICAgIGZzLndyaXRlRmlsZVN5bmMoXG4gICAgICAgIG51Y2xpZGVVcmkuam9pbihDT1ZFUkFHRV9ESVIsIHV1aWQudjQoKSArICcuanNvbicpLFxuICAgICAgICBKU09OLnN0cmluZ2lmeShjb3ZlcmFnZSksXG4gICAgICApO1xuICAgIH1cbiAgfVxufVxuIl19