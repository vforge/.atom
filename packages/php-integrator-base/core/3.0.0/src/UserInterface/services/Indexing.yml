parameters:


services:
    sqliteConnectionFactory:
        class: PhpIntegrator\Indexing\SqliteConnectionFactory

    managerRegistry.cache:
        class: Doctrine\Common\Cache\VoidCache

    managerRegistry:
        class: PhpIntegrator\Indexing\ManagerRegistry
        arguments:
            - '@sqliteConnectionFactory'
            - '@managerRegistry.cache'

    schemaInitializer:
        class: PhpIntegrator\Indexing\SchemaInitializer
        arguments:
            - '@managerRegistry'

    storageVersionChecker:
        class: PhpIntegrator\Indexing\StorageVersionChecker
        arguments:
            - '@managerRegistry'

    storage.doctrineStorage:
        class: PhpIntegrator\Indexing\DoctrineStorage
        arguments:
            - '@managerRegistry'

    storage.eventEmittingStorage:
        class: PhpIntegrator\Indexing\EventEmittingStorage
        arguments:
            - '@storage.doctrineStorage'

    storage:
        alias: storage.eventEmittingStorage

    fileIndexer:
        class: PhpIntegrator\Indexing\FileIndexer
        arguments:
            - '@storage'
            - '@typeAnalyzer'
            - '@docblockParser'
            - '@nodeTypeDeducer'
            - '@parser'
            - '@structureAwareNameResolverFactory'

    projectIndexer:
        class: PhpIntegrator\Indexing\ProjectIndexer
        arguments:
            - '@storage'
            - '@fileIndexer'
            - '@sourceCodeStreamReader'

    indexer:
        class: PhpIntegrator\Indexing\Indexer
        arguments:
            - '@projectIndexer'
            - '@sourceCodeStreamReader'
