Object.defineProperty(exports, "__esModule", {
  value: true
});

var _child_process = require('child_process');

var cp = _interopRequireWildcard(_child_process);

var _languageclient = require('./languageclient');

var ls = _interopRequireWildcard(_languageclient);

var _vscodeJsonrpc = require('vscode-jsonrpc');

var rpc = _interopRequireWildcard(_vscodeJsonrpc);

var _path = require('path');

var _path2 = _interopRequireDefault(_path);

var _atom = require('atom');

var _logger = require('./logger');

var _serverManager = require('./server-manager.js');

var _convert = require('./convert.js');

var _convert2 = _interopRequireDefault(_convert);

var _applyEditAdapter = require('./adapters/apply-edit-adapter');

var _applyEditAdapter2 = _interopRequireDefault(_applyEditAdapter);

var _autocompleteAdapter = require('./adapters/autocomplete-adapter');

var _autocompleteAdapter2 = _interopRequireDefault(_autocompleteAdapter);

var _codeActionAdapter = require('./adapters/code-action-adapter');

var _codeActionAdapter2 = _interopRequireDefault(_codeActionAdapter);

var _codeFormatAdapter = require('./adapters/code-format-adapter');

var _codeFormatAdapter2 = _interopRequireDefault(_codeFormatAdapter);

var _codeHighlightAdapter = require('./adapters/code-highlight-adapter');

var _codeHighlightAdapter2 = _interopRequireDefault(_codeHighlightAdapter);

var _datatipAdapter = require('./adapters/datatip-adapter');

var _datatipAdapter2 = _interopRequireDefault(_datatipAdapter);

var _definitionAdapter = require('./adapters/definition-adapter');

var _definitionAdapter2 = _interopRequireDefault(_definitionAdapter);

var _documentSyncAdapter = require('./adapters/document-sync-adapter');

var _documentSyncAdapter2 = _interopRequireDefault(_documentSyncAdapter);

var _findReferencesAdapter = require('./adapters/find-references-adapter');

var _findReferencesAdapter2 = _interopRequireDefault(_findReferencesAdapter);

var _linterPushV2Adapter = require('./adapters/linter-push-v2-adapter');

var _linterPushV2Adapter2 = _interopRequireDefault(_linterPushV2Adapter);

var _notificationsAdapter = require('./adapters/notifications-adapter');

var _notificationsAdapter2 = _interopRequireDefault(_notificationsAdapter);

var _outlineViewAdapter = require('./adapters/outline-view-adapter');

var _outlineViewAdapter2 = _interopRequireDefault(_outlineViewAdapter);

var _signatureHelpAdapter = require('./adapters/signature-help-adapter');

var _signatureHelpAdapter2 = _interopRequireDefault(_signatureHelpAdapter);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }

// Public: AutoLanguageClient provides a simple way to have all the supported
// Atom-IDE services wired up entirely for you by just subclassing it and
// implementing startServerProcess/getGrammarScopes/getLanguageName and
// getServerName.
class AutoLanguageClient {
  constructor() {
    this._disposable = new _atom.CompositeDisposable();
    this.processStdErr = '';
  }

  // Available if consumeBusySignal is setup


  // Shared adapters that can take the RPC connection as required


  // You must implement these so we know how to deal with your language and server
  // -------------------------------------------------------------------------

  // Return an array of the grammar scopes you handle, e.g. [ 'source.js' ]
  getGrammarScopes() {
    throw Error('Must implement getGrammarScopes when extending AutoLanguageClient');
  }

  // Return the name of the language you support, e.g. 'JavaScript'
  getLanguageName() {
    throw Error('Must implement getLanguageName when extending AutoLanguageClient');
  }

  // Return the name of your server, e.g. 'Eclipse JDT'
  getServerName() {
    throw Error('Must implement getServerName when extending AutoLanguageClient');
  }

  // Start your server process
  startServerProcess(projectPath) {
    throw Error('Must override startServerProcess to start language server process when extending AutoLanguageClient');
  }

  // You might want to override these for different behavior
  // ---------------------------------------------------------------------------

  // Determine whether we should start a server for a given editor if we don't have one yet
  shouldStartForEditor(editor) {
    return this.getGrammarScopes().includes(editor.getGrammar().scopeName);
  }

  // Return the parameters used to initialize a client - you may want to extend capabilities
  getInitializeParams(projectPath, process) {
    return {
      processId: process.pid,
      rootPath: projectPath,
      rootUri: _convert2.default.pathToUri(projectPath),
      capabilities: {
        workspace: {
          applyEdit: true,
          workspaceEdit: {
            documentChanges: true
          },
          didChangeConfiguration: {
            dynamicRegistration: false
          },
          didChangeWatchedFiles: {
            dynamicRegistration: false
          },
          symbol: {
            dynamicRegistration: false
          },
          executeCommand: {
            dynamicRegistration: false
          }
        },
        textDocument: {
          synchronization: {
            dynamicRegistration: false,
            willSave: true,
            willSaveWaitUntil: false,
            didSave: true
          },
          completion: {
            dynamicRegistration: false,
            completionItem: {
              snippetSupport: true,
              commitCharactersSupport: false
            },
            contextSupport: true
          },
          hover: {
            dynamicRegistration: false
          },
          signatureHelp: {
            dynamicRegistration: false
          },
          references: {
            dynamicRegistration: false
          },
          documentHighlight: {
            dynamicRegistration: false
          },
          documentSymbol: {
            dynamicRegistration: false
          },
          formatting: {
            dynamicRegistration: false
          },
          rangeFormatting: {
            dynamicRegistration: false
          },
          onTypeFormatting: {
            dynamicRegistration: false
          },
          definition: {
            dynamicRegistration: false
          },
          codeAction: {
            dynamicRegistration: false
          },
          codeLens: {
            dynamicRegistration: false
          },
          documentLink: {
            dynamicRegistration: false
          },
          rename: {
            dynamicRegistration: false
          }
        },
        experimental: {}
      }
    };
  }

  // Early wire-up of listeners before initialize method is sent
  preInitialization(connection) {}

  // Late wire-up of listeners after initialize method has been sent
  postInitialization(server) {}

  // Determine whether to use ipc, stdio or socket to connect to the server
  getConnectionType() {
    return this.socket != null ? 'socket' : 'stdio';
  }

  // Default implementation of the rest of the AutoLanguageClient
  // ---------------------------------------------------------------------------

  // Activate does very little for perf reasons - hooks in via ServerManager for later 'activation'
  activate() {
    this.name = `${this.getLanguageName()} (${this.getServerName()})`;
    this.logger = this.getLogger();
    this._serverManager = new _serverManager.ServerManager(p => this.startServer(p), this.logger, e => this.shouldStartForEditor(e), filepath => this.filterChangeWatchedFiles(filepath), () => this.busySignalService, this.getServerName());
    this._serverManager.startListening();
    process.on('exit', () => this.exitCleanup.bind(this));
  }

  exitCleanup() {
    this._serverManager.terminate();
  }

  // Deactivate disposes the resources we're using
  async deactivate() {
    this._disposable.dispose();
    this._serverManager.stopListening();
    await this._serverManager.stopAllServers();
  }

  spawnChildNode(args, options = {}) {
    this.logger.debug(`starting child Node "${args.join(' ')}"`);
    options.env = options.env || Object.create(process.env);
    options.env.ELECTRON_RUN_AS_NODE = '1';
    options.env.ELECTRON_NO_ATTACH_CONSOLE = '1';
    return cp.spawn(process.execPath, args, options);
  }

  // By default LSP logging is switched off but you can switch it on via the core.debugLSP setting
  getLogger() {
    return atom.config.get('core.debugLSP') ? new _logger.ConsoleLogger(this.name) : new _logger.NullLogger();
  }

  // Starts the server by starting the process, then initializing the language server and starting adapters
  async startServer(projectPath) {
    const startingSignal = this.busySignalService && this.busySignalService.reportBusy(`Starting ${this.getServerName()} for ${_path2.default.basename(projectPath)}`);
    let process;
    try {
      process = await this.startServerProcess(projectPath);
    } finally {
      startingSignal && startingSignal.dispose();
    }
    this.captureServerErrors(process, projectPath);
    const connection = new ls.LanguageClientConnection(this.createRpcConnection(process), this.logger);
    this.preInitialization(connection);
    const initializeParams = this.getInitializeParams(projectPath, process);
    const initialization = connection.initialize(initializeParams);
    this.busySignalService && this.busySignalService.reportBusyWhile(`${this.getServerName()} initializing for ${_path2.default.basename(projectPath)}`, () => initialization);
    const initializeResponse = await initialization;
    const newServer = {
      projectPath,
      process,
      connection,
      capabilities: initializeResponse.capabilities,
      disposable: new _atom.CompositeDisposable()
    };
    this.postInitialization(newServer);
    connection.initialized();
    this.startExclusiveAdapters(newServer);
    return newServer;
  }

  captureServerErrors(childProcess, projectPath) {
    childProcess.on('error', err => this.handleSpawnFailure(err));
    childProcess.on('exit', (code, signal) => this.logger.debug(`exit: code ${code} signal ${signal}`));
    childProcess.stderr.setEncoding('utf8');
    childProcess.stderr.on('data', chunk => {
      const errorString = chunk.toString();
      this.handleServerStderr(errorString, projectPath);
      // Keep the last 5 lines for packages to use in messages
      this.processStdErr = (this.processStdErr + errorString).split('\n').slice(-5).join('\n');
    });
  }

  handleSpawnFailure(err) {
    atom.notifications.addError(`${this.getServerName()} language server for ${this.getLanguageName()} unable to start`, {
      dismissable: true,
      description: err.toString()
    });
  }

  // Creates the RPC connection which can be ipc, socket or stdio
  createRpcConnection(process) {
    let reader, writer;
    const connectionType = this.getConnectionType();
    switch (connectionType) {
      case 'ipc':
        reader = new rpc.IPCMessageReader(process);
        writer = new rpc.IPCMessageWriter(process);
        break;
      case 'socket':
        reader = new rpc.SocketMessageReader(this.socket);
        writer = new rpc.SocketMessageWriter(this.socket);
        break;
      case 'stdio':
        reader = new rpc.StreamMessageReader(process.stdout);
        writer = new rpc.StreamMessageWriter(process.stdin);
        break;
    }

    return rpc.createMessageConnection(reader, writer, {
      error: m => {
        this.logger.error(m);
      }
    });
  }

  // Start adapters that are not shared between servers
  startExclusiveAdapters(server) {
    _applyEditAdapter2.default.attach(server.connection);
    _notificationsAdapter2.default.attach(server.connection, this.name);

    if (_documentSyncAdapter2.default.canAdapt(server.capabilities)) {
      server.docSyncAdapter = new _documentSyncAdapter2.default(server.connection, server.capabilities.textDocumentSync, editor => this.shouldSyncForEditor(editor, server.projectPath));
      server.disposable.add(server.docSyncAdapter);
    }

    server.linterPushV2 = new _linterPushV2Adapter2.default(server.connection);
    if (this._linterDelegate != null) {
      server.linterPushV2.attach(this._linterDelegate);
    }

    if (_signatureHelpAdapter2.default.canAdapt(server.capabilities)) {
      server.signatureHelpAdapter = new _signatureHelpAdapter2.default(server, this.getGrammarScopes());
      if (this._signatureHelpRegistry != null) {
        server.signatureHelpAdapter.attach(this._signatureHelpRegistry);
      }
    }
  }

  shouldSyncForEditor(editor, projectPath) {
    return this.isFileInProject(editor, projectPath) && this.shouldStartForEditor(editor);
  }

  isFileInProject(editor, projectPath) {
    return (editor.getURI() || '').startsWith(projectPath);
  }

  // Autocomplete+ via LS completion---------------------------------------
  provideAutocomplete() {
    return {
      selector: this.getGrammarScopes().map(g => '.' + g).join(', '),
      inclusionPriority: 1,
      suggestionPriority: 2,
      excludeLowerPriority: false,
      getSuggestions: this.getSuggestions.bind(this),
      onDidInsertSuggestion: this.onDidInsertSuggestion.bind(this),
      getSuggestionDetailsOnSelect: this.getSuggestionDetailsOnSelect.bind(this)
    };
  }

  async getSuggestions(request) {
    const server = await this._serverManager.getServer(request.editor);
    if (server == null || !_autocompleteAdapter2.default.canAdapt(server.capabilities)) {
      return [];
    }

    this.autoComplete = this.autoComplete || new _autocompleteAdapter2.default();
    this._lastAutocompleteRequest = request;
    return this.autoComplete.getSuggestions(server, request, this.onDidConvertAutocomplete);
  }

  async getSuggestionDetailsOnSelect(suggestion) {
    const request = this._lastAutocompleteRequest;
    if (request == null) {
      return null;
    }
    const server = await this._serverManager.getServer(request.editor);
    if (server == null || !_autocompleteAdapter2.default.canResolve(server.capabilities) || this.autoComplete == null) {
      return null;
    }

    return this.autoComplete.completeSuggestion(server, suggestion, request, this.onDidConvertAutocomplete);
  }

  onDidConvertAutocomplete(completionItem, suggestion, request) {}

  onDidInsertSuggestion(arg) {}

  // Definitions via LS documentHighlight and gotoDefinition------------
  provideDefinitions() {
    return {
      name: this.name,
      priority: 20,
      grammarScopes: this.getGrammarScopes(),
      getDefinition: this.getDefinition.bind(this)
    };
  }

  async getDefinition(editor, point) {
    const server = await this._serverManager.getServer(editor);
    if (server == null || !_definitionAdapter2.default.canAdapt(server.capabilities)) {
      return null;
    }

    this.definitions = this.definitions || new _definitionAdapter2.default();
    return this.definitions.getDefinition(server.connection, server.capabilities, this.getLanguageName(), editor, point);
  }

  // Outline View via LS documentSymbol---------------------------------
  provideOutlines() {
    return {
      name: this.name,
      grammarScopes: this.getGrammarScopes(),
      priority: 1,
      getOutline: this.getOutline.bind(this)
    };
  }

  async getOutline(editor) {
    const server = await this._serverManager.getServer(editor);
    if (server == null || !_outlineViewAdapter2.default.canAdapt(server.capabilities)) {
      return null;
    }

    this.outlineView = this.outlineView || new _outlineViewAdapter2.default();
    return this.outlineView.getOutline(server.connection, editor);
  }

  // Linter push v2 API via LS publishDiagnostics
  consumeLinterV2(registerIndie) {
    this._linterDelegate = registerIndie({ name: this.name });
    if (this._linterDelegate == null) {
      return;
    }

    for (const server of this._serverManager.getActiveServers()) {
      if (server.linterPushV2 != null) {
        server.linterPushV2.attach(this._linterDelegate);
      }
    }
  }

  // Find References via LS findReferences------------------------------
  provideFindReferences() {
    return {
      isEditorSupported: editor => this.getGrammarScopes().includes(editor.getGrammar().scopeName),
      findReferences: this.getReferences.bind(this)
    };
  }

  async getReferences(editor, point) {
    const server = await this._serverManager.getServer(editor);
    if (server == null || !_findReferencesAdapter2.default.canAdapt(server.capabilities)) {
      return null;
    }

    this.findReferences = this.findReferences || new _findReferencesAdapter2.default();
    return this.findReferences.getReferences(server.connection, editor, point, server.projectPath);
  }

  // Datatip via LS textDocument/hover----------------------------------
  consumeDatatip(service) {
    this._disposable.add(service.addProvider({
      providerName: this.name,
      priority: 1,
      grammarScopes: this.getGrammarScopes(),
      validForScope: scopeName => {
        return this.getGrammarScopes().includes(scopeName);
      },
      datatip: this.getDatatip.bind(this)
    }));
  }

  async getDatatip(editor, point) {
    const server = await this._serverManager.getServer(editor);
    if (server == null || !_datatipAdapter2.default.canAdapt(server.capabilities)) {
      return null;
    }

    this.datatip = this.datatip || new _datatipAdapter2.default();
    return this.datatip.getDatatip(server.connection, editor, point);
  }

  // Code Format via LS formatDocument & formatDocumentRange------------
  provideCodeFormat() {
    return {
      grammarScopes: this.getGrammarScopes(),
      priority: 1,
      formatCode: this.getCodeFormat.bind(this)
    };
  }

  async getCodeFormat(editor, range) {
    const server = await this._serverManager.getServer(editor);
    if (server == null || !_codeFormatAdapter2.default.canAdapt(server.capabilities)) {
      return [];
    }

    return _codeFormatAdapter2.default.format(server.connection, server.capabilities, editor, range);
  }

  provideCodeHighlight() {
    return {
      grammarScopes: this.getGrammarScopes(),
      priority: 1,
      highlight: (editor, position) => {
        return this.getCodeHighlight(editor, position);
      }
    };
  }

  async getCodeHighlight(editor, position) {
    const server = await this._serverManager.getServer(editor);
    if (server == null || !_codeHighlightAdapter2.default.canAdapt(server.capabilities)) {
      return null;
    }

    return _codeHighlightAdapter2.default.highlight(server.connection, server.capabilities, editor, position);
  }

  provideCodeActions() {
    return {
      grammarScopes: this.getGrammarScopes(),
      priority: 1,
      getCodeActions: (editor, range, diagnostics) => {
        return this.getCodeActions(editor, range, diagnostics);
      }
    };
  }

  async getCodeActions(editor, range, diagnostics) {
    const server = await this._serverManager.getServer(editor);
    if (server == null || !_codeActionAdapter2.default.canAdapt(server.capabilities)) {
      return null;
    }

    return _codeActionAdapter2.default.getCodeActions(server.connection, server.capabilities, server.linterPushV2, editor, range, diagnostics);
  }

  consumeSignatureHelp(registry) {
    this._signatureHelpRegistry = registry;
    for (const server of this._serverManager.getActiveServers()) {
      if (server.signatureHelpAdapter != null) {
        server.signatureHelpAdapter.attach(registry);
      }
    }
    return new _atom.Disposable(() => {
      this._signatureHelpRegistry = null;
    });
  }

  consumeBusySignal(service) {
    this.busySignalService = service;
    return new _atom.Disposable(() => delete this.busySignalService);
  }

  /**
   * `didChangeWatchedFiles` message filtering, override for custom logic.
   * @param filePath path of a file that has changed in the project path
   * @return false => message will not be sent to the language server
   */
  filterChangeWatchedFiles(filePath) {
    return true;
  }

  /**
   * Called on language server stderr output.
   * @param stderr a chunk of stderr from a language server instance
   */
  handleServerStderr(stderr, projectPath) {
    stderr.split('\n').filter(l => l).forEach(line => this.logger.warn(`stderr ${line}`));
  }
}
exports.default = AutoLanguageClient;
module.exports = exports['default'];
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL2xpYi9hdXRvLWxhbmd1YWdlY2xpZW50LmpzIl0sIm5hbWVzIjpbImNwIiwibHMiLCJycGMiLCJBdXRvTGFuZ3VhZ2VDbGllbnQiLCJfZGlzcG9zYWJsZSIsInByb2Nlc3NTdGRFcnIiLCJnZXRHcmFtbWFyU2NvcGVzIiwiRXJyb3IiLCJnZXRMYW5ndWFnZU5hbWUiLCJnZXRTZXJ2ZXJOYW1lIiwic3RhcnRTZXJ2ZXJQcm9jZXNzIiwicHJvamVjdFBhdGgiLCJzaG91bGRTdGFydEZvckVkaXRvciIsImVkaXRvciIsImluY2x1ZGVzIiwiZ2V0R3JhbW1hciIsInNjb3BlTmFtZSIsImdldEluaXRpYWxpemVQYXJhbXMiLCJwcm9jZXNzIiwicHJvY2Vzc0lkIiwicGlkIiwicm9vdFBhdGgiLCJyb290VXJpIiwicGF0aFRvVXJpIiwiY2FwYWJpbGl0aWVzIiwid29ya3NwYWNlIiwiYXBwbHlFZGl0Iiwid29ya3NwYWNlRWRpdCIsImRvY3VtZW50Q2hhbmdlcyIsImRpZENoYW5nZUNvbmZpZ3VyYXRpb24iLCJkeW5hbWljUmVnaXN0cmF0aW9uIiwiZGlkQ2hhbmdlV2F0Y2hlZEZpbGVzIiwic3ltYm9sIiwiZXhlY3V0ZUNvbW1hbmQiLCJ0ZXh0RG9jdW1lbnQiLCJzeW5jaHJvbml6YXRpb24iLCJ3aWxsU2F2ZSIsIndpbGxTYXZlV2FpdFVudGlsIiwiZGlkU2F2ZSIsImNvbXBsZXRpb24iLCJjb21wbGV0aW9uSXRlbSIsInNuaXBwZXRTdXBwb3J0IiwiY29tbWl0Q2hhcmFjdGVyc1N1cHBvcnQiLCJjb250ZXh0U3VwcG9ydCIsImhvdmVyIiwic2lnbmF0dXJlSGVscCIsInJlZmVyZW5jZXMiLCJkb2N1bWVudEhpZ2hsaWdodCIsImRvY3VtZW50U3ltYm9sIiwiZm9ybWF0dGluZyIsInJhbmdlRm9ybWF0dGluZyIsIm9uVHlwZUZvcm1hdHRpbmciLCJkZWZpbml0aW9uIiwiY29kZUFjdGlvbiIsImNvZGVMZW5zIiwiZG9jdW1lbnRMaW5rIiwicmVuYW1lIiwiZXhwZXJpbWVudGFsIiwicHJlSW5pdGlhbGl6YXRpb24iLCJjb25uZWN0aW9uIiwicG9zdEluaXRpYWxpemF0aW9uIiwic2VydmVyIiwiZ2V0Q29ubmVjdGlvblR5cGUiLCJzb2NrZXQiLCJhY3RpdmF0ZSIsIm5hbWUiLCJsb2dnZXIiLCJnZXRMb2dnZXIiLCJfc2VydmVyTWFuYWdlciIsInAiLCJzdGFydFNlcnZlciIsImUiLCJmaWxlcGF0aCIsImZpbHRlckNoYW5nZVdhdGNoZWRGaWxlcyIsImJ1c3lTaWduYWxTZXJ2aWNlIiwic3RhcnRMaXN0ZW5pbmciLCJvbiIsImV4aXRDbGVhbnVwIiwiYmluZCIsInRlcm1pbmF0ZSIsImRlYWN0aXZhdGUiLCJkaXNwb3NlIiwic3RvcExpc3RlbmluZyIsInN0b3BBbGxTZXJ2ZXJzIiwic3Bhd25DaGlsZE5vZGUiLCJhcmdzIiwib3B0aW9ucyIsImRlYnVnIiwiam9pbiIsImVudiIsIk9iamVjdCIsImNyZWF0ZSIsIkVMRUNUUk9OX1JVTl9BU19OT0RFIiwiRUxFQ1RST05fTk9fQVRUQUNIX0NPTlNPTEUiLCJzcGF3biIsImV4ZWNQYXRoIiwiYXRvbSIsImNvbmZpZyIsImdldCIsInN0YXJ0aW5nU2lnbmFsIiwicmVwb3J0QnVzeSIsImJhc2VuYW1lIiwiY2FwdHVyZVNlcnZlckVycm9ycyIsIkxhbmd1YWdlQ2xpZW50Q29ubmVjdGlvbiIsImNyZWF0ZVJwY0Nvbm5lY3Rpb24iLCJpbml0aWFsaXplUGFyYW1zIiwiaW5pdGlhbGl6YXRpb24iLCJpbml0aWFsaXplIiwicmVwb3J0QnVzeVdoaWxlIiwiaW5pdGlhbGl6ZVJlc3BvbnNlIiwibmV3U2VydmVyIiwiZGlzcG9zYWJsZSIsImluaXRpYWxpemVkIiwic3RhcnRFeGNsdXNpdmVBZGFwdGVycyIsImNoaWxkUHJvY2VzcyIsImVyciIsImhhbmRsZVNwYXduRmFpbHVyZSIsImNvZGUiLCJzaWduYWwiLCJzdGRlcnIiLCJzZXRFbmNvZGluZyIsImNodW5rIiwiZXJyb3JTdHJpbmciLCJ0b1N0cmluZyIsImhhbmRsZVNlcnZlclN0ZGVyciIsInNwbGl0Iiwic2xpY2UiLCJub3RpZmljYXRpb25zIiwiYWRkRXJyb3IiLCJkaXNtaXNzYWJsZSIsImRlc2NyaXB0aW9uIiwicmVhZGVyIiwid3JpdGVyIiwiY29ubmVjdGlvblR5cGUiLCJJUENNZXNzYWdlUmVhZGVyIiwiSVBDTWVzc2FnZVdyaXRlciIsIlNvY2tldE1lc3NhZ2VSZWFkZXIiLCJTb2NrZXRNZXNzYWdlV3JpdGVyIiwiU3RyZWFtTWVzc2FnZVJlYWRlciIsInN0ZG91dCIsIlN0cmVhbU1lc3NhZ2VXcml0ZXIiLCJzdGRpbiIsImNyZWF0ZU1lc3NhZ2VDb25uZWN0aW9uIiwiZXJyb3IiLCJtIiwiYXR0YWNoIiwiY2FuQWRhcHQiLCJkb2NTeW5jQWRhcHRlciIsInRleHREb2N1bWVudFN5bmMiLCJzaG91bGRTeW5jRm9yRWRpdG9yIiwiYWRkIiwibGludGVyUHVzaFYyIiwiX2xpbnRlckRlbGVnYXRlIiwic2lnbmF0dXJlSGVscEFkYXB0ZXIiLCJfc2lnbmF0dXJlSGVscFJlZ2lzdHJ5IiwiaXNGaWxlSW5Qcm9qZWN0IiwiZ2V0VVJJIiwic3RhcnRzV2l0aCIsInByb3ZpZGVBdXRvY29tcGxldGUiLCJzZWxlY3RvciIsIm1hcCIsImciLCJpbmNsdXNpb25Qcmlvcml0eSIsInN1Z2dlc3Rpb25Qcmlvcml0eSIsImV4Y2x1ZGVMb3dlclByaW9yaXR5IiwiZ2V0U3VnZ2VzdGlvbnMiLCJvbkRpZEluc2VydFN1Z2dlc3Rpb24iLCJnZXRTdWdnZXN0aW9uRGV0YWlsc09uU2VsZWN0IiwicmVxdWVzdCIsImdldFNlcnZlciIsImF1dG9Db21wbGV0ZSIsIl9sYXN0QXV0b2NvbXBsZXRlUmVxdWVzdCIsIm9uRGlkQ29udmVydEF1dG9jb21wbGV0ZSIsInN1Z2dlc3Rpb24iLCJjYW5SZXNvbHZlIiwiY29tcGxldGVTdWdnZXN0aW9uIiwiYXJnIiwicHJvdmlkZURlZmluaXRpb25zIiwicHJpb3JpdHkiLCJncmFtbWFyU2NvcGVzIiwiZ2V0RGVmaW5pdGlvbiIsInBvaW50IiwiZGVmaW5pdGlvbnMiLCJwcm92aWRlT3V0bGluZXMiLCJnZXRPdXRsaW5lIiwib3V0bGluZVZpZXciLCJjb25zdW1lTGludGVyVjIiLCJyZWdpc3RlckluZGllIiwiZ2V0QWN0aXZlU2VydmVycyIsInByb3ZpZGVGaW5kUmVmZXJlbmNlcyIsImlzRWRpdG9yU3VwcG9ydGVkIiwiZmluZFJlZmVyZW5jZXMiLCJnZXRSZWZlcmVuY2VzIiwiY29uc3VtZURhdGF0aXAiLCJzZXJ2aWNlIiwiYWRkUHJvdmlkZXIiLCJwcm92aWRlck5hbWUiLCJ2YWxpZEZvclNjb3BlIiwiZGF0YXRpcCIsImdldERhdGF0aXAiLCJwcm92aWRlQ29kZUZvcm1hdCIsImZvcm1hdENvZGUiLCJnZXRDb2RlRm9ybWF0IiwicmFuZ2UiLCJmb3JtYXQiLCJwcm92aWRlQ29kZUhpZ2hsaWdodCIsImhpZ2hsaWdodCIsInBvc2l0aW9uIiwiZ2V0Q29kZUhpZ2hsaWdodCIsInByb3ZpZGVDb2RlQWN0aW9ucyIsImdldENvZGVBY3Rpb25zIiwiZGlhZ25vc3RpY3MiLCJjb25zdW1lU2lnbmF0dXJlSGVscCIsInJlZ2lzdHJ5IiwiY29uc3VtZUJ1c3lTaWduYWwiLCJmaWxlUGF0aCIsImZpbHRlciIsImwiLCJmb3JFYWNoIiwibGluZSIsIndhcm4iXSwibWFwcGluZ3MiOiI7Ozs7QUFFQTs7SUFBWUEsRTs7QUFDWjs7SUFBWUMsRTs7QUFDWjs7SUFBWUMsRzs7QUFDWjs7OztBQUNBOztBQUNBOztBQUNBOztBQUNBOzs7O0FBRUE7Ozs7QUFDQTs7OztBQUNBOzs7O0FBQ0E7Ozs7QUFDQTs7OztBQUNBOzs7O0FBQ0E7Ozs7QUFDQTs7OztBQUNBOzs7O0FBQ0E7Ozs7QUFDQTs7OztBQUNBOzs7O0FBQ0E7Ozs7Ozs7O0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDZSxNQUFNQyxrQkFBTixDQUF5QjtBQUFBO0FBQUEsU0FDdENDLFdBRHNDLEdBQ3hCLCtCQUR3QjtBQUFBLFNBVXRDQyxhQVZzQyxHQVVkLEVBVmM7QUFBQTs7QUFPdEM7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LHVCQUFxQkMsUUFBckIsRUFBMkU7QUFDekUsU0FBSzNELHNCQUFMLEdBQThCMkQsUUFBOUI7QUFDQSxTQUFLLE1BQU14SixNQUFYLElBQXFCLEtBQUtPLGNBQUwsQ0FBb0J3SCxnQkFBcEIsRUFBckIsRUFBNkQ7QUFDM0QsVUFBSS9ILE9BQU80RixvQkFBUCxJQUErQixJQUFuQyxFQUF5QztBQUN2QzVGLGVBQU80RixvQkFBUCxDQUE0QlIsTUFBNUIsQ0FBbUNvRSxRQUFuQztBQUNEO0FBQ0Y7QUFDRCxXQUFPLHFCQUFlLE1BQU07QUFDMUIsV0FBSzNELHNCQUFMLEdBQThCLElBQTlCO0FBQ0QsS0FGTSxDQUFQO0FBR0Q7O0FBRUQ0RCxvQkFBa0JwQixPQUFsQixFQUFtRTtBQUNqRSxTQUFLeEgsaUJBQUwsR0FBeUJ3SCxPQUF6QjtBQUNBLFdBQU8scUJBQWUsTUFBTSxPQUFPLEtBQUt4SCxpQkFBakMsQ0FBUDtBQUNEOztBQUVEOzs7OztBQUtBRCwyQkFBeUI4SSxRQUF6QixFQUFvRDtBQUNsRCxXQUFPLElBQVA7QUFDRDs7QUFFRDs7OztBQUlBM0YscUJBQW1CTCxNQUFuQixFQUFtQzVHLFdBQW5DLEVBQXdEO0FBQ3RENEcsV0FBT00sS0FBUCxDQUFhLElBQWIsRUFBbUIyRixNQUFuQixDQUEwQkMsS0FBS0EsQ0FBL0IsRUFBa0NDLE9BQWxDLENBQTBDQyxRQUFRLEtBQUt6SixNQUFMLENBQVkwSixJQUFaLENBQWtCLFVBQVNELElBQUssRUFBaEMsQ0FBbEQ7QUFDRDtBQTVpQnFDO2tCQUFuQnhOLGtCIiwiZmlsZSI6ImF1dG8tbGFuZ3VhZ2VjbGllbnQuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvLyBAZmxvd1xyXG5cclxuaW1wb3J0ICogYXMgY3AgZnJvbSAnY2hpbGRfcHJvY2Vzcyc7XHJcbmltcG9ydCAqIGFzIGxzIGZyb20gJy4vbGFuZ3VhZ2VjbGllbnQnO1xyXG5pbXBvcnQgKiBhcyBycGMgZnJvbSAndnNjb2RlLWpzb25ycGMnO1xyXG5pbXBvcnQgcGF0aCBmcm9tICdwYXRoJztcclxuaW1wb3J0IHtDb21wb3NpdGVEaXNwb3NhYmxlLCBEaXNwb3NhYmxlfSBmcm9tICdhdG9tJztcclxuaW1wb3J0IHtDb25zb2xlTG9nZ2VyLCBOdWxsTG9nZ2VyLCB0eXBlIExvZ2dlcn0gZnJvbSAnLi9sb2dnZXInO1xyXG5pbXBvcnQge1NlcnZlck1hbmFnZXIsIHR5cGUgQWN0aXZlU2VydmVyfSBmcm9tICcuL3NlcnZlci1tYW5hZ2VyLmpzJztcclxuaW1wb3J0IENvbnZlcnQgZnJvbSAnLi9jb252ZXJ0LmpzJztcclxuXHJcbmltcG9ydCBBcHBseUVkaXRBZGFwdGVyIGZyb20gJy4vYWRhcHRlcnMvYXBwbHktZWRpdC1hZGFwdGVyJztcclxuaW1wb3J0IEF1dG9jb21wbGV0ZUFkYXB0ZXIgZnJvbSAnLi9hZGFwdGVycy9hdXRvY29tcGxldGUtYWRhcHRlcic7XHJcbmltcG9ydCBDb2RlQWN0aW9uQWRhcHRlciBmcm9tICcuL2FkYXB0ZXJzL2NvZGUtYWN0aW9uLWFkYXB0ZXInO1xyXG5pbXBvcnQgQ29kZUZvcm1hdEFkYXB0ZXIgZnJvbSAnLi9hZGFwdGVycy9jb2RlLWZvcm1hdC1hZGFwdGVyJztcclxuaW1wb3J0IENvZGVIaWdobGlnaHRBZGFwdGVyIGZyb20gJy4vYWRhcHRlcnMvY29kZS1oaWdobGlnaHQtYWRhcHRlcic7XHJcbmltcG9ydCBEYXRhdGlwQWRhcHRlciBmcm9tICcuL2FkYXB0ZXJzL2RhdGF0aXAtYWRhcHRlcic7XHJcbmltcG9ydCBEZWZpbml0aW9uQWRhcHRlciBmcm9tICcuL2FkYXB0ZXJzL2RlZmluaXRpb24tYWRhcHRlcic7XHJcbmltcG9ydCBEb2N1bWVudFN5bmNBZGFwdGVyIGZyb20gJy4vYWRhcHRlcnMvZG9jdW1lbnQtc3luYy1hZGFwdGVyJztcclxuaW1wb3J0IEZpbmRSZWZlcmVuY2VzQWRhcHRlciBmcm9tICcuL2FkYXB0ZXJzL2ZpbmQtcmVmZXJlbmNlcy1hZGFwdGVyJztcclxuaW1wb3J0IExpbnRlclB1c2hWMkFkYXB0ZXIgZnJvbSAnLi9hZGFwdGVycy9saW50ZXItcHVzaC12Mi1hZGFwdGVyJztcclxuaW1wb3J0IE5vdGlmaWNhdGlvbnNBZGFwdGVyIGZyb20gJy4vYWRhcHRlcnMvbm90aWZpY2F0aW9ucy1hZGFwdGVyJztcclxuaW1wb3J0IE91dGxpbmVWaWV3QWRhcHRlciBmcm9tICcuL2FkYXB0ZXJzL291dGxpbmUtdmlldy1hZGFwdGVyJztcclxuaW1wb3J0IFNpZ25hdHVyZUhlbHBBZGFwdGVyIGZyb20gJy4vYWRhcHRlcnMvc2lnbmF0dXJlLWhlbHAtYWRhcHRlcic7XHJcblxyXG50eXBlIENvbm5lY3Rpb25UeXBlID0gJ3N0ZGlvJyB8ICdzb2NrZXQnIHwgJ2lwYyc7XHJcblxyXG4vLyBQdWJsaWM6IEF1dG9MYW5ndWFnZUNsaWVudCBwcm92aWRlcyBhIHNpbXBsZSB3YXkgdG8gaGF2ZSBhbGwgdGhlIHN1cHBvcnRlZFxyXG4vLyBBdG9tLUlERSBzZXJ2aWNlcyB3aXJlZCB1cCBlbnRpcmVseSBmb3IgeW91IGJ5IGp1c3Qgc3ViY2xhc3NpbmcgaXQgYW5kXHJcbi8vIGltcGxlbWVudGluZyBzdGFydFNlcnZlclByb2Nlc3MvZ2V0R3JhbW1hclNjb3Blcy9nZXRMYW5ndWFnZU5hbWUgYW5kXHJcbi8vIGdldFNlcnZlck5hbWUuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEF1dG9MYW5ndWFnZUNsaWVudCB7XHJcbiAgX2Rpc3Bvc2FibGUgPSBuZXcgQ29tcG9zaXRlRGlzcG9zYWJsZSgpO1xyXG4gIF9zZXJ2ZXJNYW5hZ2VyOiBTZXJ2ZXJNYW5hZ2VyO1xyXG4gIF9saW50ZXJEZWxlZ2F0ZTogbGludGVyJFYySW5kaWVEZWxlZ2F0ZTtcclxuICBfc2lnbmF0dXJlSGVscFJlZ2lzdHJ5OiA/YXRvbUlkZSRTaWduYXR1cmVIZWxwUmVnaXN0cnk7XHJcbiAgX2xhc3RBdXRvY29tcGxldGVSZXF1ZXN0OiA/YXRvbSRBdXRvY29tcGxldGVSZXF1ZXN0O1xyXG5cclxuICAvLyBBdmFpbGFibGUgaWYgY29uc3VtZUJ1c3lTaWduYWwgaXMgc2V0dXBcclxuICBidXN5U2lnbmFsU2VydmljZTogP2F0b21JZGUkQnVzeVNpZ25hbFNlcnZpY2U7XHJcblxyXG4gIHByb2Nlc3NTdGRFcnI6IHN0cmluZyA9ICcnO1xyXG4gIGxvZ2dlcjogTG9nZ2VyO1xyXG4gIG5hbWU6IHN0cmluZztcclxuICBzb2NrZXQ6IG5ldCRTb2NrZXQ7XHJcblxyXG4gIC8vIFNoYXJlZCBhZGFwdGVycyB0aGF0IGNhbiB0YWtlIHRoZSBSUEMgY29ubmVjdGlvbiBhcyByZXF1aXJlZFxyXG4gIGF1dG9Db21wbGV0ZTogP0F1dG9jb21wbGV0ZUFkYXB0ZXI7XHJcbiAgZGF0YXRpcDogP0RhdGF0aXBBZGFwdGVyO1xyXG4gIGRlZmluaXRpb25zOiA/RGVmaW5pdGlvbkFkYXB0ZXI7XHJcbiAgZmluZFJlZmVyZW5jZXM6ID9GaW5kUmVmZXJlbmNlc0FkYXB0ZXI7XHJcbiAgb3V0bGluZVZpZXc6ID9PdXRsaW5lVmlld0FkYXB0ZXI7XHJcblxyXG4gIC8vIFlvdSBtdXN0IGltcGxlbWVudCB0aGVzZSBzbyB3ZSBrbm93IGhvdyB0byBkZWFsIHdpdGggeW91ciBsYW5ndWFnZSBhbmQgc2VydmVyXHJcbiAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cclxuICAvLyBSZXR1cm4gYW4gYXJyYXkgb2YgdGhlIGdyYW1tYXIgc2NvcGVzIHlvdSBoYW5kbGUsIGUuZy4gWyAnc291cmNlLmpzJyBdXHJcbiAgZ2V0R3JhbW1hclNjb3BlcygpOiBBcnJheTxzdHJpbmc+IHtcclxuICAgIHRocm93IEVycm9yKCdNdXN0IGltcGxlbWVudCBnZXRHcmFtbWFyU2NvcGVzIHdoZW4gZXh0ZW5kaW5nIEF1dG9MYW5ndWFnZUNsaWVudCcpO1xyXG4gIH1cclxuXHJcbiAgLy8gUmV0dXJuIHRoZSBuYW1lIG9mIHRoZSBsYW5ndWFnZSB5b3Ugc3VwcG9ydCwgZS5nLiAnSmF2YVNjcmlwdCdcclxuICBnZXRMYW5ndWFnZU5hbWUoKTogc3RyaW5nIHtcclxuICAgIHRocm93IEVycm9yKCdNdXN0IGltcGxlbWVudCBnZXRMYW5ndWFnZU5hbWUgd2hlbiBleHRlbmRpbmcgQXV0b0xhbmd1YWdlQ2xpZW50Jyk7XHJcbiAgfVxyXG5cclxuICAvLyBSZXR1cm4gdGhlIG5hbWUgb2YgeW91ciBzZXJ2ZXIsIGUuZy4gJ0VjbGlwc2UgSkRUJ1xyXG4gIGdldFNlcnZlck5hbWUoKTogc3RyaW5nIHtcclxuICAgIHRocm93IEVycm9yKCdNdXN0IGltcGxlbWVudCBnZXRTZXJ2ZXJOYW1lIHdoZW4gZXh0ZW5kaW5nIEF1dG9MYW5ndWFnZUNsaWVudCcpO1xyXG4gIH1cclxuXHJcbiAgLy8gU3RhcnQgeW91ciBzZXJ2ZXIgcHJvY2Vzc1xyXG4gIHN0YXJ0U2VydmVyUHJvY2Vzcyhwcm9qZWN0UGF0aDogc3RyaW5nKTogY2hpbGRfcHJvY2VzcyRDaGlsZFByb2Nlc3MgfCBQcm9taXNlPGNoaWxkX3Byb2Nlc3MkQ2hpbGRQcm9jZXNzPiB7XHJcbiAgICB0aHJvdyBFcnJvcignTXVzdCBvdmVycmlkZSBzdGFydFNlcnZlclByb2Nlc3MgdG8gc3RhcnQgbGFuZ3VhZ2Ugc2VydmVyIHByb2Nlc3Mgd2hlbiBleHRlbmRpbmcgQXV0b0xhbmd1YWdlQ2xpZW50Jyk7XHJcbiAgfVxyXG5cclxuICAvLyBZb3UgbWlnaHQgd2FudCB0byBvdmVycmlkZSB0aGVzZSBmb3IgZGlmZmVyZW50IGJlaGF2aW9yXHJcbiAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG4gIC8vIERldGVybWluZSB3aGV0aGVyIHdlIHNob3VsZCBzdGFydCBhIHNlcnZlciBmb3IgYSBnaXZlbiBlZGl0b3IgaWYgd2UgZG9uJ3QgaGF2ZSBvbmUgeWV0XHJcbiAgc2hvdWxkU3RhcnRGb3JFZGl0b3IoZWRpdG9yOiBhdG9tJFRleHRFZGl0b3IpOiBib29sZWFuIHtcclxuICAgIHJldHVybiB0aGlzLmdldEdyYW1tYXJTY29wZXMoKS5pbmNsdWRlcyhlZGl0b3IuZ2V0R3JhbW1hcigpLnNjb3BlTmFtZSk7XHJcbiAgfVxyXG5cclxuICAvLyBSZXR1cm4gdGhlIHBhcmFtZXRlcnMgdXNlZCB0byBpbml0aWFsaXplIGEgY2xpZW50IC0geW91IG1heSB3YW50IHRvIGV4dGVuZCBjYXBhYmlsaXRpZXNcclxuICBnZXRJbml0aWFsaXplUGFyYW1zKHByb2plY3RQYXRoOiBzdHJpbmcsIHByb2Nlc3M6IGNoaWxkX3Byb2Nlc3MkQ2hpbGRQcm9jZXNzKTogbHMuSW5pdGlhbGl6ZVBhcmFtcyB7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBwcm9jZXNzSWQ6IHByb2Nlc3MucGlkLFxyXG4gICAgICByb290UGF0aDogcHJvamVjdFBhdGgsXHJcbiAgICAgIHJvb3RVcmk6IENvbnZlcnQucGF0aFRvVXJpKHByb2plY3RQYXRoKSxcclxuICAgICAgY2FwYWJpbGl0aWVzOiB7XHJcbiAgICAgICAgd29ya3NwYWNlOiB7XHJcbiAgICAgICAgICBhcHBseUVkaXQ6IHRydWUsXHJcbiAgICAgICAgICB3b3Jrc3BhY2VFZGl0OiB7XHJcbiAgICAgICAgICAgIGRvY3VtZW50Q2hhbmdlczogdHJ1ZSxcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgICBkaWRDaGFuZ2VDb25maWd1cmF0aW9uOiB7XHJcbiAgICAgICAgICAgIGR5bmFtaWNSZWdpc3RyYXRpb246IGZhbHNlLFxyXG4gICAgICAgICAgfSxcclxuICAgICAgICAgIGRpZENoYW5nZVdhdGNoZWRGaWxlczoge1xyXG4gICAgICAgICAgICBkeW5hbWljUmVnaXN0cmF0aW9uOiBmYWxzZSxcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgICBzeW1ib2w6IHtcclxuICAgICAgICAgICAgZHluYW1pY1JlZ2lzdHJhdGlvbjogZmFsc2UsXHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgICAgZXhlY3V0ZUNvbW1hbmQ6IHtcclxuICAgICAgICAgICAgZHluYW1pY1JlZ2lzdHJhdGlvbjogZmFsc2UsXHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgdGV4dERvY3VtZW50OiB7XHJcbiAgICAgICAgICBzeW5jaHJvbml6YXRpb246IHtcclxuICAgICAgICAgICAgZHluYW1pY1JlZ2lzdHJhdGlvbjogZmFsc2UsXHJcbiAgICAgICAgICAgIHdpbGxTYXZlOiB0cnVlLFxyXG4gICAgICAgICAgICB3aWxsU2F2ZVdhaXRVbnRpbDogZmFsc2UsXHJcbiAgICAgICAgICAgIGRpZFNhdmU6IHRydWUsXHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgICAgY29tcGxldGlvbjoge1xyXG4gICAgICAgICAgICBkeW5hbWljUmVnaXN0cmF0aW9uOiBmYWxzZSxcclxuICAgICAgICAgICAgY29tcGxldGlvbkl0ZW06IHtcclxuICAgICAgICAgICAgICBzbmlwcGV0U3VwcG9ydDogdHJ1ZSxcclxuICAgICAgICAgICAgICBjb21taXRDaGFyYWN0ZXJzU3VwcG9ydDogZmFsc2UsXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGNvbnRleHRTdXBwb3J0OiB0cnVlLFxyXG4gICAgICAgICAgfSxcclxuICAgICAgICAgIGhvdmVyOiB7XHJcbiAgICAgICAgICAgIGR5bmFtaWNSZWdpc3RyYXRpb246IGZhbHNlLFxyXG4gICAgICAgICAgfSxcclxuICAgICAgICAgIHNpZ25hdHVyZUhlbHA6IHtcclxuICAgICAgICAgICAgZHluYW1pY1JlZ2lzdHJhdGlvbjogZmFsc2UsXHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgICAgcmVmZXJlbmNlczoge1xyXG4gICAgICAgICAgICBkeW5hbWljUmVnaXN0cmF0aW9uOiBmYWxzZSxcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgICBkb2N1bWVudEhpZ2hsaWdodDoge1xyXG4gICAgICAgICAgICBkeW5hbWljUmVnaXN0cmF0aW9uOiBmYWxzZSxcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgICBkb2N1bWVudFN5bWJvbDoge1xyXG4gICAgICAgICAgICBkeW5hbWljUmVnaXN0cmF0aW9uOiBmYWxzZSxcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgICBmb3JtYXR0aW5nOiB7XHJcbiAgICAgICAgICAgIGR5bmFtaWNSZWdpc3RyYXRpb246IGZhbHNlLFxyXG4gICAgICAgICAgfSxcclxuICAgICAgICAgIHJhbmdlRm9ybWF0dGluZzoge1xyXG4gICAgICAgICAgICBkeW5hbWljUmVnaXN0cmF0aW9uOiBmYWxzZSxcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgICBvblR5cGVGb3JtYXR0aW5nOiB7XHJcbiAgICAgICAgICAgIGR5bmFtaWNSZWdpc3RyYXRpb246IGZhbHNlLFxyXG4gICAgICAgICAgfSxcclxuICAgICAgICAgIGRlZmluaXRpb246IHtcclxuICAgICAgICAgICAgZHluYW1pY1JlZ2lzdHJhdGlvbjogZmFsc2UsXHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgICAgY29kZUFjdGlvbjoge1xyXG4gICAgICAgICAgICBkeW5hbWljUmVnaXN0cmF0aW9uOiBmYWxzZSxcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgICBjb2RlTGVuczoge1xyXG4gICAgICAgICAgICBkeW5hbWljUmVnaXN0cmF0aW9uOiBmYWxzZSxcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgICBkb2N1bWVudExpbms6IHtcclxuICAgICAgICAgICAgZHluYW1pY1JlZ2lzdHJhdGlvbjogZmFsc2UsXHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgICAgcmVuYW1lOiB7XHJcbiAgICAgICAgICAgIGR5bmFtaWNSZWdpc3RyYXRpb246IGZhbHNlLFxyXG4gICAgICAgICAgfSxcclxuICAgICAgICB9LFxyXG4gICAgICAgIGV4cGVyaW1lbnRhbDoge30sXHJcbiAgICAgIH0sXHJcbiAgICB9O1xyXG4gIH1cclxuXHJcbiAgLy8gRWFybHkgd2lyZS11cCBvZiBsaXN0ZW5lcnMgYmVmb3JlIGluaXRpYWxpemUgbWV0aG9kIGlzIHNlbnRcclxuICBwcmVJbml0aWFsaXphdGlvbihjb25uZWN0aW9uOiBscy5MYW5ndWFnZUNsaWVudENvbm5lY3Rpb24pOiB2b2lkIHt9XHJcblxyXG4gIC8vIExhdGUgd2lyZS11cCBvZiBsaXN0ZW5lcnMgYWZ0ZXIgaW5pdGlhbGl6ZSBtZXRob2QgaGFzIGJlZW4gc2VudFxyXG4gIHBvc3RJbml0aWFsaXphdGlvbihzZXJ2ZXI6IEFjdGl2ZVNlcnZlcik6IHZvaWQge31cclxuXHJcbiAgLy8gRGV0ZXJtaW5lIHdoZXRoZXIgdG8gdXNlIGlwYywgc3RkaW8gb3Igc29ja2V0IHRvIGNvbm5lY3QgdG8gdGhlIHNlcnZlclxyXG4gIGdldENvbm5lY3Rpb25UeXBlKCk6IENvbm5lY3Rpb25UeXBlIHtcclxuICAgIHJldHVybiB0aGlzLnNvY2tldCAhPSBudWxsID8gJ3NvY2tldCcgOiAnc3RkaW8nO1xyXG4gIH1cclxuXHJcbiAgLy8gRGVmYXVsdCBpbXBsZW1lbnRhdGlvbiBvZiB0aGUgcmVzdCBvZiB0aGUgQXV0b0xhbmd1YWdlQ2xpZW50XHJcbiAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG4gIC8vIEFjdGl2YXRlIGRvZXMgdmVyeSBsaXR0bGUgZm9yIHBlcmYgcmVhc29ucyAtIGhvb2tzIGluIHZpYSBTZXJ2ZXJNYW5hZ2VyIGZvciBsYXRlciAnYWN0aXZhdGlvbidcclxuICBhY3RpdmF0ZSgpOiB2b2lkIHtcclxuICAgIHRoaXMubmFtZSA9IGAke3RoaXMuZ2V0TGFuZ3VhZ2VOYW1lKCl9ICgke3RoaXMuZ2V0U2VydmVyTmFtZSgpfSlgO1xyXG4gICAgdGhpcy5sb2dnZXIgPSB0aGlzLmdldExvZ2dlcigpO1xyXG4gICAgdGhpcy5fc2VydmVyTWFuYWdlciA9IG5ldyBTZXJ2ZXJNYW5hZ2VyKFxyXG4gICAgICBwID0+IHRoaXMuc3RhcnRTZXJ2ZXIocCksXHJcbiAgICAgIHRoaXMubG9nZ2VyLFxyXG4gICAgICBlID0+IHRoaXMuc2hvdWxkU3RhcnRGb3JFZGl0b3IoZSksXHJcbiAgICAgIGZpbGVwYXRoID0+IHRoaXMuZmlsdGVyQ2hhbmdlV2F0Y2hlZEZpbGVzKGZpbGVwYXRoKSxcclxuICAgICAgKCkgPT4gdGhpcy5idXN5U2lnbmFsU2VydmljZSxcclxuICAgICAgdGhpcy5nZXRTZXJ2ZXJOYW1lKCksXHJcbiAgICApO1xyXG4gICAgdGhpcy5fc2VydmVyTWFuYWdlci5zdGFydExpc3RlbmluZygpO1xyXG4gICAgcHJvY2Vzcy5vbignZXhpdCcsICgpID0+IHRoaXMuZXhpdENsZWFudXAuYmluZCh0aGlzKSk7XHJcbiAgfVxyXG5cclxuICBleGl0Q2xlYW51cCgpOiB2b2lkIHtcclxuICAgIHRoaXMuX3NlcnZlck1hbmFnZXIudGVybWluYXRlKCk7XHJcbiAgfVxyXG5cclxuICAvLyBEZWFjdGl2YXRlIGRpc3Bvc2VzIHRoZSByZXNvdXJjZXMgd2UncmUgdXNpbmdcclxuICBhc3luYyBkZWFjdGl2YXRlKCk6IFByb21pc2U8YW55PiB7XHJcbiAgICB0aGlzLl9kaXNwb3NhYmxlLmRpc3Bvc2UoKTtcclxuICAgIHRoaXMuX3NlcnZlck1hbmFnZXIuc3RvcExpc3RlbmluZygpO1xyXG4gICAgYXdhaXQgdGhpcy5fc2VydmVyTWFuYWdlci5zdG9wQWxsU2VydmVycygpO1xyXG4gIH1cclxuXHJcbiAgc3Bhd25DaGlsZE5vZGUoYXJnczogQXJyYXk8c3RyaW5nPiwgb3B0aW9ucz86IGNoaWxkX3Byb2Nlc3Mkc3Bhd25PcHRzID0ge30pOiBjaGlsZF9wcm9jZXNzJENoaWxkUHJvY2VzcyB7XHJcbiAgICB0aGlzLmxvZ2dlci5kZWJ1Zyhgc3RhcnRpbmcgY2hpbGQgTm9kZSBcIiR7YXJncy5qb2luKCcgJyl9XCJgKTtcclxuICAgIG9wdGlvbnMuZW52ID0gb3B0aW9ucy5lbnYgfHwgT2JqZWN0LmNyZWF0ZShwcm9jZXNzLmVudik7XHJcbiAgICBvcHRpb25zLmVudi5FTEVDVFJPTl9SVU5fQVNfTk9ERSA9ICcxJztcclxuICAgIG9wdGlvbnMuZW52LkVMRUNUUk9OX05PX0FUVEFDSF9DT05TT0xFID0gJzEnO1xyXG4gICAgcmV0dXJuIGNwLnNwYXduKHByb2Nlc3MuZXhlY1BhdGgsIGFyZ3MsIG9wdGlvbnMpO1xyXG4gIH1cclxuXHJcbiAgLy8gQnkgZGVmYXVsdCBMU1AgbG9nZ2luZyBpcyBzd2l0Y2hlZCBvZmYgYnV0IHlvdSBjYW4gc3dpdGNoIGl0IG9uIHZpYSB0aGUgY29yZS5kZWJ1Z0xTUCBzZXR0aW5nXHJcbiAgZ2V0TG9nZ2VyKCk6IExvZ2dlciB7XHJcbiAgICByZXR1cm4gYXRvbS5jb25maWcuZ2V0KCdjb3JlLmRlYnVnTFNQJykgPyBuZXcgQ29uc29sZUxvZ2dlcih0aGlzLm5hbWUpIDogbmV3IE51bGxMb2dnZXIoKTtcclxuICB9XHJcblxyXG4gIC8vIFN0YXJ0cyB0aGUgc2VydmVyIGJ5IHN0YXJ0aW5nIHRoZSBwcm9jZXNzLCB0aGVuIGluaXRpYWxpemluZyB0aGUgbGFuZ3VhZ2Ugc2VydmVyIGFuZCBzdGFydGluZyBhZGFwdGVyc1xyXG4gIGFzeW5jIHN0YXJ0U2VydmVyKHByb2plY3RQYXRoOiBzdHJpbmcpOiBQcm9taXNlPEFjdGl2ZVNlcnZlcj4ge1xyXG4gICAgY29uc3Qgc3RhcnRpbmdTaWduYWwgPSB0aGlzLmJ1c3lTaWduYWxTZXJ2aWNlICYmIHRoaXMuYnVzeVNpZ25hbFNlcnZpY2UucmVwb3J0QnVzeShcclxuICAgICAgYFN0YXJ0aW5nICR7dGhpcy5nZXRTZXJ2ZXJOYW1lKCl9IGZvciAke3BhdGguYmFzZW5hbWUocHJvamVjdFBhdGgpfWAsXHJcbiAgICApO1xyXG4gICAgbGV0IHByb2Nlc3M7XHJcbiAgICB0cnkge1xyXG4gICAgICBwcm9jZXNzID0gYXdhaXQgdGhpcy5zdGFydFNlcnZlclByb2Nlc3MocHJvamVjdFBhdGgpO1xyXG4gICAgfSBmaW5hbGx5IHtcclxuICAgICAgc3RhcnRpbmdTaWduYWwgJiYgc3RhcnRpbmdTaWduYWwuZGlzcG9zZSgpO1xyXG4gICAgfVxyXG4gICAgdGhpcy5jYXB0dXJlU2VydmVyRXJyb3JzKHByb2Nlc3MsIHByb2plY3RQYXRoKTtcclxuICAgIGNvbnN0IGNvbm5lY3Rpb24gPSBuZXcgbHMuTGFuZ3VhZ2VDbGllbnRDb25uZWN0aW9uKHRoaXMuY3JlYXRlUnBjQ29ubmVjdGlvbihwcm9jZXNzKSwgdGhpcy5sb2dnZXIpO1xyXG4gICAgdGhpcy5wcmVJbml0aWFsaXphdGlvbihjb25uZWN0aW9uKTtcclxuICAgIGNvbnN0IGluaXRpYWxpemVQYXJhbXMgPSB0aGlzLmdldEluaXRpYWxpemVQYXJhbXMocHJvamVjdFBhdGgsIHByb2Nlc3MpO1xyXG4gICAgY29uc3QgaW5pdGlhbGl6YXRpb24gPSBjb25uZWN0aW9uLmluaXRpYWxpemUoaW5pdGlhbGl6ZVBhcmFtcyk7XHJcbiAgICB0aGlzLmJ1c3lTaWduYWxTZXJ2aWNlICYmIHRoaXMuYnVzeVNpZ25hbFNlcnZpY2UucmVwb3J0QnVzeVdoaWxlKFxyXG4gICAgICBgJHt0aGlzLmdldFNlcnZlck5hbWUoKX0gaW5pdGlhbGl6aW5nIGZvciAke3BhdGguYmFzZW5hbWUocHJvamVjdFBhdGgpfWAsXHJcbiAgICAgICgpID0+IGluaXRpYWxpemF0aW9uLFxyXG4gICAgKTtcclxuICAgIGNvbnN0IGluaXRpYWxpemVSZXNwb25zZSA9IGF3YWl0IGluaXRpYWxpemF0aW9uO1xyXG4gICAgY29uc3QgbmV3U2VydmVyID0ge1xyXG4gICAgICBwcm9qZWN0UGF0aCxcclxuICAgICAgcHJvY2VzcyxcclxuICAgICAgY29ubmVjdGlvbixcclxuICAgICAgY2FwYWJpbGl0aWVzOiBpbml0aWFsaXplUmVzcG9uc2UuY2FwYWJpbGl0aWVzLFxyXG4gICAgICBkaXNwb3NhYmxlOiBuZXcgQ29tcG9zaXRlRGlzcG9zYWJsZSgpLFxyXG4gICAgfTtcclxuICAgIHRoaXMucG9zdEluaXRpYWxpemF0aW9uKG5ld1NlcnZlcik7XHJcbiAgICBjb25uZWN0aW9uLmluaXRpYWxpemVkKCk7XHJcbiAgICB0aGlzLnN0YXJ0RXhjbHVzaXZlQWRhcHRlcnMobmV3U2VydmVyKTtcclxuICAgIHJldHVybiBuZXdTZXJ2ZXI7XHJcbiAgfVxyXG5cclxuICBjYXB0dXJlU2VydmVyRXJyb3JzKGNoaWxkUHJvY2VzczogY2hpbGRfcHJvY2VzcyRDaGlsZFByb2Nlc3MsIHByb2plY3RQYXRoOiBzdHJpbmcpOiB2b2lkIHtcclxuICAgIGNoaWxkUHJvY2Vzcy5vbignZXJyb3InLCBlcnIgPT4gdGhpcy5oYW5kbGVTcGF3bkZhaWx1cmUoZXJyKSk7XHJcbiAgICBjaGlsZFByb2Nlc3Mub24oJ2V4aXQnLCAoY29kZSwgc2lnbmFsKSA9PiB0aGlzLmxvZ2dlci5kZWJ1ZyhgZXhpdDogY29kZSAke2NvZGV9IHNpZ25hbCAke3NpZ25hbH1gKSk7XHJcbiAgICBjaGlsZFByb2Nlc3Muc3RkZXJyLnNldEVuY29kaW5nKCd1dGY4Jyk7XHJcbiAgICBjaGlsZFByb2Nlc3Muc3RkZXJyLm9uKCdkYXRhJywgKGNodW5rOiBCdWZmZXIpID0+IHtcclxuICAgICAgY29uc3QgZXJyb3JTdHJpbmcgPSBjaHVuay50b1N0cmluZygpO1xyXG4gICAgICB0aGlzLmhhbmRsZVNlcnZlclN0ZGVycihlcnJvclN0cmluZywgcHJvamVjdFBhdGgpO1xyXG4gICAgICAvLyBLZWVwIHRoZSBsYXN0IDUgbGluZXMgZm9yIHBhY2thZ2VzIHRvIHVzZSBpbiBtZXNzYWdlc1xyXG4gICAgICB0aGlzLnByb2Nlc3NTdGRFcnIgPSAodGhpcy5wcm9jZXNzU3RkRXJyICsgZXJyb3JTdHJpbmcpXHJcbiAgICAgICAgLnNwbGl0KCdcXG4nKVxyXG4gICAgICAgIC5zbGljZSgtNSlcclxuICAgICAgICAuam9pbignXFxuJyk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGhhbmRsZVNwYXduRmFpbHVyZShlcnI6IGFueSk6IHZvaWQge1xyXG4gICAgYXRvbS5ub3RpZmljYXRpb25zLmFkZEVycm9yKFxyXG4gICAgICBgJHt0aGlzLmdldFNlcnZlck5hbWUoKX0gbGFuZ3VhZ2Ugc2VydmVyIGZvciAke3RoaXMuZ2V0TGFuZ3VhZ2VOYW1lKCl9IHVuYWJsZSB0byBzdGFydGAsXHJcbiAgICAgIHtcclxuICAgICAgICBkaXNtaXNzYWJsZTogdHJ1ZSxcclxuICAgICAgICBkZXNjcmlwdGlvbjogZXJyLnRvU3RyaW5nKCksXHJcbiAgICAgIH0sXHJcbiAgICApO1xyXG4gIH1cclxuXHJcbiAgLy8gQ3JlYXRlcyB0aGUgUlBDIGNvbm5lY3Rpb24gd2hpY2ggY2FuIGJlIGlwYywgc29ja2V0IG9yIHN0ZGlvXHJcbiAgY3JlYXRlUnBjQ29ubmVjdGlvbihwcm9jZXNzOiBjaGlsZF9wcm9jZXNzJENoaWxkUHJvY2Vzcyk6IHJwYy5Db25uZWN0aW9uIHtcclxuICAgIGxldCByZWFkZXIsIHdyaXRlcjtcclxuICAgIGNvbnN0IGNvbm5lY3Rpb25UeXBlID0gdGhpcy5nZXRDb25uZWN0aW9uVHlwZSgpO1xyXG4gICAgc3dpdGNoIChjb25uZWN0aW9uVHlwZSkge1xyXG4gICAgICBjYXNlICdpcGMnOlxyXG4gICAgICAgIHJlYWRlciA9IG5ldyBycGMuSVBDTWVzc2FnZVJlYWRlcihwcm9jZXNzKTtcclxuICAgICAgICB3cml0ZXIgPSBuZXcgcnBjLklQQ01lc3NhZ2VXcml0ZXIocHJvY2Vzcyk7XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICAgIGNhc2UgJ3NvY2tldCc6XHJcbiAgICAgICAgcmVhZGVyID0gbmV3IHJwYy5Tb2NrZXRNZXNzYWdlUmVhZGVyKHRoaXMuc29ja2V0KTtcclxuICAgICAgICB3cml0ZXIgPSBuZXcgcnBjLlNvY2tldE1lc3NhZ2VXcml0ZXIodGhpcy5zb2NrZXQpO1xyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgICBjYXNlICdzdGRpbyc6XHJcbiAgICAgICAgcmVhZGVyID0gbmV3IHJwYy5TdHJlYW1NZXNzYWdlUmVhZGVyKHByb2Nlc3Muc3Rkb3V0KTtcclxuICAgICAgICB3cml0ZXIgPSBuZXcgcnBjLlN0cmVhbU1lc3NhZ2VXcml0ZXIocHJvY2Vzcy5zdGRpbik7XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHJwYy5jcmVhdGVNZXNzYWdlQ29ubmVjdGlvbihyZWFkZXIsIHdyaXRlciwge1xyXG4gICAgICBlcnJvcjogbSA9PiB7XHJcbiAgICAgICAgdGhpcy5sb2dnZXIuZXJyb3IobSk7XHJcbiAgICAgIH0sXHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIC8vIFN0YXJ0IGFkYXB0ZXJzIHRoYXQgYXJlIG5vdCBzaGFyZWQgYmV0d2VlbiBzZXJ2ZXJzXHJcbiAgc3RhcnRFeGNsdXNpdmVBZGFwdGVycyhzZXJ2ZXI6IEFjdGl2ZVNlcnZlcik6IHZvaWQge1xyXG4gICAgQXBwbHlFZGl0QWRhcHRlci5hdHRhY2goc2VydmVyLmNvbm5lY3Rpb24pO1xyXG4gICAgTm90aWZpY2F0aW9uc0FkYXB0ZXIuYXR0YWNoKHNlcnZlci5jb25uZWN0aW9uLCB0aGlzLm5hbWUpO1xyXG5cclxuICAgIGlmIChEb2N1bWVudFN5bmNBZGFwdGVyLmNhbkFkYXB0KHNlcnZlci5jYXBhYmlsaXRpZXMpKSB7XHJcbiAgICAgIHNlcnZlci5kb2NTeW5jQWRhcHRlciA9IG5ldyBEb2N1bWVudFN5bmNBZGFwdGVyKHNlcnZlci5jb25uZWN0aW9uLCBzZXJ2ZXIuY2FwYWJpbGl0aWVzLnRleHREb2N1bWVudFN5bmMsIGVkaXRvciA9PlxyXG4gICAgICAgIHRoaXMuc2hvdWxkU3luY0ZvckVkaXRvcihlZGl0b3IsIHNlcnZlci5wcm9qZWN0UGF0aCksXHJcbiAgICAgICk7XHJcbiAgICAgIHNlcnZlci5kaXNwb3NhYmxlLmFkZChzZXJ2ZXIuZG9jU3luY0FkYXB0ZXIpO1xyXG4gICAgfVxyXG5cclxuICAgIHNlcnZlci5saW50ZXJQdXNoVjIgPSBuZXcgTGludGVyUHVzaFYyQWRhcHRlcihzZXJ2ZXIuY29ubmVjdGlvbik7XHJcbiAgICBpZiAodGhpcy5fbGludGVyRGVsZWdhdGUgIT0gbnVsbCkge1xyXG4gICAgICBzZXJ2ZXIubGludGVyUHVzaFYyLmF0dGFjaCh0aGlzLl9saW50ZXJEZWxlZ2F0ZSk7XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKFNpZ25hdHVyZUhlbHBBZGFwdGVyLmNhbkFkYXB0KHNlcnZlci5jYXBhYmlsaXRpZXMpKSB7XHJcbiAgICAgIHNlcnZlci5zaWduYXR1cmVIZWxwQWRhcHRlciA9IG5ldyBTaWduYXR1cmVIZWxwQWRhcHRlcihzZXJ2ZXIsIHRoaXMuZ2V0R3JhbW1hclNjb3BlcygpKTtcclxuICAgICAgaWYgKHRoaXMuX3NpZ25hdHVyZUhlbHBSZWdpc3RyeSAhPSBudWxsKSB7XHJcbiAgICAgICAgc2VydmVyLnNpZ25hdHVyZUhlbHBBZGFwdGVyLmF0dGFjaCh0aGlzLl9zaWduYXR1cmVIZWxwUmVnaXN0cnkpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBzaG91bGRTeW5jRm9yRWRpdG9yKGVkaXRvcjogYXRvbSRUZXh0RWRpdG9yLCBwcm9qZWN0UGF0aDogc3RyaW5nKTogYm9vbGVhbiB7XHJcbiAgICByZXR1cm4gdGhpcy5pc0ZpbGVJblByb2plY3QoZWRpdG9yLCBwcm9qZWN0UGF0aCkgJiYgdGhpcy5zaG91bGRTdGFydEZvckVkaXRvcihlZGl0b3IpO1xyXG4gIH1cclxuXHJcbiAgaXNGaWxlSW5Qcm9qZWN0KGVkaXRvcjogYXRvbSRUZXh0RWRpdG9yLCBwcm9qZWN0UGF0aDogc3RyaW5nKTogYm9vbGVhbiB7XHJcbiAgICByZXR1cm4gKGVkaXRvci5nZXRVUkkoKSB8fCAnJykuc3RhcnRzV2l0aChwcm9qZWN0UGF0aCk7XHJcbiAgfVxyXG5cclxuICAvLyBBdXRvY29tcGxldGUrIHZpYSBMUyBjb21wbGV0aW9uLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgcHJvdmlkZUF1dG9jb21wbGV0ZSgpOiBhdG9tJEF1dG9jb21wbGV0ZVByb3ZpZGVyIHtcclxuICAgIHJldHVybiB7XHJcbiAgICAgIHNlbGVjdG9yOiB0aGlzLmdldEdyYW1tYXJTY29wZXMoKVxyXG4gICAgICAgIC5tYXAoZyA9PiAnLicgKyBnKVxyXG4gICAgICAgIC5qb2luKCcsICcpLFxyXG4gICAgICBpbmNsdXNpb25Qcmlvcml0eTogMSxcclxuICAgICAgc3VnZ2VzdGlvblByaW9yaXR5OiAyLFxyXG4gICAgICBleGNsdWRlTG93ZXJQcmlvcml0eTogZmFsc2UsXHJcbiAgICAgIGdldFN1Z2dlc3Rpb25zOiB0aGlzLmdldFN1Z2dlc3Rpb25zLmJpbmQodGhpcyksXHJcbiAgICAgIG9uRGlkSW5zZXJ0U3VnZ2VzdGlvbjogdGhpcy5vbkRpZEluc2VydFN1Z2dlc3Rpb24uYmluZCh0aGlzKSxcclxuICAgICAgZ2V0U3VnZ2VzdGlvbkRldGFpbHNPblNlbGVjdDogdGhpcy5nZXRTdWdnZXN0aW9uRGV0YWlsc09uU2VsZWN0LmJpbmQodGhpcyksXHJcbiAgICB9O1xyXG4gIH1cclxuXHJcbiAgYXN5bmMgZ2V0U3VnZ2VzdGlvbnMoXHJcbiAgICByZXF1ZXN0OiBhdG9tJEF1dG9jb21wbGV0ZVJlcXVlc3QsXHJcbiAgKTogUHJvbWlzZTxBcnJheTxhdG9tJEF1dG9jb21wbGV0ZVN1Z2dlc3Rpb24+PiB7XHJcbiAgICBjb25zdCBzZXJ2ZXIgPSBhd2FpdCB0aGlzLl9zZXJ2ZXJNYW5hZ2VyLmdldFNlcnZlcihyZXF1ZXN0LmVkaXRvcik7XHJcbiAgICBpZiAoc2VydmVyID09IG51bGwgfHwgIUF1dG9jb21wbGV0ZUFkYXB0ZXIuY2FuQWRhcHQoc2VydmVyLmNhcGFiaWxpdGllcykpIHtcclxuICAgICAgcmV0dXJuIFtdO1xyXG4gICAgfVxyXG5cclxuICAgIHRoaXMuYXV0b0NvbXBsZXRlID0gdGhpcy5hdXRvQ29tcGxldGUgfHwgbmV3IEF1dG9jb21wbGV0ZUFkYXB0ZXIoKTtcclxuICAgIHRoaXMuX2xhc3RBdXRvY29tcGxldGVSZXF1ZXN0ID0gcmVxdWVzdDtcclxuICAgIHJldHVybiB0aGlzLmF1dG9Db21wbGV0ZS5nZXRTdWdnZXN0aW9ucyhzZXJ2ZXIsIHJlcXVlc3QsIHRoaXMub25EaWRDb252ZXJ0QXV0b2NvbXBsZXRlKTtcclxuICB9XHJcblxyXG4gIGFzeW5jIGdldFN1Z2dlc3Rpb25EZXRhaWxzT25TZWxlY3Qoc3VnZ2VzdGlvbjogYXRvbSRBdXRvY29tcGxldGVTdWdnZXN0aW9uKTogUHJvbWlzZTw/YXRvbSRBdXRvY29tcGxldGVTdWdnZXN0aW9uPiB7XHJcbiAgICBjb25zdCByZXF1ZXN0ID0gdGhpcy5fbGFzdEF1dG9jb21wbGV0ZVJlcXVlc3Q7XHJcbiAgICBpZiAocmVxdWVzdCA9PSBudWxsKSB7IHJldHVybiBudWxsOyB9XHJcbiAgICBjb25zdCBzZXJ2ZXIgPSBhd2FpdCB0aGlzLl9zZXJ2ZXJNYW5hZ2VyLmdldFNlcnZlcihyZXF1ZXN0LmVkaXRvcik7XHJcbiAgICBpZiAoc2VydmVyID09IG51bGwgfHwgIUF1dG9jb21wbGV0ZUFkYXB0ZXIuY2FuUmVzb2x2ZShzZXJ2ZXIuY2FwYWJpbGl0aWVzKSB8fCB0aGlzLmF1dG9Db21wbGV0ZSA9PSBudWxsKSB7XHJcbiAgICAgIHJldHVybiBudWxsO1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiB0aGlzLmF1dG9Db21wbGV0ZS5jb21wbGV0ZVN1Z2dlc3Rpb24oc2VydmVyLCBzdWdnZXN0aW9uLCByZXF1ZXN0LCB0aGlzLm9uRGlkQ29udmVydEF1dG9jb21wbGV0ZSk7XHJcbiAgfVxyXG5cclxuICBvbkRpZENvbnZlcnRBdXRvY29tcGxldGUoXHJcbiAgICBjb21wbGV0aW9uSXRlbTogbHMuQ29tcGxldGlvbkl0ZW0sXHJcbiAgICBzdWdnZXN0aW9uOiBhdG9tJEF1dG9jb21wbGV0ZVN1Z2dlc3Rpb24sXHJcbiAgICByZXF1ZXN0OiBhdG9tJEF1dG9jb21wbGV0ZVJlcXVlc3QsXHJcbiAgKTogdm9pZCB7XHJcbiAgfVxyXG5cclxuICBvbkRpZEluc2VydFN1Z2dlc3Rpb24oYXJnOiBhdG9tJEF1dG9jb21wbGV0ZURpZEluc2VydCk6IHZvaWQge31cclxuXHJcbiAgLy8gRGVmaW5pdGlvbnMgdmlhIExTIGRvY3VtZW50SGlnaGxpZ2h0IGFuZCBnb3RvRGVmaW5pdGlvbi0tLS0tLS0tLS0tLVxyXG4gIHByb3ZpZGVEZWZpbml0aW9ucygpOiBhdG9tSWRlJERlZmluaXRpb25Qcm92aWRlciB7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBuYW1lOiB0aGlzLm5hbWUsXHJcbiAgICAgIHByaW9yaXR5OiAyMCxcclxuICAgICAgZ3JhbW1hclNjb3BlczogdGhpcy5nZXRHcmFtbWFyU2NvcGVzKCksXHJcbiAgICAgIGdldERlZmluaXRpb246IHRoaXMuZ2V0RGVmaW5pdGlvbi5iaW5kKHRoaXMpLFxyXG4gICAgfTtcclxuICB9XHJcblxyXG4gIGFzeW5jIGdldERlZmluaXRpb24oZWRpdG9yOiBUZXh0RWRpdG9yLCBwb2ludDogYXRvbSRQb2ludCk6IFByb21pc2U8P2F0b21JZGUkRGVmaW5pdGlvblF1ZXJ5UmVzdWx0PiB7XHJcbiAgICBjb25zdCBzZXJ2ZXIgPSBhd2FpdCB0aGlzLl9zZXJ2ZXJNYW5hZ2VyLmdldFNlcnZlcihlZGl0b3IpO1xyXG4gICAgaWYgKHNlcnZlciA9PSBudWxsIHx8ICFEZWZpbml0aW9uQWRhcHRlci5jYW5BZGFwdChzZXJ2ZXIuY2FwYWJpbGl0aWVzKSkge1xyXG4gICAgICByZXR1cm4gbnVsbDtcclxuICAgIH1cclxuXHJcbiAgICB0aGlzLmRlZmluaXRpb25zID0gdGhpcy5kZWZpbml0aW9ucyB8fCBuZXcgRGVmaW5pdGlvbkFkYXB0ZXIoKTtcclxuICAgIHJldHVybiB0aGlzLmRlZmluaXRpb25zLmdldERlZmluaXRpb24oXHJcbiAgICAgIHNlcnZlci5jb25uZWN0aW9uLFxyXG4gICAgICBzZXJ2ZXIuY2FwYWJpbGl0aWVzLFxyXG4gICAgICB0aGlzLmdldExhbmd1YWdlTmFtZSgpLFxyXG4gICAgICBlZGl0b3IsXHJcbiAgICAgIHBvaW50LFxyXG4gICAgKTtcclxuICB9XHJcblxyXG4gIC8vIE91dGxpbmUgVmlldyB2aWEgTFMgZG9jdW1lbnRTeW1ib2wtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICBwcm92aWRlT3V0bGluZXMoKTogYXRvbUlkZSRPdXRsaW5lUHJvdmlkZXIge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgbmFtZTogdGhpcy5uYW1lLFxyXG4gICAgICBncmFtbWFyU2NvcGVzOiB0aGlzLmdldEdyYW1tYXJTY29wZXMoKSxcclxuICAgICAgcHJpb3JpdHk6IDEsXHJcbiAgICAgIGdldE91dGxpbmU6IHRoaXMuZ2V0T3V0bGluZS5iaW5kKHRoaXMpLFxyXG4gICAgfTtcclxuICB9XHJcblxyXG4gIGFzeW5jIGdldE91dGxpbmUoZWRpdG9yOiBhdG9tJFRleHRFZGl0b3IpOiBQcm9taXNlPD9hdG9tSWRlJE91dGxpbmU+IHtcclxuICAgIGNvbnN0IHNlcnZlciA9IGF3YWl0IHRoaXMuX3NlcnZlck1hbmFnZXIuZ2V0U2VydmVyKGVkaXRvcik7XHJcbiAgICBpZiAoc2VydmVyID09IG51bGwgfHwgIU91dGxpbmVWaWV3QWRhcHRlci5jYW5BZGFwdChzZXJ2ZXIuY2FwYWJpbGl0aWVzKSkge1xyXG4gICAgICByZXR1cm4gbnVsbDtcclxuICAgIH1cclxuXHJcbiAgICB0aGlzLm91dGxpbmVWaWV3ID0gdGhpcy5vdXRsaW5lVmlldyB8fCBuZXcgT3V0bGluZVZpZXdBZGFwdGVyKCk7XHJcbiAgICByZXR1cm4gdGhpcy5vdXRsaW5lVmlldy5nZXRPdXRsaW5lKHNlcnZlci5jb25uZWN0aW9uLCBlZGl0b3IpO1xyXG4gIH1cclxuXHJcbiAgLy8gTGludGVyIHB1c2ggdjIgQVBJIHZpYSBMUyBwdWJsaXNoRGlhZ25vc3RpY3NcclxuICBjb25zdW1lTGludGVyVjIocmVnaXN0ZXJJbmRpZTogKHtuYW1lOiBzdHJpbmd9KSA9PiBsaW50ZXIkVjJJbmRpZURlbGVnYXRlKTogdm9pZCB7XHJcbiAgICB0aGlzLl9saW50ZXJEZWxlZ2F0ZSA9IHJlZ2lzdGVySW5kaWUoe25hbWU6IHRoaXMubmFtZX0pO1xyXG4gICAgaWYgKHRoaXMuX2xpbnRlckRlbGVnYXRlID09IG51bGwpIHtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG5cclxuICAgIGZvciAoY29uc3Qgc2VydmVyIG9mIHRoaXMuX3NlcnZlck1hbmFnZXIuZ2V0QWN0aXZlU2VydmVycygpKSB7XHJcbiAgICAgIGlmIChzZXJ2ZXIubGludGVyUHVzaFYyICE9IG51bGwpIHtcclxuICAgICAgICBzZXJ2ZXIubGludGVyUHVzaFYyLmF0dGFjaCh0aGlzLl9saW50ZXJEZWxlZ2F0ZSk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8vIEZpbmQgUmVmZXJlbmNlcyB2aWEgTFMgZmluZFJlZmVyZW5jZXMtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICBwcm92aWRlRmluZFJlZmVyZW5jZXMoKTogYXRvbUlkZSRGaW5kUmVmZXJlbmNlc1Byb3ZpZGVyIHtcclxuICAgIHJldHVybiB7XHJcbiAgICAgIGlzRWRpdG9yU3VwcG9ydGVkOiAoZWRpdG9yOiBhdG9tJFRleHRFZGl0b3IpID0+IHRoaXMuZ2V0R3JhbW1hclNjb3BlcygpLmluY2x1ZGVzKGVkaXRvci5nZXRHcmFtbWFyKCkuc2NvcGVOYW1lKSxcclxuICAgICAgZmluZFJlZmVyZW5jZXM6IHRoaXMuZ2V0UmVmZXJlbmNlcy5iaW5kKHRoaXMpLFxyXG4gICAgfTtcclxuICB9XHJcblxyXG4gIGFzeW5jIGdldFJlZmVyZW5jZXMoZWRpdG9yOiBhdG9tJFRleHRFZGl0b3IsIHBvaW50OiBhdG9tJFBvaW50KTogUHJvbWlzZTw/YXRvbUlkZSRGaW5kUmVmZXJlbmNlc1JldHVybj4ge1xyXG4gICAgY29uc3Qgc2VydmVyID0gYXdhaXQgdGhpcy5fc2VydmVyTWFuYWdlci5nZXRTZXJ2ZXIoZWRpdG9yKTtcclxuICAgIGlmIChzZXJ2ZXIgPT0gbnVsbCB8fCAhRmluZFJlZmVyZW5jZXNBZGFwdGVyLmNhbkFkYXB0KHNlcnZlci5jYXBhYmlsaXRpZXMpKSB7XHJcbiAgICAgIHJldHVybiBudWxsO1xyXG4gICAgfVxyXG5cclxuICAgIHRoaXMuZmluZFJlZmVyZW5jZXMgPSB0aGlzLmZpbmRSZWZlcmVuY2VzIHx8IG5ldyBGaW5kUmVmZXJlbmNlc0FkYXB0ZXIoKTtcclxuICAgIHJldHVybiB0aGlzLmZpbmRSZWZlcmVuY2VzLmdldFJlZmVyZW5jZXMoc2VydmVyLmNvbm5lY3Rpb24sIGVkaXRvciwgcG9pbnQsIHNlcnZlci5wcm9qZWN0UGF0aCk7XHJcbiAgfVxyXG5cclxuICAvLyBEYXRhdGlwIHZpYSBMUyB0ZXh0RG9jdW1lbnQvaG92ZXItLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgY29uc3VtZURhdGF0aXAoc2VydmljZTogYXRvbUlkZSREYXRhdGlwU2VydmljZSk6IHZvaWQge1xyXG4gICAgdGhpcy5fZGlzcG9zYWJsZS5hZGQoXHJcbiAgICAgIHNlcnZpY2UuYWRkUHJvdmlkZXIoe1xyXG4gICAgICAgIHByb3ZpZGVyTmFtZTogdGhpcy5uYW1lLFxyXG4gICAgICAgIHByaW9yaXR5OiAxLFxyXG4gICAgICAgIGdyYW1tYXJTY29wZXM6IHRoaXMuZ2V0R3JhbW1hclNjb3BlcygpLFxyXG4gICAgICAgIHZhbGlkRm9yU2NvcGU6IChzY29wZU5hbWU6IHN0cmluZykgPT4ge1xyXG4gICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0R3JhbW1hclNjb3BlcygpLmluY2x1ZGVzKHNjb3BlTmFtZSk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBkYXRhdGlwOiB0aGlzLmdldERhdGF0aXAuYmluZCh0aGlzKSxcclxuICAgICAgfSksXHJcbiAgICApO1xyXG4gIH1cclxuXHJcbiAgYXN5bmMgZ2V0RGF0YXRpcChlZGl0b3I6IGF0b20kVGV4dEVkaXRvciwgcG9pbnQ6IGF0b20kUG9pbnQpOiBQcm9taXNlPD9hdG9tSWRlJERhdGF0aXA+IHtcclxuICAgIGNvbnN0IHNlcnZlciA9IGF3YWl0IHRoaXMuX3NlcnZlck1hbmFnZXIuZ2V0U2VydmVyKGVkaXRvcik7XHJcbiAgICBpZiAoc2VydmVyID09IG51bGwgfHwgIURhdGF0aXBBZGFwdGVyLmNhbkFkYXB0KHNlcnZlci5jYXBhYmlsaXRpZXMpKSB7XHJcbiAgICAgIHJldHVybiBudWxsO1xyXG4gICAgfVxyXG5cclxuICAgIHRoaXMuZGF0YXRpcCA9IHRoaXMuZGF0YXRpcCB8fCBuZXcgRGF0YXRpcEFkYXB0ZXIoKTtcclxuICAgIHJldHVybiB0aGlzLmRhdGF0aXAuZ2V0RGF0YXRpcChzZXJ2ZXIuY29ubmVjdGlvbiwgZWRpdG9yLCBwb2ludCk7XHJcbiAgfVxyXG5cclxuICAvLyBDb2RlIEZvcm1hdCB2aWEgTFMgZm9ybWF0RG9jdW1lbnQgJiBmb3JtYXREb2N1bWVudFJhbmdlLS0tLS0tLS0tLS0tXHJcbiAgcHJvdmlkZUNvZGVGb3JtYXQoKTogYXRvbUlkZSRSYW5nZUNvZGVGb3JtYXRQcm92aWRlciB7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBncmFtbWFyU2NvcGVzOiB0aGlzLmdldEdyYW1tYXJTY29wZXMoKSxcclxuICAgICAgcHJpb3JpdHk6IDEsXHJcbiAgICAgIGZvcm1hdENvZGU6IHRoaXMuZ2V0Q29kZUZvcm1hdC5iaW5kKHRoaXMpLFxyXG4gICAgfTtcclxuICB9XHJcblxyXG4gIGFzeW5jIGdldENvZGVGb3JtYXQoZWRpdG9yOiBhdG9tJFRleHRFZGl0b3IsIHJhbmdlOiBhdG9tJFJhbmdlKTogUHJvbWlzZTxBcnJheTxhdG9tSWRlJFRleHRFZGl0Pj4ge1xyXG4gICAgY29uc3Qgc2VydmVyID0gYXdhaXQgdGhpcy5fc2VydmVyTWFuYWdlci5nZXRTZXJ2ZXIoZWRpdG9yKTtcclxuICAgIGlmIChzZXJ2ZXIgPT0gbnVsbCB8fCAhQ29kZUZvcm1hdEFkYXB0ZXIuY2FuQWRhcHQoc2VydmVyLmNhcGFiaWxpdGllcykpIHtcclxuICAgICAgcmV0dXJuIFtdO1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBDb2RlRm9ybWF0QWRhcHRlci5mb3JtYXQoc2VydmVyLmNvbm5lY3Rpb24sIHNlcnZlci5jYXBhYmlsaXRpZXMsIGVkaXRvciwgcmFuZ2UpO1xyXG4gIH1cclxuXHJcbiAgcHJvdmlkZUNvZGVIaWdobGlnaHQoKTogYXRvbUlkZSRDb2RlSGlnaGxpZ2h0UHJvdmlkZXIge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgZ3JhbW1hclNjb3BlczogdGhpcy5nZXRHcmFtbWFyU2NvcGVzKCksXHJcbiAgICAgIHByaW9yaXR5OiAxLFxyXG4gICAgICBoaWdobGlnaHQ6IChlZGl0b3IsIHBvc2l0aW9uKSA9PiB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0Q29kZUhpZ2hsaWdodChlZGl0b3IsIHBvc2l0aW9uKTtcclxuICAgICAgfSxcclxuICAgIH07XHJcbiAgfVxyXG5cclxuICBhc3luYyBnZXRDb2RlSGlnaGxpZ2h0KGVkaXRvcjogYXRvbSRUZXh0RWRpdG9yLCBwb3NpdGlvbjogYXRvbSRQb2ludCk6IFByb21pc2U8P0FycmF5PGF0b20kUmFuZ2U+PiB7XHJcbiAgICBjb25zdCBzZXJ2ZXIgPSBhd2FpdCB0aGlzLl9zZXJ2ZXJNYW5hZ2VyLmdldFNlcnZlcihlZGl0b3IpO1xyXG4gICAgaWYgKHNlcnZlciA9PSBudWxsIHx8ICFDb2RlSGlnaGxpZ2h0QWRhcHRlci5jYW5BZGFwdChzZXJ2ZXIuY2FwYWJpbGl0aWVzKSkge1xyXG4gICAgICByZXR1cm4gbnVsbDtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gQ29kZUhpZ2hsaWdodEFkYXB0ZXIuaGlnaGxpZ2h0KHNlcnZlci5jb25uZWN0aW9uLCBzZXJ2ZXIuY2FwYWJpbGl0aWVzLCBlZGl0b3IsIHBvc2l0aW9uKTtcclxuICB9XHJcblxyXG4gIHByb3ZpZGVDb2RlQWN0aW9ucygpOiBhdG9tSWRlJENvZGVBY3Rpb25Qcm92aWRlciB7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBncmFtbWFyU2NvcGVzOiB0aGlzLmdldEdyYW1tYXJTY29wZXMoKSxcclxuICAgICAgcHJpb3JpdHk6IDEsXHJcbiAgICAgIGdldENvZGVBY3Rpb25zOiAoZWRpdG9yLCByYW5nZSwgZGlhZ25vc3RpY3MpID0+IHtcclxuICAgICAgICByZXR1cm4gdGhpcy5nZXRDb2RlQWN0aW9ucyhlZGl0b3IsIHJhbmdlLCBkaWFnbm9zdGljcyk7XHJcbiAgICAgIH0sXHJcbiAgICB9O1xyXG4gIH1cclxuXHJcbiAgYXN5bmMgZ2V0Q29kZUFjdGlvbnMoZWRpdG9yOiBhdG9tJFRleHRFZGl0b3IsIHJhbmdlOiBhdG9tJFJhbmdlLCBkaWFnbm9zdGljczogQXJyYXk8YXRvbUlkZSREaWFnbm9zdGljPikge1xyXG4gICAgY29uc3Qgc2VydmVyID0gYXdhaXQgdGhpcy5fc2VydmVyTWFuYWdlci5nZXRTZXJ2ZXIoZWRpdG9yKTtcclxuICAgIGlmIChzZXJ2ZXIgPT0gbnVsbCB8fCAhQ29kZUFjdGlvbkFkYXB0ZXIuY2FuQWRhcHQoc2VydmVyLmNhcGFiaWxpdGllcykpIHtcclxuICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIENvZGVBY3Rpb25BZGFwdGVyLmdldENvZGVBY3Rpb25zKFxyXG4gICAgICBzZXJ2ZXIuY29ubmVjdGlvbixcclxuICAgICAgc2VydmVyLmNhcGFiaWxpdGllcyxcclxuICAgICAgc2VydmVyLmxpbnRlclB1c2hWMixcclxuICAgICAgZWRpdG9yLFxyXG4gICAgICByYW5nZSxcclxuICAgICAgZGlhZ25vc3RpY3MsXHJcbiAgICApO1xyXG4gIH1cclxuXHJcbiAgY29uc3VtZVNpZ25hdHVyZUhlbHAocmVnaXN0cnk6IGF0b21JZGUkU2lnbmF0dXJlSGVscFJlZ2lzdHJ5KTogSURpc3Bvc2FibGUge1xyXG4gICAgdGhpcy5fc2lnbmF0dXJlSGVscFJlZ2lzdHJ5ID0gcmVnaXN0cnk7XHJcbiAgICBmb3IgKGNvbnN0IHNlcnZlciBvZiB0aGlzLl9zZXJ2ZXJNYW5hZ2VyLmdldEFjdGl2ZVNlcnZlcnMoKSkge1xyXG4gICAgICBpZiAoc2VydmVyLnNpZ25hdHVyZUhlbHBBZGFwdGVyICE9IG51bGwpIHtcclxuICAgICAgICBzZXJ2ZXIuc2lnbmF0dXJlSGVscEFkYXB0ZXIuYXR0YWNoKHJlZ2lzdHJ5KTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIG5ldyBEaXNwb3NhYmxlKCgpID0+IHtcclxuICAgICAgdGhpcy5fc2lnbmF0dXJlSGVscFJlZ2lzdHJ5ID0gbnVsbDtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgY29uc3VtZUJ1c3lTaWduYWwoc2VydmljZTogYXRvbUlkZSRCdXN5U2lnbmFsU2VydmljZSk6IElEaXNwb3NhYmxlIHtcclxuICAgIHRoaXMuYnVzeVNpZ25hbFNlcnZpY2UgPSBzZXJ2aWNlO1xyXG4gICAgcmV0dXJuIG5ldyBEaXNwb3NhYmxlKCgpID0+IGRlbGV0ZSB0aGlzLmJ1c3lTaWduYWxTZXJ2aWNlKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIGBkaWRDaGFuZ2VXYXRjaGVkRmlsZXNgIG1lc3NhZ2UgZmlsdGVyaW5nLCBvdmVycmlkZSBmb3IgY3VzdG9tIGxvZ2ljLlxyXG4gICAqIEBwYXJhbSBmaWxlUGF0aCBwYXRoIG9mIGEgZmlsZSB0aGF0IGhhcyBjaGFuZ2VkIGluIHRoZSBwcm9qZWN0IHBhdGhcclxuICAgKiBAcmV0dXJuIGZhbHNlID0+IG1lc3NhZ2Ugd2lsbCBub3QgYmUgc2VudCB0byB0aGUgbGFuZ3VhZ2Ugc2VydmVyXHJcbiAgICovXHJcbiAgZmlsdGVyQ2hhbmdlV2F0Y2hlZEZpbGVzKGZpbGVQYXRoOiBzdHJpbmcpOiBib29sZWFuIHtcclxuICAgIHJldHVybiB0cnVlO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogQ2FsbGVkIG9uIGxhbmd1YWdlIHNlcnZlciBzdGRlcnIgb3V0cHV0LlxyXG4gICAqIEBwYXJhbSBzdGRlcnIgYSBjaHVuayBvZiBzdGRlcnIgZnJvbSBhIGxhbmd1YWdlIHNlcnZlciBpbnN0YW5jZVxyXG4gICAqL1xyXG4gIGhhbmRsZVNlcnZlclN0ZGVycihzdGRlcnI6IHN0cmluZywgcHJvamVjdFBhdGg6IHN0cmluZykge1xyXG4gICAgc3RkZXJyLnNwbGl0KCdcXG4nKS5maWx0ZXIobCA9PiBsKS5mb3JFYWNoKGxpbmUgPT4gdGhpcy5sb2dnZXIud2Fybihgc3RkZXJyICR7bGluZX1gKSk7XHJcbiAgfVxyXG59XHJcbiJdfQ==